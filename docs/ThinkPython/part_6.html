r
sequences because the elements have to be characters. They are
also immutable. If you need the ability to change the characters
in a string (as opposed to creating a new string), you might
want to use a list of characters instead.</p><p>Lists are more common than tuples, mostly because they are mutable.
But there are a few cases where you might prefer tuples:</p><ol class="enumerate" type=1><li class="li-enumerate">In some contexts, like a <span class="c004">return</span> statement, it is
syntactically simpler to create a tuple than a list.</li><li class="li-enumerate">If you want to use a sequence as a dictionary key, you
have to use an immutable type like a tuple or string.</li><li class="li-enumerate">If you are passing a sequence as an argument to a function,
using tuples reduces the potential for unexpected behavior
due to aliasing.</li></ol><p>Because tuples are immutable, they don&#X2019;t provide methods like <span class="c004">sort</span> and <span class="c004">reverse</span>, which modify existing lists. But Python
provides the built-in function <span class="c004">sorted</span>, which takes any sequence
and returns a new list with the same elements in sorted order, and
<span class="c004">reversed</span>, which takes a sequence and returns an iterator that
traverses the list in reverse order.
<a id="hevea_default1101"></a>
<a id="hevea_default1102"></a> <a id="hevea_default1103"></a>
<a id="hevea_default1104"></a>
<a id="hevea_default1105"></a></p>
<h2 class="section" id="sec148">12.8&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hevea_default1106"></a>
<a id="hevea_default1107"></a>
<a id="hevea_default1108"></a>
<a id="hevea_default1109"></a></p><p>Lists, dictionaries and tuples are examples of <span class="c010">data
structures</span>; in this chapter we are starting to see compound data
structures, like lists of tuples, or dictionaries that contain tuples
as keys and lists as values. Compound data structures are useful, but
they are prone to what I call <span class="c010">shape errors</span>; that is, errors
caused when a data structure has the wrong type, size, or structure.
For example, if you are expecting a list with one integer and I
give you a plain old integer (not in a list), it won&#X2019;t work.
<a id="hevea_default1110"></a>
<a id="hevea_default1111"></a></p><p>To help debug these kinds of errors, I have written a module
called <span class="c004">structshape</span> that provides a function, also called
<span class="c004">structshape</span>, that takes any kind of data structure as
an argument and returns a string that summarizes its shape.
You can download it from <a href="https://thinkpython.com/code/structshape.py"><span class="c004">https://thinkpython.com/code/structshape.py</span></a></p><p>Here&#X2019;s the result for a simple list:</p><pre class="verbatim">&gt;&gt;&gt; from structshape import structshape
&gt;&gt;&gt; t = [1, 2, 3]
&gt;&gt;&gt; structshape(t)
'list of 3 int'
</pre><p>
A fancier program might write &#X201C;list of 3 int<em>s</em>&#X201D;, but it
was easier not to deal with plurals. Here&#X2019;s a list of lists:</p><pre class="verbatim">&gt;&gt;&gt; t2 = [[1,2], [3,4], [5,6]]
&gt;&gt;&gt; structshape(t2)
'list of 3 list of 2 int'
</pre><p>
If the elements of the list are not the same type,
<span class="c004">structshape</span> groups them, in order, by type:</p><pre class="verbatim">&gt;&gt;&gt; t3 = [1, 2, 3, 4.0, '5', '6', [7], [8], 9]
&gt;&gt;&gt; structshape(t3)
'list of (3 int, float, 2 str, 2 list of int, int)'
</pre><p>
Here&#X2019;s a list of tuples:</p><pre class="verbatim">&gt;&gt;&gt; s = 'abc'
&gt;&gt;&gt; lt = list(zip(t, s))
&gt;&gt;&gt; structshape(lt)
'list of 3 tuple of (int, str)'
</pre><p>
And here&#X2019;s a dictionary with 3 items that map integers to strings.</p><pre class="verbatim">&gt;&gt;&gt; d = dict(lt) 
&gt;&gt;&gt; structshape(d)
'dict of 3 int-&gt;str'
</pre><p>
If you are having trouble keeping track of your data structures,
<span class="c004">structshape</span> can help.</p>
<h2 class="section" id="sec149">12.9&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">tuple:</span></dt><dd class="dd-description"> An immutable sequence of elements.
<a id="hevea_default1112"></a></dd><dt class="dt-description"><span class="c010">tuple assignment:</span></dt><dd class="dd-description"> An assignment with a sequence on the
right side and a tuple of variables on the left. The right
side is evaluated and then its elements are assigned to the
variables on the left.
<a id="hevea_default1113"></a>
<a id="hevea_default1114"></a></dd><dt class="dt-description"><span class="c010">gather:</span></dt><dd class="dd-description"> An operation that collects multiple arguments into a tuple.
<a id="hevea_default1115"></a></dd><dt class="dt-description"><span class="c010">scatter:</span></dt><dd class="dd-description"> An operation that makes a sequence behave like multiple arguments.
<a id="hevea_default1116"></a></dd><dt class="dt-description"><span class="c010">zip object:</span></dt><dd class="dd-description"> The result of calling a built-in function <span class="c004">zip</span>;
an object that iterates through a sequence of tuples.
<a id="hevea_default1117"></a>
<a id="hevea_default1118"></a></dd><dt class="dt-description"><span class="c010">iterator:</span></dt><dd class="dd-description"> An object that can iterate through a sequence, but
which does not provide list operators and methods.
<a id="hevea_default1119"></a></dd><dt class="dt-description"><span class="c010">data structure:</span></dt><dd class="dd-description"> A collection of related values, often
organized in lists, dictionaries, tuples, etc.
<a id="hevea_default1120"></a></dd><dt class="dt-description"><span class="c010">shape error:</span></dt><dd class="dd-description"> An error caused because a value has the
wrong shape; that is, the wrong type or size.
<a id="hevea_default1121"></a></dd></dl>
<h2 class="section" id="sec150">12.10&#XA0;&#XA0;Exercises</h2>
<div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Write a function called <code>most_frequent</code> that takes a string and
prints the letters in decreasing order of frequency. Find text
samples from several different languages and see how letter frequency
varies between languages. Compare your results with the tables at
</em><a href="http://en.wikipedia.org/wiki/Letter_frequencies"><span class="c004"><em>http://en.wikipedia.org/wiki/Letter_frequencies</em></span></a><em>. Solution:
</em><a href="https://thinkpython.com/code/most_frequent.py"><span class="c004"><em>https://thinkpython.com/code/most_frequent.py</em></span></a><em>. </em><a id="hevea_default1122"></a> <a id="hevea_default1123"></a></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;
<a id="anagrams"></a>
<a id="hevea_default1124"></a>
<a id="hevea_default1125"></a><p><em>More anagrams!</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>Write a program
that reads a word list from a file (see Section&#XA0;</em><a href="thinkpython2010.html#wordlist"><em>9.1</em></a><em>) and
prints all the sets of words that are anagrams.</em><p><em>Here is an example of what the output might look like:</em></p><pre class="verbatim"><em>['deltas', 'desalt', 'lasted', 'salted', 'slated', 'staled']
['retainers', 'ternaries']
['generating', 'greatening']
['resmelts', 'smelters', 'termless']
</em></pre><p><em>
Hint: you might want to build a dictionary that maps from a
collection of letters to a list of words that can be spelled with those
letters. The question is, how can you represent the collection of
letters in a way that can be used as a key?</em></p></li><li class="li-enumerate"><em>Modify the previous program so that it prints the longest list
of anagrams first, followed by the second longest, and so on.
</em><a id="hevea_default1126"></a>
<a id="hevea_default1127"></a></li><li class="li-enumerate"><em>In Scrabble a &#X201C;bingo&#X201D; is when you play all seven tiles in
your rack, along with a letter on the board, to form an eight-letter
word. What collection of 8 letters forms the most possible bingos?</em><p><em>Solution: </em><a href="https://thinkpython.com/code/anagram_sets.py"><span class="c004"><em>https://thinkpython.com/code/anagram_sets.py</em></span></a><em>.</em></p></li></ol></div><div class="theorem"><span class="c010">Exercise&#XA0;3</span>&#XA0;&#XA0;
<a id="hevea_default1128"></a><p><em>Two words form a &#X201C;metathesis pair&#X201D; if you can transform one into the
other by swapping two letters; for example, &#X201C;converse&#X201D; and
&#X201C;conserve&#X201D;. Write a program that finds all of the metathesis pairs
in the dictionary. Hint: don&#X2019;t test all pairs of words, and don&#X2019;t
test all possible swaps. Solution:
</em><a href="https://thinkpython.com/code/metathesis.py"><em><span class="c004">https://thinkpython.com/code/metathesis.py</span></em></a><em>. Credit: This
exercise is inspired by an example at </em><a href="http://puzzlers.org"><em><span class="c004">http://puzzlers.org</span></em></a><em>.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;4</span>&#XA0;&#XA0;
<a id="hevea_default1129"></a>
<a id="hevea_default1130"></a><p><em>Here&#X2019;s another Car Talk Puzzler
(</em><a href="http://www.cartalk.com/content/puzzlers"><em><span class="c004">http://www.cartalk.com/content/puzzlers</span></em></a><em>):</em></p><blockquote class="quote"><em>
What is the longest English word, that remains a valid English word,
as you remove its letters one at a time?</em><p><em>Now, letters can be removed from either end, or the middle, but you
can&#X2019;t rearrange any of the letters. Every time you drop a letter, you
wind up with another English word. If you do that, you&#X2019;re eventually
going to wind up with one letter and that too is going to be an
English word&#X2014;one that&#X2019;s found in the dictionary. I want to know
what&#X2019;s the longest word and how many letters does it
have?</em></p><p><em>I&#X2019;m going to give you a little modest example: Sprite. Ok? You start
off with sprite, you take a letter off, one from the interior of the
word, take the r away, and we&#X2019;re left with the word spite, then we
take the e off the end, we&#X2019;re left with spit, we take the s off, we&#X2019;re
left with pit, it, and I.
</em></p></blockquote><p>
<a id="hevea_default1131"></a>
<a id="hevea_default1132"></a></p><p><em>Write a program to find all words that can be reduced in this way,
and then find the longest one.</em></p><p><em>This exercise is a little more challenging than most, so here are
some suggestions:</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>You might want to write a function that takes a word and
computes a list of all the words that can be formed by removing one
letter. These are the &#X201C;children&#X201D; of the word.
</em><a id="hevea_default1133"></a>
<a id="hevea_default1134"></a></li><li class="li-enumerate"><em>Recursively, a word is reducible if any of its children
are reducible. As a base case, you can consider the empty
string reducible.</em></li><li class="li-enumerate"><em>The wordlist I provided, <span class="c004">words.txt</span>, doesn&#X2019;t
contain single letter words. So you might want to add
&#X201C;I&#X201D;, &#X201C;a&#X201D;, and the empty string.</em></li><li class="li-enumerate"><em>To improve the performance of your program, you might want
to memoize the words that are known to be reducible.</em></li></ol><p><em>Solution: </em><a href="https://thinkpython.com/code/reducible.py"><em><span class="c004">https://thinkpython.com/code/reducible.py</span></em></a><em>.</em></p></div>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2012.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2014.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Case study: data structure selection</title>
</head>
<body>
<a href="thinkpython2013.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2015.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec151">Chapter&#XA0;13&#XA0;&#XA0;Case study: data structure selection</h1>
<p>At this point you have learned about Python&#X2019;s core data structures,
and you have seen some of the algorithms that use them.
If you would like to know more about algorithms, this might be a good
time to read Chapter&#XA0;<a href="thinkpython2022.html#algorithms">B</a>.
But you don&#X2019;t have to read it before you go on; you can read
it whenever you are interested.</p><p>This chapter presents a case study with exercises that let
you think about choosing data structures and practice using them.</p>
<h2 class="section" id="sec152">13.1&#XA0;&#XA0;Word frequency analysis</h2>
<p>
<a id="analysis"></a></p><p>As usual, you should at least attempt the exercises
before you read my solutions.</p><div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Write a program that reads a file, breaks each line into
words, strips whitespace and punctuation from the words, and
converts them to lowercase.
</em><a id="hevea_default1135"></a>
<a id="hevea_default1136"></a></p><p><em>Hint: The <span class="c004">string</span> module provides a string named <span class="c004">whitespace</span>,
which contains space, tab, newline, etc., and <span class="c004">punctuation</span> which contains the punctuation characters. Let&#X2019;s see
if we can make Python swear:</em></p><pre class="verbatim"><em>&gt;&gt;&gt; import string
&gt;&gt;&gt; string.punctuation
'!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`{|}~'
</em></pre><p><em>
Also, you might consider using the string methods <span class="c004">strip</span>,
<span class="c004">replace</span> and <span class="c004">translate</span>.
</em><a id="hevea_default1137"></a>
<a id="hevea_default1138"></a>
<a id="hevea_default1139"></a>
<a id="hevea_default1140"></a>
<a id="hevea_default1141"></a>
<a id="hevea_default1142"></a></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;
<a id="hevea_default1143"></a><p><em>Go to Project Gutenberg (</em><a href="http://gutenberg.org"><span class="c004"><em>http://gutenberg.org</em></span></a><em>) and download 
your favorite out-of-copyright book in plain text format.
</em><a id="hevea_default1144"></a>
<a id="hevea_default1145"></a></p><p><em>Modify your program from the previous exercise to read the book
you downloaded, skip over the header information at the beginning
of the file, and process the rest of the words as before.</em></p><p><em>Then modify the program to count the total number of words in
the book, and the number of times each word is used.
</em><a id="hevea_default1146"></a>
<a id="hevea_default1147"></a></p><p><em>Print the number of different words used in the book. Compare
different books by different authors, written in different eras.
Which author uses the most extensive vocabulary?
</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;3</span>&#XA0;&#XA0;<p><em>Modify the program from the previous exercise to print the
20 most frequently used words in the book.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;4</span>&#XA0;&#XA0;<p><em>Modify the previous program to read a word list (see
Section&#XA0;</em><a href="thinkpython2010.html#wordlist"><em>9.1</em></a><em>) and then print all the words in the book that
are not in the word list. How many of them are typos? How many of
them are common words that </em>should<em> be in the word list, and how
many of them are really obscure?</em></p></div>
<h2 class="section" id="sec153">13.2&#XA0;&#XA0;Random numbers</h2>
<p>
<a id="hevea_default1148"></a>
<a id="hevea_default1149"></a>
<a id="hevea_default1150"></a>
<a id="hevea_default1151"></a></p><p>Given the same inputs, most computer programs generate the same
outputs every time, so they are said to be <span class="c010">deterministic</span>.
Determinism is usually a good thing, since we expect the same
calculation to yield the same result. For some applications, though,
we want the computer to be unpredictable. Games are an obvious
example, but there are more.</p><p>Making a program truly nondeterministic turns out to be difficult,
but there are ways to make it at least seem nondeterministic. One of
them is to use algorithms that generate <span class="c010">pseudorandom</span> numbers.
Pseudorandom numbers are not truly random because they are generated
by a deterministic computation, but just by looking at the numbers it
is all but impossible to distinguish them from random.
<a id="hevea_default1152"></a>
<a id="hevea_default1153"></a></p><p>The <span class="c004">random</span> module provides functions that generate
pseudorandom numbers (which I will simply call &#X201C;random&#X201D; from
here on).
<a id="hevea_default1154"></a>
<a id="hevea_default1155"></a></p><p>The function <span class="c004">random</span> returns a random float
between 0.0 and 1.0 (including 0.0 but not 1.0). Each time you
call <span class="c004">random</span>, you get the next number in a long series. To see a
sample, run this loop:</p><pre class="verbatim">import random

for i in range(10):
    x = random.random()
    print(x)
</pre><p>
The function <span class="c004">randint</span> takes parameters <span class="c004">low</span> and
<span class="c004">high</span> and returns an integer between <span class="c004">low</span> and
<span class="c004">high</span> (including both).
<a id="hevea_default1156"></a>
<a id="hevea_default1157"></a></p><pre class="verbatim">&gt;&gt;&gt; random.randint(5, 10)
5
&gt;&gt;&gt; random.randint(5, 10)
9
</pre><p>
To choose an element from a sequence at random, you can use
<span class="c004">choice</span>:
<a id="hevea_default1158"></a>
<a id="hevea_default1159"></a></p><pre class="verbatim">&gt;&gt;&gt; t = [1, 2, 3]
&gt;&gt;&gt; random.choice(t)
2
&gt;&gt;&gt; random.choice(t)
3
</pre><p>
The <span class="c004">random</span> module also provides functions to generate
random values from continuous distributions including
Gaussian, exponential, gamma, and a few more.</p><div class="theorem"><span class="c010">Exercise&#XA0;5</span>&#XA0;&#XA0;
<a id="hevea_default1160"></a><p><em>Write a function named <code>choose_from_hist</code> that takes
a histogram as defined in Section&#XA0;</em><a href="thinkpython2012.html#histogram"><em>11.2</em></a><em> and returns a 
random value from the histogram, chosen with probability
in proportion to frequency. For example, for this histogram:</em></p><pre class="verbatim"><em>&gt;&gt;&gt; t = ['a', 'a', 'b']
&gt;&gt;&gt; hist = histogram(t)
&gt;&gt;&gt; hist
{'a': 2, 'b': 1}
</em></pre><p><em>
your function should return <code>'a'</code> with probability </em>2/3<em> and <code>'b'</code>
with probability </em>1/3<em>.
</em></p></div>
<h2 class="section" id="sec154">13.3&#XA0;&#XA0;Word histogram</h2>
<p>You should attempt the previous exercises before you go on.
You can download my solution from
<a href="https://thinkpython.com/code/analyze_book1.py"><span class="c004">https://thinkpython.com/code/analyze_book1.py</span></a>. You will
also need <a href="https://thinkpython.com/code/emma.txt"><span class="c004">https://thinkpython.com/code/emma.txt</span></a>.</p><p>Here is a program that reads a file and builds a histogram of the
words in the file:
<a id="hevea_default1161"></a></p><pre class="verbatim">import string

def process_file(filename):
    hist = dict()
    fp = open(filename)
    for line in fp:
        process_line(line, hist)
    return hist

def process_line(line, hist):
    line = line.replace('-', ' ')
    
    for word in line.split():
        word = word.strip(string.punctuation + string.whitespace)
        word = word.lower()
        hist[word] = hist.get(word, 0) + 1

hist = process_file('emma.txt')
</pre><p>
This program reads <span class="c004">emma.txt</span>, which contains the text of <em>Emma</em> by Jane Austen.
<a id="hevea_default1162"></a></p><p><code>process_file</code> loops through the lines of the file,
passing them one at a time to <code>process_line</code>. The histogram
<span class="c004">hist</span> is being used as an accumulator.
<a id="hevea_default1163"></a>
<a id="hevea_default1164"></a></p><p><code>process_line</code> uses the string method <span class="c004">replace</span> to replace
hyphens with spaces before using <span class="c004">split</span> to break the line into a
list of strings. It traverses the list of words and uses <span class="c004">strip</span>
and <span class="c004">lower</span> to remove punctuation and convert to lower case. (It
is a shorthand to say that strings are &#X201C;converted&#X201D;; remember that
strings are immutable, so methods like <span class="c004">strip</span> and <span class="c004">lower</span>
return new strings.)</p><p>Finally, <code>process_line</code> updates the histogram by creating a new
item or incrementing an existing one.
<a id="hevea_default1165"></a></p><p>To count the total number of words in the file, we can add up
the frequencies in the histogram:</p><pre class="verbatim">def total_words(hist):
    return sum(hist.values())
</pre><p>
The number of different words is just the number of items in
the dictionary:</p><pre class="verbatim">def different_words(hist):
    return len(hist)
</pre><p>
Here is some code to print the results:</p><pre class="verbatim">print('Total number of words:', total_words(hist))
print('Number of different words:', different_words(hist))
</pre><p>
And the results:</p><pre class="verbatim">Total number of words: 161080
Number of different words: 7214
</pre>
<h2 class="section" id="sec155">13.4&#XA0;&#XA0;Most common words</h2>
<p>To find the most common words, we can make a list of tuples,
where each tuple contains a word and its frequency,
and sort it.</p><p>The following function takes a histogram and returns a list of
word-frequency tuples:</p><pre class="verbatim">def most_common(hist):
    t = []
    for key, value in hist.items():
        t.append((value, key))

    t.sort(reverse=True)
    return t
</pre><p>In each tuple, the frequency appears first, so the resulting list is
sorted by frequency. Here is a loop that prints the ten most common
words:</p><pre class="verbatim">t = most_common(hist)
print('The most common words are:')
for freq, word in t[:10]:
    print(word, freq, sep='\t')
</pre><p>
I use the keyword argument <span class="c004">sep</span> to tell <span class="c004">print</span> to use a tab
character as a &#X201C;separator&#X201D;, rather than a space, so the second
column is lined up. Here are the results from <em>Emma</em>:</p><pre class="verbatim">The most common words are:
to      5242
the     5205
and     4897
of      4295
i       3191
a       3130
it      2529
her     2483
was     2400
she     2364
</pre><p>
This code can be simplified using the <span class="c004">key</span> parameter of
the <span class="c004">sort</span> function. If you are curious, you can read about it
at <a href="https://wiki.python.org/moin/HowTo/Sorting"><span class="c004">https://wiki.python.org/moin/HowTo/Sorting</span></a>.</p>
<h2 class="section" id="sec156">13.5&#XA0;&#XA0;Optional parameters</h2>
<p>
<a id="hevea_default1166"></a>
<a id="hevea_default1167"></a></p><p>We have seen built-in functions and methods that take optional
arguments. It is possible to write programmer-defined functions
with optional arguments, too. For example, here is a function that
prints the most common words in a histogram
<a id="hevea_default1168"></a>
<a id="hevea_default1169"></a></p><pre class="verbatim">def print_most_common(hist, num=10):
    t = most_common(hist)
    print('The most common words are:')
    for freq, word in t[:num]:
        print(word, freq, sep='\t')
</pre><p>The first parameter is required; the second is optional.
The <span class="c010">default value</span> of <span class="c004">num</span> is 10.
<a id="hevea_default1170"></a>
<a id="hevea_default1171"></a></p><p>If you only provide one argument:</p><pre class="verbatim">print_most_common(hist)
</pre><p><span class="c004">num</span> gets the default value. If you provide two arguments:</p><pre class="verbatim">print_most_common(hist, 20)
</pre><p><span class="c004">num</span> gets the value of the argument instead. In other
words, the optional argument <span class="c010">overrides</span> the default value.
<a id="hevea_default1172"></a></p><p>If a function has both required and optional parameters, all
the required parameters have to come first, followed by the
optional ones.</p>
<h2 class="section" id="sec157">13.6&#XA0;&#XA0;Dictionary subtraction</h2>
<p>
<a id="dictsub"></a>
<a id="hevea_default1173"></a>
<a id="hevea_default1174"></a></p><p>Finding the words from the book that are not in the word list
from <span class="c004">words.txt</span> is a problem you might recognize as set
subtraction; that is, we want to find all the words from one
set (the words in the book) that are not in the other (the
words in the list).</p><p><span class="c004">subtract</span> takes dictionaries <span class="c004">d1</span> and <span class="c004">d2</span> and returns a
new dictionary that contains all the keys from <span class="c004">d1</span> that are not
in <span class="c004">d2</span>. Since we don&#X2019;t really care about the values, we
set them all to None.</p><pre class="verbatim">def subtract(d1, d2):
    res = dict()
    for key in d1:
        if key not in d2:
            res[key] = None
    return res
</pre><p>
To find the words in the book that are not in <span class="c004">words.txt</span>,
we can use <code>process_file</code> to build a histogram for
<span class="c004">words.txt</span>, and then subtract:</p><pre class="verbatim">words = process_file('words.txt')
diff = subtract(hist, words)

print("Words in the book that aren't in the word list:")
for word in diff:
    print(word, end=' ')
</pre><p>
Here are some of the results from <em>Emma</em>:</p><pre class="verbatim">Words in the book that aren't in the word list:
rencontre jane's blanche woodhouses disingenuousness 
friend's venice apartment ...
</pre><p>
Some of these words are names and possessives. Others, like
&#X201C;rencontre&#X201D;, are no longer in common use. But a few are common
words that should really be in the list!</p><div class="theorem"><span class="c010">Exercise&#XA0;6</span>&#XA0;&#XA0;
<a id="hevea_default1175"></a>
<a id="hevea_default1176"></a><p><em>Python provides a data structure called <span class="c004">set</span> that provides many
common set operations. You can read about them in Section&#XA0;</em><a href="thinkpython2020.html#sets"><em>19.5</em></a><em>,
or read the documentation at
</em><a href="http://docs.python.org/3/library/stdtypes.html#types-set"><span class="c004"><em>http://docs.python.org/3/library/stdtypes.html#types-set</em></span></a><em>.</em></p><p><em>Write a program that uses set subtraction to find words in the book
that are not in the word list. Solution:
</em><a href="https://thinkpython.com/code/analyze_book2.py"><em><span class="c004">https://thinkpython.com/code/analyze_book2.py</span></em></a><em>.</em></p></div>
<h2 class="section" id="sec158">13.7&#XA0;&#XA0;Random words</h2>
<p>
<a id="randomwords"></a>
<a id="hevea_default1177"></a></p><p>To choose a random word from the histogram, the simplest algorithm
is to build a list with multiple copies of each word, according
to the observed frequency, and then choose from the list:</p><pre class="verbatim">def random_word(h):
    t = []
    for word, freq in h.items():
        t.extend([word] * freq)

    return random.choice(t)
</pre><p>
The expression <span class="c004">[word] * freq</span> creates a list with <span class="c004">freq</span>
copies of the string <span class="c004">word</span>. The <span class="c004">extend</span>
method is similar to <span class="c004">append</span> except that the argument is
a sequence.</p><p>This algorithm works, but it is not very efficient; each time you
choose a random word, it rebuilds the list, which is as big as
the original book. An obvious improvement is to build the list
once and then make multiple selections, but the list is still big.</p><p>An alternative is:</p><ol class="enumerate" type=1><li class="li-enumerate">Use <span class="c004">keys</span> to get a list of the words in the book.</li><li class="li-enumerate">Build a list that contains the cumulative sum of the word
frequencies (see Exercise&#XA0;<a href="thinkpython2011.html#cumulative">2</a>). The last item
in this list is the total number of words in the book, <span class="c009">n</span>.</li><li class="li-enumerate">Choose a random number from 1 to <span class="c009">n</span>. Use a bisection search
(See Exercise&#XA0;<a href="thinkpython2011.html#bisection">10</a>) to find the index where the random
number would be inserted in the cumulative sum.</li><li class="li-enumerate">Use the index to find the corresponding word in the word list.</li></ol><div class="theorem"><span class="c010">Exercise&#XA0;7</span>&#XA0;&#XA0;
<a id="randhist"></a>
<a id="hevea_default1178"></a><p><em>Write a program that uses this algorithm to choose a random word from
the book. Solution:
</em><a href="https://thinkpython.com/code/analyze_book3.py"><em><span class="c004">https://thinkpython.com/code/analyze_book3.py</span></em></a><em>.</em></p></div>
<h2 class="section" id="sec159">13.8&#XA0;&#XA0;Markov analysis</h2>
<p>
<a id="markov"></a>
<a id="hevea_default1179"></a></p><p>If you choose words from the book at random, you can get a
sense of the vocabulary, but you probably won&#X2019;t get a sentence:</p><pre class="verbatim">this the small regard harriet which knightley's it most things
</pre><p>
A series of random words seldom makes sense because there
is no relationship between successive words. For example, in
a real sentence you would expect an article like &#X201C;the&#X201D; to
be followed by an adjective or a noun, and probably not a verb
or adverb.</p><p>One way to measure these kinds of relationships is Markov
analysis, which
characterizes, for a given sequence of words, the probability of the
words that might come next. For example, the song <em>Eric, the Half a
Bee</em> begins:</p><blockquote class="quote">
Half a bee, philosophically, <br>
Must, ipso facto, half not be. <br>
But half the bee has got to be <br>
Vis a vis, its entity. D&#X2019;you see? <br>
<br>
But can a bee be said to be <br>
Or not to be an entire bee <br>
When half the bee is not a bee <br>
Due to some ancient injury? <br>
</blockquote><p>
In this text,
the phrase &#X201C;half the&#X201D; is always followed by the word &#X201C;bee&#X201D;,
but the phrase &#X201C;the bee&#X201D; might be followed by either
&#X201C;has&#X201D; or &#X201C;is&#X201D;.
<a id="hevea_default1180"></a>
<a id="hevea_default1181"></a>
<a id="hevea_default1182"></a></p><p>The result of Markov analysis is a mapping from each prefix
(like &#X201C;half the&#X201D; and &#X201C;the bee&#X201D;) to all possible suffixes
(like &#X201C;has&#X201D; and &#X201C;is&#X201D;).
<a id="hevea_default1183"></a>
<a id="hevea_default1184"></a></p><p>Given this mapping, you can generate a random text by
starting with any prefix and choosing at random from the
possible suffixes. Next, you can combine the end of the
prefix and the new suffix to form the next prefix, and repeat.</p><p>For example, if you start with the prefix &#X201C;Half a&#X201D;, then the
next word has to be &#X201C;bee&#X201D;, because the prefix only appears
once in the text. The next prefix is &#X201C;a bee&#X201D;, so the
next suffix might be &#X201C;philosophically&#X201D;, &#X201C;be&#X201D; or &#X201C;due&#X201D;.</p><p>In this example the length of the prefix is always two, but
you can do Markov analysis with any prefix length.</p><div class="theorem"><span class="c010">Exercise&#XA0;8</span>&#XA0;&#XA0;<p><em>Markov analysis:</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>Write a program to read a text from a file and perform Markov
analysis. The result should be a dictionary that maps from
prefixes to a collection of possible suffixes. The collection
might be a list, tuple, or dictionary; it is up to you to make
an appropriate choice. You can test your program with prefix
length two, but you should write the program in a way that makes
it easy to try other lengths.</em></li><li class="li-enumerate"><em>Add a function to the previous program to generate random text
based on the Markov analysis. Here is an example from </em>Emma<em>
with prefix length 2:</em><blockquote class="quote"><em>
He was very clever, be it sweetness or be angry, ashamed or only
amused, at such a stroke. She had never thought of Hannah till you
were never meant for me?" "I cannot make speeches, Emma:" he soon cut
it all himself.
</em></blockquote><p><em>For this example, I left the punctuation attached to the words.
The result is almost syntactically correct, but not quite.
Semantically, it almost makes sense, but not quite.</em></p><p><em>What happens if you increase the prefix length? Does the random
text make more sense?</em></p></li><li class="li-enumerate"><em>Once your program is working, you might want to try a mash-up:
if you combine text from two or more books, the random
text you generate will blend the vocabulary and phrases from
the sources in interesting ways.
</em><a id="hevea_default1185"></a></li></ol><p><em>Credit: This case study is based on an example from Kernighan and
Pike, </em>The Practice of Programming<em>, Addison-Wesley, 1999.</em></p></div><p>You should attempt this exercise before you go on; then you can
download my solution from <a href="https://thinkpython.com/code/markov.py"><span class="c004">https://thinkpython.com/code/markov.py</span></a>.
You will also need <a href="https://thinkpython.com/code/emma.txt"><span class="c004">https://thinkpython.com/code/emma.txt</span></a>.</p>
<h2 class="section" id="sec160">13.9&#XA0;&#XA0;Data structures</h2>
<p>
<a id="hevea_default1186"></a></p><p>Using Markov analysis to generate random text is fun, but there is
also a point to this exercise: data structure selection. In your
solution to the previous exercises, you had to choose:</p><ul class="itemize"><li class="li-itemize">How to represent the prefixes.</li><li class="li-itemize">How to represent the collection of possible suffixes.</li><li class="li-itemize">How to represent the mapping from each prefix to
the collection of possible suffixes.</li></ul><p>The last one is easy: a dictionary is the obvious choice
for a mapping from keys to corresponding values.</p><p>For the prefixes, the most obvious options are string,
list of strings, or tuple of strings.</p><p>For the suffixes,
one option is a list; another is a histogram (dictionary).
<a id="hevea_default1187"></a></p><p>How should you choose? The first step is to think about
the operations you will need to implement for each data structure.
For the prefixes, we need to be able to remove words from
the beginning and add to the end. For example, if the current
prefix is &#X201C;Half a&#X201D;, and the next word is &#X201C;bee&#X201D;, you need
to be able to form the next prefix, &#X201C;a bee&#X201D;.
<a id="hevea_default1188"></a></p><p>Your first choice might be a list, since it is easy to add
and remove elements, but we also need to be able to use the
prefixes as keys in a dictionary, so that rules out lists.
With tuples, you can&#X2019;t append or remove, but you can use
the addition operator to form a new tuple:</p><pre class="verbatim">def shift(prefix, word):
    return prefix[1:] + (word,)
</pre><p>
<span class="c004">shift</span> takes a tuple of words, <span class="c004">prefix</span>, and a string, 
<span class="c004">word</span>, and forms a new tuple that has all the words
in <span class="c004">prefix</span> except the first, and <span class="c004">word</span> added to
the end.</p><p>For the collection of suffixes, the operations we need to
perform include adding a new suffix (or increasing the frequency
of an existing one), and choosing a random suffix.</p><p>Adding a new suffix is equally easy for the list implementation
or the histogram. Choosing a random element from a list
is easy; choosing from a histogram is harder to do
efficiently (see Exercise&#XA0;<a href="#randhist">7</a>).</p><p>So far we have been talking mostly about ease of implementation,
but there are other factors to consider in choosing data structures.
One is run time. Sometimes there is a theoretical reason to expect
one data structure to be faster than other; for example, I mentioned
that the <span class="c004">in</span> operator is faster for dictionaries than for lists,
at least when the number of elements is large.</p><p>But often you don&#X2019;t know ahead of time which implementation will
be faster. One option is to implement both of them and see which
is better. This approach is called <span class="c010">benchmarking</span>. A practical
alternative is to choose the data structure that is
easiest to implement, and then see if it is fast enough for the
intended application. If so, there is no need to go on. If not,
there are tools, like the <span class="c004">profile</span> module, that can identify
the places in a program that take the most time.
<a id="hevea_default1189"></a>
<a id="hevea_default1190"></a>
<a id="hevea_default1191"></a></p><p>The other factor to consider is storage space. For example, using a
histogram for the collection of suffixes might take less space because
you only have to store each word once, no matter how many times it
appears in the text. In some cases, saving space can also make your
program run faster, and in the extreme, your program might not run at
all if you run out of memory. But for many applications, space is a
secondary consideration after run time.</p><p>One final thought: in this discussion, I have implied that
we should use one data structure for both analysis and generation. But
since these are separate phases, it would also be possible to use one
structure for analysis and then convert to another structure for
generation. This would be a net win if the time saved during
generation exceeded the time spent in conversion.</p>
<h2 class="section" id="sec161">13.10&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hevea_default1192"></a></p><p>When you are debugging a program, and especially if you are
working on a hard bug, there are five things to try:</p><dl class="description"><dt class="dt-description"><span class="c010">Reading:</span></dt><dd class="dd-description"> Examine your code, read it back to yourself, and
check that it says what you meant to say.</dd><dt class="dt-description"><span class="c010">Running:</span></dt><dd class="dd-description"> Experiment by making changes and running different
versions. Often if you display the right thing at the right place
in the program, the problem becomes obvious, but sometimes you have to
build scaffolding.</dd><dt class="dt-description"><span class="c010">Ruminating:</span></dt><dd class="dd-description"> Take some time to think! What kind of error
is it: syntax, runtime, or semantic? What information can you get from
the error messages, or from the output of the program? What kind of
error could cause the problem you&#X2019;re seeing? What did you change
last, before the problem appeared?</dd><dt class="dt-description"><span class="c010">Rubberducking:</span></dt><dd class="dd-description"> If you explain the problem to someone else, you
sometimes find the answer before you finish asking the question.
Often you don&#X2019;t need the other person; you could just talk to a rubber
duck. And that&#X2019;s the origin of the well-known strategy called <span class="c010">rubber duck debugging</span>. I am not making this up; see
<a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging"><span class="c004">https://en.wikipedia.org/wiki/Rubber_duck_debugging</span></a>.</dd><dt class="dt-description"><span class="c010">Retreating:</span></dt><dd class="dd-description"> At some point, the best thing to do is back
off, undoing recent changes, until you get back to a program that
works and that you understand. Then you can start rebuilding.</dd></dl><p>Beginning programmers sometimes get stuck on one of these activities
and forget the others. Each activity comes with its own failure
mode.
<a id="hevea_default1193"></a></p><p>For example, reading your code might help if the problem is a
typographical error, but not if the problem is a conceptual
misunderstanding. If you don&#X2019;t understand what your program does, you
can read it 100 times and never see the error, because the error is in
your head.
<a id="hevea_default1194"></a></p><p>Running experiments can help, especially if you run small, simple
tests. But if you run experiments without thinking or reading your
code, you might fall into a pattern I call &#X201C;random walk programming&#X201D;,
which is the process of making random changes until the program
does the right thing. Needless to say, random walk programming
can take a long time.
<a id="hevea_default1195"></a>
<a id="hevea_default1196"></a></p><p>You have to take time to think. Debugging is like an
experimental science. You should have at least one hypothesis about
what the problem is. If there are two or more possibilities, try to
think of a test that would eliminate one of them.</p><p>But even the best debugging techniques will fail if there are too many
errors, or if the code you are trying to fix is too big and
complicated. Sometimes the best option is to retreat, simplifying the
program until you get to something that works and that you
understand.</p><p>Beginning programmers are often reluctant to retreat because
they can&#X2019;t stand to delete a line of code (even if it&#X2019;s wrong).
If it makes you feel better, copy your program into another file
before you start stripping it down. Then you can copy the pieces
back one at a time.</p><p>Finding a hard bug requires reading, running, ruminating, and
sometimes retreating. If you get stuck on one of these activities,
try the others.</p>
<h2 class="section" id="sec162">13.11&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">deterministic:</span></dt><dd class="dd-description"> Pertaining to a program that does the same
thing each time it runs, given the same inputs.
<a id="hevea_default1197"></a></dd><dt class="dt-description"><span class="c010">pseudorandom:</span></dt><dd class="dd-description"> Pertaining to a sequence of numbers that appears
to be random, but is generated by a deterministic program.
<a id="hevea_default1198"></a></dd><dt class="dt-description"><span class="c010">default value:</span></dt><dd class="dd-description"> The value given to an optional parameter if no
argument is provided.
<a id="hevea_default1199"></a></dd><dt class="dt-description"><span class="c010">override:</span></dt><dd class="dd-description"> To replace a default value with an argument.
<a id="hevea_default1200"></a></dd><dt class="dt-description"><span class="c010">benchmarking:</span></dt><dd class="dd-description"> The process of choosing between data structures
by implementing alternatives and testing them on a sample of the
possible inputs. 
<a id="hevea_default1201"></a></dd><dt class="dt-description"><span class="c010">rubber duck debugging:</span></dt><dd class="dd-description"> Debugging by explaining your problem
to an inanimate object such as a rubber duck. Articulating the
problem can help you solve it, even if the rubber duck doesn&#X2019;t know
Python. 
<a id="hevea_default1202"></a>
<a id="hevea_default1203"></a></dd></dl>
<h2 class="section" id="sec163">13.12&#XA0;&#XA0;Exercises</h2>
<div class="theorem"><span class="c010">Exercise&#XA0;9</span>&#XA0;&#XA0;
<a id="hevea_default1204"></a>
<a id="hevea_default1205"></a>
<a id="hevea_default1206"></a><p><em>The &#X201C;rank&#X201D; of a word is its position in a list of words
sorted by frequency: the most common word has rank 1, the
second most common has rank 2, etc.</em></p><p><em>Zipf&#X2019;s law describes a relationship between the ranks and frequencies
of words in natural languages
(</em><a href="http://en.wikipedia.org/wiki/Zipf's_law"><em><span class="c004">http://en.wikipedia.org/wiki/Zipf's_law</span></em></a><em>). Specifically, it
predicts that the frequency, </em><span class="c009">f</span><em>, of the word with rank </em><span class="c009">r</span><em> is:</em></p><table class="display dcenter"><tr class="c017"><td class="dcell"><span class="c009">f</span>&#XA0;=&#XA0;<span class="c009">c</span>&#XA0;<span class="c009">r</span><sup>&#X2212;<span class="c009">s</span></sup>&#XA0;</td></tr>
</table><p><em>
where </em><span class="c009">s</span><em> and </em><span class="c009">c</span><em> are parameters that depend on the language and the
text. If you take the logarithm of both sides of this equation, you
get:
</em><a id="hevea_default1207"></a></p><table class="display dcenter"><tr class="c017"><td class="dcell">log<span class="c009">f</span>&#XA0;=&#XA0;log<span class="c009">c</span>&#XA0;&#X2212;&#XA0;<span class="c009">s</span>&#XA0;log<span class="c009">r</span>&#XA0;</td></tr>
</table><p><em>
So if you plot log </em><span class="c009">f</span><em> versus log </em><span class="c009">r</span><em>, you should get
a straight line with slope </em>&#X2212;<span class="c009">s</span><em> and intercept log </em><span class="c009">c</span><em>.</em></p><p><em>Write a program that reads a text from a file, counts
word frequencies, and prints one line
for each word, in descending order of frequency, with
log </em><span class="c009">f</span><em> and log </em><span class="c009">r</span><em>. Use the graphing program of your
choice to plot the results and check whether they form
a straight line. Can you estimate the value of </em><span class="c009">s</span><em>?</em></p><p><em>Solution: </em><a href="https://thinkpython.com/code/zipf.py"><span class="c004"><em>https://thinkpython.com/code/zipf.py</em></span></a><em>.
To run my solution, you need the plotting module <span class="c004">matplotlib</span>.
If you installed Anaconda, you already have <span class="c004">matplotlib</span>;
otherwise you might have to install it.
</em><a id="hevea_default1208"></a></p></div>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2013.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2015.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Files</title>
</head>
<body>
<a href="thinkpython2014.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2016.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec164">Chapter&#XA0;14&#XA0;&#XA0;Files</h1>
<p>This chapter introduces the idea of &#X201C;persistent&#X201D; programs that
keep data in permanent storage, and shows how to use different
kinds of permanent storage, like files and databases.</p>
<h2 class="section" id="sec165">14.1&#XA0;&#XA0;Persistence</h2>
<p>
<a id="hevea_default1209"></a>
<a id="hevea_default1210"></a>
<a id="hevea_default1211"></a></p><p>Most of the programs we have seen so far are transient in the
sense that they run for a short time and produce some output,
but when they end, their data disappears. If you run the program
again, it starts with a clean slate.</p><p>Other programs are <span class="c010">persistent</span>: they run for a long time
(or all the time); they keep at least some of their data
in permanent storage (a hard drive, for example); and
if they shut down and restart, they pick up where they left off.</p><p>Examples of persistent programs are operating systems, which
run pretty much whenever a computer is on, and web servers,
which run all the time, waiting for requests to come in on
the network.</p><p>One of the simplest ways for programs to maintain their data
is by reading and writing text files. We have already seen
programs that read text files; in this chapter we will see programs
that write them.</p><p>An alternative is to store the state of the program in a database.
In this chapter I will present a simple database and a module,
<span class="c004">pickle</span>, that makes it easy to store program data.
<a id="hevea_default1212"></a>
<a id="hevea_default1213"></a></p>
<h2 class="section" id="sec166">14.2&#XA0;&#XA0;Reading and writing</h2>
<p>
<a id="hevea_default1214"></a></p><p>A text file is a sequence of characters stored on a permanent
medium like a hard drive, flash memory, or CD-ROM. We saw how
to open and read a file in Section&#XA0;<a href="thinkpython2010.html#wordlist">9.1</a>.
<a id="hevea_default1215"></a>
<a id="hevea_default1216"></a></p><p>To write a file, you have to open it with mode <code>'w'</code> as a second
parameter:</p><pre class="verbatim">&gt;&gt;&gt; fout = open('output.txt', 'w')
</pre><p>
If the file already exists, opening it in write mode clears out
the old data and starts fresh, so be careful!
If the file doesn&#X2019;t exist, a new one is created.</p><p><span class="c004">open</span> returns a file object that provides methods for working
with the file.
The <span class="c004">write</span> method puts data into the file.</p><pre class="verbatim">&gt;&gt;&gt; line1 = "This here's the wattle,\n"
&gt;&gt;&gt; fout.write(line1)
24
</pre><p>
The return value is the number of characters that were written.
The file object keeps track of where it is, so if
you call <span class="c004">write</span> again, it adds the new data to the end of
the file.</p><pre class="verbatim">&gt;&gt;&gt; line2 = "the emblem of our land.\n"
&gt;&gt;&gt; fout.write(line2)
24
</pre><p>
When you are done writing, you should close the file.</p><pre class="verbatim">&gt;&gt;&gt; fout.close()
</pre><p>
<a id="hevea_default1217"></a>
<a id="hevea_default1218"></a>
If you don&#X2019;t close the file, it gets closed for you when the
program ends.</p>
<h2 class="section" id="sec167">14.3&#XA0;&#XA0;Format operator</h2>
<p>
<a id="hevea_default1219"></a>
<a id="hevea_default1220"></a></p><p>The argument of <span class="c004">write</span> has to be a string, so if we want
to put other values in a file, we have to convert them to
strings. The easiest way to do that is with <span class="c004">str</span>:</p><pre class="verbatim">&gt;&gt;&gt; x = 52
&gt;&gt;&gt; fout.write(str(x))
</pre><p>
An alternative is to use the <span class="c010">format operator</span>, <span class="c004">%</span>. When
applied to integers, <span class="c004">%</span> is the modulus operator. But
when the first operand is a string, <span class="c004">%</span> is the format operator.
<a id="hevea_default1221"></a></p><p>The first operand is the <span class="c010">format string</span>, which contains
one or more <span class="c010">format sequences</span>, which
specify how
the second operand is formatted. The result is a string.
<a id="hevea_default1222"></a></p><p>For example, the format sequence <code>'%d'</code> means that
the second operand should be formatted as a decimal
integer:</p><pre class="verbatim">&gt;&gt;&gt; camels = 42
&gt;&gt;&gt; '%d' % camels
'42'
</pre><p>
The result is the string <code>'42'</code>, which is not to be confused
with the integer value <span class="c004">42</span>.</p><p>A format sequence can appear anywhere in the string,
so you can embed a value in a sentence:</p><pre class="verbatim">&gt;&gt;&gt; 'I have spotted %d camels.' % camels
'I have spotted 42 camels.'
</pre><p>
If there is more than one format sequence in the string,
the second argument has to be a tuple. Each format sequence is
matched with an element of the tuple, in order.</p><p>The following example uses <code>'%d'</code> to format an integer,
<code>'%g'</code> to format a floating-point number, and
<code>'%s'</code> to format a string:</p><pre class="verbatim">&gt;&gt;&gt; 'In %d years I have spotted %g %s.' % (3, 0.1, 'camels')
'In 3 years I have spotted 0.1 camels.'
</pre><p>
The number of elements in the tuple has to match the number
of format sequences in the string. Also, the types of the
elements have to match the format sequences:
<a id="hevea_default1223"></a>
<a id="hevea_default1224"></a></p><pre class="verbatim">&gt;&gt;&gt; '%d %d %d' % (1, 2)
TypeError: not enough arguments for format string
&gt;&gt;&gt; '%d' % 'dollars'
TypeError: %d format: a number is required, not str
</pre><p>
In the first example, there aren&#X2019;t enough elements; in the
second, the element is the wrong type.</p><p>For more information on the format operator, see
<a href="https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting"><span class="c004">https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting</span></a>. A more powerful alternative is the string
format method, which you can read about at
<a href="https://docs.python.org/3/library/stdtypes.html#str.format"><span class="c004">https://docs.python.org/3/library/stdtypes.html#str.format</span></a>.</p>
<h2 class="section" id="sec168">14.4&#XA0;&#XA0;Filenames and paths</h2>
<p>
<a id="paths"></a>
<a id="hevea_default1225"></a>
<a id="hevea_default1226"></a>
<a id="hevea_default1227"></a>
<a id="hevea_default1228"></a></p><p>Files are organized into <span class="c010">directories</span> (also called &#X201C;folders&#X201D;).
Every running program has a &#X201C;current directory&#X201D;, which is the
default directory for most operations. 
For example, when you open a file for reading, Python looks for it in the
current directory.
<a id="hevea_default1229"></a>
<a id="hevea_default1230"></a></p><p>The <span class="c004">os</span> module provides functions for working with files and
directories (&#X201C;os&#X201D; stands for &#X201C;operating system&#X201D;). <span class="c004">os.getcwd</span>
returns the name of the current directory:
<a id="hevea_default1231"></a>
<a id="hevea_default1232"></a></p><pre class="verbatim">&gt;&gt;&gt; import os
&gt;&gt;&gt; cwd = os.getcwd()
&gt;&gt;&gt; cwd
'/home/dinsdale'
</pre><p>
<span class="c004">cwd</span> stands for &#X201C;current working directory&#X201D;. The result in
this example is <span class="c004">/home/dinsdale</span>, which is the home directory of a
user named <span class="c004">dinsdale</span>.
<a id="hevea_default1233"></a>
<a id="hevea_default1234"></a></p><p>A string like <code>'/home/dinsdale'</code> that identifies a file or
directory is called a <span class="c010">path</span>.</p><p>A simple filename, like <span class="c004">memo.txt</span> is also considered a path,
but it is a <span class="c010">relative path</span> because it relates to the current
directory. If the current directory is <span class="c004">/home/dinsdale</span>, the
filename <span class="c004">memo.txt</span> would refer to <span class="c004">/home/dinsdale/memo.txt</span>.
<a id="hevea_default1235"></a> <a id="hevea_default1236"></a>
<a id="hevea_default1237"></a> <a id="hevea_default1238"></a></p><p>A path that begins with <span class="c004">/</span> does not depend on the current
directory; it is called an <span class="c010">absolute path</span>. To find the absolute
path to a file, you can use <span class="c004">os.path.abspath</span>:</p><pre class="verbatim">&gt;&gt;&gt; os.path.abspath('memo.txt')
'/home/dinsdale/memo.txt'
</pre><p>
<span class="c004">os.path</span> provides other functions for working with filenames
and paths. For example,
<span class="c004">os.path.exists</span> checks
whether a file or directory exists:
<a id="hevea_default1239"></a>
<a id="hevea_default1240"></a></p><pre class="verbatim">&gt;&gt;&gt; os.path.exists('memo.txt')
True
</pre><p>
If it exists, <span class="c004">os.path.isdir</span> checks whether it&#X2019;s a directory:</p><pre class="verbatim">&gt;&gt;&gt; os.path.isdir('memo.txt')
False
&gt;&gt;&gt; os.path.isdir('/home/dinsdale')
True
</pre><p>
Similarly, <span class="c004">os.path.isfile</span> checks whether it&#X2019;s a file.</p><p><span class="c004">os.listdir</span> returns a list of the files (and other directories)
in the given directory:</p><pre class="verbatim">&gt;&gt;&gt; os.listdir(cwd)
['music', 'photos', 'memo.txt']
</pre><p>
To demonstrate these functions, the following example
&#X201C;walks&#X201D; through a directory, prints
the names of all the files, and calls itself recursively on
all the directories.
<a id="hevea_default1241"></a>
<a id="hevea_default1242"></a></p><pre class="verbatim">def walk(dirname):
    for name in os.listdir(dirname):
        path = os.path.join(dirname, name)

        if os.path.isfile(path):
            print(path)
        else:
            walk(path)
</pre><p>
<span class="c004">os.path.join</span> takes a directory and a file name and joins
them into a complete path. </p><p>The <span class="c004">os</span> module provides a function called <span class="c004">walk</span> that is
similar to this one but more versatile. As an exercise, read the
documentation and use it to print the names of the files in a given
directory and its subdirectories. You can download my solution from
<a href="https://thinkpython.com/code/walk.py"><span class="c004">https://thinkpython.com/code/walk.py</span></a>.</p>
<h2 class="section" id="sec169">14.5&#XA0;&#XA0;Catching exceptions</h2>
<p>
<a id="catch"></a></p><p>A lot of things can go wrong when you try to read and write
files. If you try to open a file that doesn&#X2019;t exist, you get an
<span class="c004">FileNotFoundError</span>:
<a id="hevea_default1243"></a>
<a id="hevea_default1244"></a>
<a id="hevea_default1245"></a>
<a id="hevea_default1246"></a></p><pre class="verbatim">&gt;&gt;&gt; fin = open('bad_file')
FileNotFoundError: [Errno 2] No such file or directory: 'bad_file'

</pre><p>
If you don&#X2019;t have permission to access a file:
<a id="hevea_default1247"></a>
<a id="hevea_default1248"></a></p><pre class="verbatim">&gt;&gt;&gt; fout = open('/etc/passwd', 'w')
PermissionError: [Errno 13] Permission denied: '/etc/passwd'
</pre><p>
And if you try to open a directory for reading, you get</p><pre class="verbatim">&gt;&gt;&gt; fin = open('/home')
IsADirectoryError: [Errno 21] Is a directory: '/home'
</pre><p>
To avoid these errors, you could use functions like <span class="c004">os.path.exists</span>
and <span class="c004">os.path.isfile</span>, but it would take a lot of time and code
to check all the possibilities (if &#X201C;<span class="c004">Errno 21</span>&#X201D; is any
indication, there are at least 21 things that can go wrong).
<a id="hevea_default1249"></a>
<a id="hevea_default1250"></a>
<a id="hevea_default1251"></a></p><p>It is better to go ahead and try&#X2014;and deal with problems if they
happen&#X2014;which is exactly what the <span class="c004">try</span> statement does. The
syntax is similar to an <span class="c004">if...else</span> statement:</p><pre class="verbatim">try:    
    fin = open('bad_file')
except:
    print('Something went wrong.')
</pre><p>
Python starts by executing the <span class="c004">try</span> clause. If all goes
well, it skips the <span class="c004">except</span> clause and proceeds. If an
exception occurs, it jumps out of the <span class="c004">try</span> clause and
runs the <span class="c004">except</span> clause.</p><p>Handling an exception with a <span class="c004">try</span> statement is called <span class="c010">catching</span> an exception. In this example, the <span class="c004">except</span> clause
prints an error message that is not very helpful. In general,
catching an exception gives you a chance to fix the problem, or try
again, or at least end the program gracefully.</p>
<h2 class="section" id="sec170">14.6&#XA0;&#XA0;Databases</h2>
<p>
<a id="hevea_default1252"></a></p><p>A <span class="c010">database</span> is a file that is organized for storing data. Many
databases are organized like a dictionary in the sense that they map
from keys to values. The biggest difference between a database and a
dictionary is that the database is on disk (or other permanent
storage), so it persists after the program ends. <a id="hevea_default1253"></a> <a id="hevea_default1254"></a></p><p>The module <span class="c004">dbm</span> provides an interface for creating
and updating database files.
As an example, I&#X2019;ll create a database
that contains captions for image files.
<a id="hevea_default1255"></a>
<a id="hevea_default1256"></a></p><p>Opening a database is similar to opening other files:</p><pre class="verbatim">&gt;&gt;&gt; import dbm
&gt;&gt;&gt; db = dbm.open('captions', 'c')
</pre><p>
The mode <code>'c'</code> means that the database should be created if
it doesn&#X2019;t already exist. The result is a database object
that can be used (for most operations) like a dictionary.
<a id="hevea_default1257"></a>
<a id="hevea_default1258"></a></p><p>When you create a new item, <span class="c004">dbm</span> updates the database file.
<a id="hevea_default1259"></a></p><pre class="verbatim">&gt;&gt;&gt; db['cleese.png'] = 'Photo of John Cleese.'
</pre><p>
When you access one of the items, <span class="c004">dbm</span> reads the file:</p><pre class="verbatim">&gt;&gt;&gt; db['cleese.png']
b'Photo of John Cleese.'
</pre><p>
The result is a <span class="c010">bytes object</span>, which is why it begins with <span class="c004">b</span>. A bytes object is similar to a string in many ways. When you
get farther into Python, the difference becomes important, but for now
we can ignore it.
<a id="hevea_default1260"></a>
<a id="hevea_default1261"></a></p><p>If you make another assignment to an existing key, <span class="c004">dbm</span> replaces
the old value:</p><pre class="verbatim">&gt;&gt;&gt; db['cleese.png'] = 'Photo of John Cleese doing a silly walk.'
&gt;&gt;&gt; db['cleese.png']
b'Photo of John Cleese doing a silly walk.'
</pre><p>Some dictionary methods, like <span class="c004">keys</span> and <span class="c004">items</span>, don&#X2019;t
work with database objects. But iteration with a <span class="c004">for</span>
loop works:
<a id="hevea_default1262"></a></p><pre class="verbatim">for key in db.keys():
    print(key, db[key])
</pre><p>
As with other files, you should close the database when you are
done:</p><pre class="verbatim">&gt;&gt;&gt; db.close()
</pre><p>
<a id="hevea_default1263"></a>
<a id="hevea_default1264"></a></p>
<h2 class="section" id="sec171">14.7&#XA0;&#XA0;Pickling</h2>
<p>
<a id="hevea_default1265"></a></p><p>A limitation of <span class="c004">dbm</span> is that the keys and values have to be
strings or bytes. If you try to use any other type, you get an error.
<a id="hevea_default1266"></a> <a id="hevea_default1267"></a></p><p>The <span class="c004">pickle</span> module can help. It translates
almost any type of object into a string suitable for storage in a
database, and then translates strings back into objects.</p><p><span class="c004">pickle.dumps</span> takes an object as a parameter and returns
a string representation (<span class="c004">dumps</span> is short for &#X201C;dump string&#X201D;):</p><pre class="verbatim">&gt;&gt;&gt; import pickle
&gt;&gt;&gt; t = [1, 2, 3]
&gt;&gt;&gt; pickle.dumps(t)
b'\x80\x03]q\x00(K\x01K\x02K\x03e.'
</pre><p>
The format isn&#X2019;t obvious to human readers; it is meant to be
easy for <span class="c004">pickle</span> to interpret. <span class="c004">pickle.loads</span>
(&#X201C;load string&#X201D;) reconstitutes the object:</p><pre class="verbatim">&gt;&gt;&gt; t1 = [1, 2, 3]
&gt;&gt;&gt; s = pickle.dumps(t1)
&gt;&gt;&gt; t2 = pickle.loads(s)
&gt;&gt;&gt; t2
[1, 2, 3]
</pre><p>
Although the new object has the same value as the old, it is
not (in general) the same object:</p><pre class="verbatim">&gt;&gt;&gt; t1 == t2
True
&gt;&gt;&gt; t1 is t2
False
</pre><p>
In other words, pickling and then unpickling has the same effect
as copying the object.</p><p>You can use <span class="c004">pickle</span> to store non-strings in a database.
In fact, this combination is so common that it has been
encapsulated in a module called <span class="c004">shelve</span>. 
<a id="hevea_default1268"></a>
<a id="hevea_default1269"></a></p>
<h2 class="section" id="sec172">14.8&#XA0;&#XA0;Pipes</h2>
<p>
<a id="hevea_default1270"></a>
<a id="hevea_default1271"></a></p><p>Most operating systems provide a command-line interface,
also known as a <span class="c010">shell</span>. Shells usually provide commands
to navigate the file system and launch applications. For
example, in Unix you can change directories with <span class="c004">cd</span>,
display the contents of a directory with <span class="c004">ls</span>, and launch
a web browser by typing (for example) <span class="c004">firefox</span>.
<a id="hevea_default1272"></a>
<a id="hevea_default1273"></a></p><p>Any program that you can launch from the shell can also be
launched from Python using a <span class="c010">pipe object</span>, which
represents a running program.</p><p>For example, the Unix command <span class="c004">ls -l</span> normally displays the
contents of the current directory in long format. You can
launch <span class="c004">ls</span> with <span class="c004">os.popen</span><sup><a id="text1" href="#note1">1</a></sup>:
<a id="hevea_default1274"></a>
<a id="hevea_default1275"></a></p><pre class="verbatim">&gt;&gt;&gt; cmd = 'ls -l'
&gt;&gt;&gt; fp = os.popen(cmd)
</pre><p>
The argument is a string that contains a shell command. The
return value is an object that behaves like an open
file. You can read the output from the <span class="c004">ls</span> process one
line at a time with <span class="c004">readline</span> or get the whole thing at
once with <span class="c004">read</span>:
<a id="hevea_default1276"></a>
<a id="hevea_default1277"></a>
<a id="hevea_default1278"></a>
<a id="hevea_default1279"></a></p><pre class="verbatim">&gt;&gt;&gt; res = fp.read()
</pre><p>
When you are done, you close the pipe like a file:
<a id="hevea_default1280"></a>
<a id="hevea_default1281"></a></p><pre class="verbatim">&gt;&gt;&gt; stat = fp.close()
&gt;&gt;&gt; print(stat)
None
</pre><p>
The return value is the final status of the <span class="c004">ls</span> process;
<span class="c004">None</span> means that it ended normally (with no errors).</p><p>For example, most Unix systems provide a command called <span class="c004">md5sum</span>
that reads the contents of a file and computes a &#X201C;checksum&#X201D;.
You can read about MD5 at <a href="http://en.wikipedia.org/wiki/Md5"><span class="c004">http://en.wikipedia.org/wiki/Md5</span></a>. This
command provides an efficient way to check whether two files
have the same contents. The probability that different contents
yield the same checksum is very small (that is, unlikely to happen
before the universe collapses).
<a id="hevea_default1282"></a>
<a id="hevea_default1283"></a></p><p>You can use a pipe to run <span class="c004">md5sum</span> from Python and get the result:</p><pre class="verbatim">&gt;&gt;&gt; filename = 'book.tex'
&gt;&gt;&gt; cmd = 'md5sum ' + filename
&gt;&gt;&gt; fp = os.popen(cmd)
&gt;&gt;&gt; res = fp.read()
&gt;&gt;&gt; stat = fp.close()
&gt;&gt;&gt; print(res)
1e0033f0ed0656636de0d75144ba32e0  book.tex
&gt;&gt;&gt; print(stat)
None
</pre>
<h2 class="section" id="sec173">14.9&#XA0;&#XA0;Writing modules</h2>
<p>
<a id="modules"></a>
<a id="hevea_default1284"></a>
<a id="hevea_default1285"></a></p><p>Any file that contains Python code can be imported as a module.
For example, suppose you have a file named <span class="c004">wc.py</span> with the following
code:</p><pre class="verbatim">def linecount(filename):
    count = 0
    for line in open(filename):
        count += 1
    return count

print(linecount('wc.py'))
</pre><p>
If you run this program, it reads itself and prints the number
of lines in the file, which is 7.
You can also import it like this:</p><pre class="verbatim">&gt;&gt;&gt; import wc
7
</pre><p>
Now you have a module object <span class="c004">wc</span>:
<a id="hevea_default1286"></a>
<a id="hevea_default1287"></a></p><pre class="verbatim">&gt;&gt;&gt; wc
&lt;module 'wc' from 'wc.py'&gt;
</pre><p>
The module object provides <code>linecount</code>:</p><pre class="verbatim">&gt;&gt;&gt; wc.linecount('wc.py')
7
</pre><p>
So that&#X2019;s how you write modules in Python.</p><p>The only problem with this example is that when you import
the module it runs the test code at the bottom. Normally
when you import a module, it defines new functions but it
doesn&#X2019;t run them.
<a id="hevea_default1288"></a>
<a id="hevea_default1289"></a></p><p>Programs that will be imported as modules often
use the following idiom:</p><pre class="verbatim">if __name__ == '__main__':
    print(linecount('wc.py'))
</pre><p>
<code>__name__</code> is a built-in variable that is set when the
program starts. If the program is running as a script,
<code>__name__</code> has the value <code>'__main__'</code>; in that
case, the test code runs. Otherwise,
if the module is being imported, the test code is skipped.</p><p><a id="hevea_default1290"></a>
<a id="hevea_default1291"></a></p><p>As an exercise, type this example into a file named <span class="c004">wc.py</span> and run
it as a script. Then run the Python interpreter and
<span class="c004">import wc</span>. What is the value of <code>__name__</code>
when the module is being imported?</p><p>Warning: If you import a module that has already been imported,
Python does nothing. It does not re-read the file, even if it has
changed.
<a id="hevea_default1292"></a>
<a id="hevea_default1293"></a>
<a id="hevea_default1294"></a></p><p>If you want to reload a module, you can use the built-in function 
<span class="c004">reload</span>, but it can be tricky, so the safest thing to do is
restart the interpreter and then import the module again.</p>
<h2 class="section" id="sec174">14.10&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hevea_default1295"></a>
<a id="hevea_default1296"></a></p><p>When you are reading and writing files, you might run into problems
with whitespace. These errors can be hard to debug because spaces,
tabs and newlines are normally invisible:</p><pre class="verbatim">&gt;&gt;&gt; s = '1 2\t 3\n 4'
&gt;&gt;&gt; print(s)
1 2  3
 4
</pre><p>
<a id="hevea_default1297"></a>
<a id="hevea_default1298"></a>
<a id="hevea_default1299"></a></p><p>The built-in function <span class="c004">repr</span> can help. It takes any object as an
argument and returns a string representation of the object. For
strings, it represents whitespace
characters with backslash sequences:</p><pre class="verbatim">&gt;&gt;&gt; print(repr(s))
'1 2\t 3\n 4'
</pre><p>This can be helpful for debugging.</p><p>One other problem you might run into is that different systems
use different characters to indicate the end of a line. Some
systems use a newline, represented <code>\n</code>. Others use
a return character, represented <code>\r</code>. Some use both.
If you move files between different systems, these inconsistencies
can cause problems.
<a id="hevea_default1300"></a></p><p>For most systems, there are applications to convert from one
format to another. You can find them (and read more about this
issue) at <a href="http://en.wikipedia.org/wiki/Newline"><span class="c004">http://en.wikipedia.org/wiki/Newline</span></a>. Or, of course, you
could write one yourself.</p>
<h2 class="section" id="sec175">14.11&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">persistent:</span></dt><dd class="dd-description"> Pertaining to a program that runs indefinitely
and keeps at least some of its data in permanent storage.
<a id="hevea_default1301"></a></dd><dt class="dt-description"><span class="c010">format operator:</span></dt><dd class="dd-description"> An operator, <span class="c004">%</span>, that takes a format
string and a tuple and generates a string that includes
the elements of the tuple formatted as specified by the format string.
<a id="hevea_default1302"></a>
<a id="hevea_default1303"></a></dd><dt class="dt-description"><span class="c010">format string:</span></dt><dd class="dd-description"> A string, used with the format operator, that
contains format sequences. 
<a id="hevea_default1304"></a></dd><dt class="dt-description"><span class="c010">format sequence:</span></dt><dd class="dd-description"> A sequence of characters in a format string,
like <span class="c004">%d</span>, that specifies how a value should be formatted.
<a id="hevea_default1305"></a></dd><dt class="dt-description"><span class="c010">text file:</span></dt><dd class="dd-description"> A sequence of characters stored in permanent
storage like a hard drive.
<a id="hevea_default1306"></a></dd><dt class="dt-description"><span class="c010">directory:</span></dt><dd class="dd-description"> A named collection of files, also called a folder.
<a id="hevea_default1307"></a></dd><dt class="dt-description"><span class="c010">path:</span></dt><dd class="dd-description"> A string that identifies a file.
<a id="hevea_default1308"></a></dd><dt class="dt-description"><span class="c010">relative path:</span></dt><dd class="dd-description"> A path that starts from the current directory.
<a id="hevea_default1309"></a></dd><dt class="dt-description"><span class="c010">absolute path:</span></dt><dd class="dd-description"> A path that starts from the topmost directory
in the file system.
<a id="hevea_default1310"></a></dd><dt class="dt-description"><span class="c010">catch:</span></dt><dd class="dd-description"> To prevent an exception from terminating
a program using the <span class="c004">try</span>
and <span class="c004">except</span> statements.
<a id="hevea_default1311"></a></dd><dt class="dt-description"><span class="c010">database:</span></dt><dd class="dd-description"> A file whose contents are organized like a dictionary
with keys that correspond to values.
<a id="hevea_default1312"></a></dd><dt class="dt-description"><span class="c010">bytes object:</span></dt><dd class="dd-description"> An object similar to a string.
<a id="hevea_default1313"></a>
<a id="hevea_default1314"></a></dd><dt class="dt-description"><span class="c010">shell:</span></dt><dd class="dd-description"> A program that allows users to type commands and then
executes them by starting other programs.
<a id="hevea_default1315"></a></dd><dt class="dt-description"><span class="c010">pipe object:</span></dt><dd class="dd-description"> An object that represents a running program, allowing
a Python program to run commands and read the results.
<a id="hevea_default1316"></a>
<a id="hevea_default1317"></a></dd></dl>
<h2 class="section" id="sec176">14.12&#XA0;&#XA0;Exercises</h2>
<div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Write a function called <span class="c004">sed</span> that takes as arguments a pattern string,
a replacement string, and two filenames; it should read the first file
and write the contents into the second file (creating it if
necessary). If the pattern string appears anywhere in the file, it
should be replaced with the replacement string.</em></p><p><em>If an error occurs while opening, reading, writing or closing files,
your program should catch the exception, print an error message, and
exit. Solution: </em><a href="https://thinkpython.com/code/sed.py"><em><span class="c004">https://thinkpython.com/code/sed.py</span></em></a><em>.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;
<a id="hevea_default1318"></a>
<a id="hevea_default1319"></a><p><em>If you download my solution to Exercise&#XA0;</em><a href="thinkpython2013.html#anagrams"><em>2</em></a><em> from
</em><a href="https://thinkpython.com/code/anagram_sets.py"><span class="c004"><em>https://thinkpython.com/code/anagram_sets.py</em></span></a><em>, you&#X2019;ll see that it creates
a dictionary that maps from a sorted string of letters to the list of
words that can be spelled with those letters. For example,
<code>'opst'</code> maps to the list
<code>['opts', 'post', 'pots', 'spot', 'stop', 'tops']</code>.</em></p><p><em>Write a module that imports <code>anagram_sets</code> and provides
two new functions: <code>store_anagrams</code> should store the
anagram dictionary in a &#X201C;shelf&#X201D;; <code>read_anagrams</code> should
look up a word and return a list of its anagrams.
Solution: </em><a href="https://thinkpython.com/code/anagram_db.py"><span class="c004"><em>https://thinkpython.com/code/anagram_db.py</em></span></a><em>.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;3</span>&#XA0;&#XA0;
<a id="checksum"></a>
<a id="hevea_default1320"></a><p><em>In a large collection of MP3 files, there may be more than one
copy of the same song, stored in different directories or with
different file names. The goal of this exercise is to search for
duplicates.</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>Write a program that searches a directory and all of its
subdirectories, recursively, and returns a list of complete paths
for all files with a given suffix (like <span class="c004">.mp3</span>).
Hint: <span class="c004">os.path</span> provides several useful functions for
manipulating file and path names.
</em><a id="hevea_default1321"></a>
<a id="hevea_default1322"></a>
<a id="hevea_default1323"></a>
<a id="hevea_default1324"></a></li><li class="li-enumerate"><em>To recognize duplicates, you can use <span class="c004">md5sum</span>
to compute a &#X201C;checksum&#X201D; for each files. If two files have
the same checksum, they probably have the same contents.
</em><a id="hevea_default1325"></a></li><li class="li-enumerate"><em>To double-check, you can use the Unix command <span class="c004">diff</span>.
</em><a id="hevea_default1326"></a></li></ol><p><em>Solution: </em><a href="https://thinkpython.com/code/find_duplicates.py"><em><span class="c004">https://thinkpython.com/code/find_duplicates.py</span></em></a><em>.</em></p></div>
<hr class="footnoterule"><dl class="thefootnotes"><dt class="dt-thefootnotes">
<a id="note1" href="#text1">1</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><span class="c004">popen</span> is deprecated
now, which means we are supposed to stop using it and start using
the <span class="c004">subprocess</span> module. But for simple cases, I find
<span class="c004">subprocess</span> more complicated than necessary. So I am going
to keep using <span class="c004">popen</span> until they take it away.</div></dd></dl>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2014.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2016.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Classes and objects</title>
</head>
<body>
<a href="thinkpython2015.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2017.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec177">Chapter&#XA0;15&#XA0;&#XA0;Classes and objects</h1>
<p>
<a id="clobjects"></a></p><p>At this point you know how to use
functions to organize code and 
built-in types to organize data. The next step is to learn
&#X201C;object-oriented programming&#X201D;, which uses programmer-defined types
to organize both code and data. Object-oriented programming is
a big topic; it will take a few chapters to get there.
<a id="hevea_default1327"></a></p><p>Code examples from this chapter are available from
<a href="https://thinkpython.com/code/Point1.py"><span class="c004">https://thinkpython.com/code/Point1.py</span></a>; solutions
to the exercises are available from
<a href="https://thinkpython.com/code/Point1_soln.py"><span class="c004">https://thinkpython.com/code/Point1_soln.py</span></a>.</p>
<h2 class="section" id="sec178">15.1&#XA0;&#XA0;Programmer-defined types</h2>
<p>
<a id="point"></a>
<a id="hevea_default1328"></a>
<a id="hevea_default1329"></a></p><p>We have used many of Python&#X2019;s built-in types; now we are going
to define a new type. As an example, we will create a type
called <span class="c004">Point</span> that represents a point in two-dimensional
space.
<a id="hevea_default1330"></a></p><p>In mathematical notation, points are often written in
parentheses with a comma separating the coordinates. For example,
(0,0) represents the origin, and (<span class="c009">x</span>,<span class="c009">y</span>) represents the
point <span class="c009">x</span> units to the right and <span class="c009">y</span> units up from the origin.</p><p>There are several ways we might represent points in Python:</p><ul class="itemize"><li class="li-itemize">We could store the coordinates separately in two
variables, <span class="c004">x</span> and <span class="c004">y</span>.</li><li class="li-itemize">We could store the coordinates as elements in a list
or tuple.</li><li class="li-itemize">We could create a new type to represent points as
objects.</li></ul><p>
<a id="hevea_default1331"></a></p><p>Creating a new type
is more complicated than the other options, but
it has advantages that will be apparent soon.</p><p>A programmer-defined type is also 