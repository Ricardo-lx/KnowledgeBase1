<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ThinkPython7</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../Scrapy/Scrapy.html"><strong aria-hidden="true">1.</strong> Scrapy(-v master)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../Scrapy/Scrapy1.html"><strong aria-hidden="true">1.1.</strong> Scrapy1</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy2.html"><strong aria-hidden="true">1.2.</strong> Scrapy2</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy3.html"><strong aria-hidden="true">1.3.</strong> Scrapy3</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy4.html"><strong aria-hidden="true">1.4.</strong> Scrapy4</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy5.html"><strong aria-hidden="true">1.5.</strong> Scrapy5</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy6.html"><strong aria-hidden="true">1.6.</strong> Scrapy6</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy7.html"><strong aria-hidden="true">1.7.</strong> Scrapy7</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy8.html"><strong aria-hidden="true">1.8.</strong> Scrapy8</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy9.html"><strong aria-hidden="true">1.9.</strong> Scrapy9</a></li><li class="chapter-item expanded "><a href="../Scrapy/Scrapy10.html"><strong aria-hidden="true">1.10.</strong> Scrapy10</a></li></ol></li><li class="chapter-item expanded "><a href="../ThinkPython/merged_file.html"><strong aria-hidden="true">2.</strong> ThinkPython</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ThinkPython/part_1.html"><strong aria-hidden="true">2.1.</strong> ThinkPython1</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_2.html"><strong aria-hidden="true">2.2.</strong> ThinkPython2</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_3.html"><strong aria-hidden="true">2.3.</strong> ThinkPython3</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_4.html"><strong aria-hidden="true">2.4.</strong> ThinkPython4</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_5.html"><strong aria-hidden="true">2.5.</strong> ThinkPython5</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_6.html"><strong aria-hidden="true">2.6.</strong> ThinkPython6</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_7.html" class="active"><strong aria-hidden="true">2.7.</strong> ThinkPython7</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_8.html"><strong aria-hidden="true">2.8.</strong> ThinkPython8</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_9.html"><strong aria-hidden="true">2.9.</strong> ThinkPython9</a></li><li class="chapter-item expanded "><a href="../ThinkPython/part_10.html"><strong aria-hidden="true">2.10.</strong> ThinkPython10</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <pre><code>            | [increment]{.c004}:   |                       |
</code></pre>
<p>|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;                     |                       | |                       | &gt;&gt; start.print_time() |                       | |                       | 09:45:00              |                       | |                       | &gt;&gt;&gt; end =             |                       | |                       | start.increment(1337) |                       | |                       | &gt;&gt;&gt; end.print_time()  |                       | |                       | 10:07:17              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The subject,          |                       |
|                       | [start]{.c004}, gets  |                       |
|                       | assigned to the first |                       |
|                       | parameter,            |                       |
|                       | [self]{.c004}. The    |                       |
|                       | argument,             |                       |
|                       | [1337]{.c004}, gets   |                       |
|                       | assigned to the       |                       |
|                       | second parameter,     |                       |
|                       | [seconds]{.c004}.     |                       |
|                       |                       |                       |
|                       | This mechanism can be |                       |
|                       | confusing, especially |                       |
|                       | if you make an error. |                       |
|                       | For example, if you   |                       |
|                       | invoke                |                       |
|                       | [increment]{.c004}    |                       |
|                       | with two arguments,   |                       |
|                       | you get:              |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1479} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1480} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; end = start       |                       | |                       | .increment(1337, 460) |                       | |                       | TypeE                 |                       | |                       | rror: increment() tak |                       | |                       | es 2 positional argum |                       | |                       | ents but 3 were given |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The error message is  |                       |
|                       | initially confusing,  |                       |
|                       | because there are     |                       |
|                       | only two arguments in |                       |
|                       | parentheses. But the  |                       |
|                       | subject is also       |                       |
|                       | considered an         |                       |
|                       | argument, so all      |                       |
|                       | together that's       |                       |
|                       | three.                |                       |
|                       |                       |                       |
|                       | By the way, a         |                       |
|                       | [positional           |                       |
|                       | argument]{.c010} is   |                       |
|                       | an argument that      |                       |
|                       | doesn't have a        |                       |
|                       | parameter name; that  |                       |
|                       | is, it is not a       |                       |
|                       | keyword argument. In  |                       |
|                       | this function call:   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1481} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1482} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | sketch(par            |                       | |                       | rot, cage, dead=True) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | [parrot]{.c004} and   |                       |
|                       | [cage]{.c004} are     |                       |
|                       | positional, and       |                       |
|                       | [dead]{.c004} is a    |                       |
|                       | keyword argument.     |                       |
|                       |                       |                       |
|                       | ## 17.4  A m          |                       |
|                       | ore complicated examp |                       |
|                       | le {#sec199 .section} |                       |
|                       |                       |                       |
|                       | Rewriting <code>is_after</code>  |                       |
|                       | (from                 |                       |
|                       | Sec                   |                       |
|                       | tion [16.1](thinkpyth |                       |
|                       | on2017.html#isafter)) |                       |
|                       | is slightly more      |                       |
|                       | complicated because   |                       |
|                       | it takes two Time     |                       |
|                       | objects as            |                       |
|                       | parameters. In this   |                       |
|                       | case it is            |                       |
|                       | conventional to name  |                       |
|                       | the first parameter   |                       |
|                       | [self]{.c004} and the |                       |
|                       | second parameter      |                       |
|                       | [other]{.c004}:       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1483} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1484} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |     def i             |                       | |                       | s_after(self, other): |                       | |                       |         retur         |                       | |                       | n self.time_to_int()  |                       | |                       | &gt; other.time_to_int() |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | To use this method,   |                       |
|                       | you have to invoke it |                       |
|                       | on one object and     |                       |
|                       | pass the other as an  |                       |
|                       | argument:             |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; end.is_after(start) |                       | |                       | True                  |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | One nice thing about  |                       |
|                       | this syntax is that   |                       |
|                       | it almost reads like  |                       |
|                       | English: &quot;end is      |                       |
|                       | after start?&quot;         |                       |
|                       |                       |                       |
|                       | #                     |                       |
|                       | # 17.5  The init meth |                       |
|                       | od {#sec200 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1485} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1486} |                       |
|                       |                       |                       |
|                       | The init method       |                       |
|                       | (short for            |                       |
|                       | &quot;initialization&quot;) is  |                       |
|                       | a special method that |                       |
|                       | gets invoked when an  |                       |
|                       | object is             |                       |
|                       | instantiated. Its     |                       |
|                       | full name is          |                       |
|                       | <code>__init__</code> (two       |                       |
|                       | underscore            |                       |
|                       | characters, followed  |                       |
|                       | by [init]{.c004}, and |                       |
|                       | then two more         |                       |
|                       | underscores). An init |                       |
|                       | method for the        |                       |
|                       | [Time]{.c004} class   |                       |
|                       | might look like this: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |     def _             |                       | |                       | _init__(self, hour=0, |                       | |                       |  minute=0, second=0): |                       | |                       |                       |                       | |                       |      self.hour = hour |                       | |                       |                       |                       | |                       |  self.minute = minute |                       | |                       |                       |                       | |                       |  self.second = second |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | It is common for the  |                       |
|                       | parameters of         |                       |
|                       | <code>__init__</code> to have    |                       |
|                       | the same names as the |                       |
|                       | attributes. The       |                       |
|                       | statement             |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       |                       |                       | |                       |      self.hour = hour |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | stores the value of   |                       |
|                       | the parameter         |                       |
|                       | [hour]{.c004} as an   |                       |
|                       | attribute of          |                       |
|                       | [self]{.c004}.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1487} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1488} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1489} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1490} |                       |
|                       |                       |                       |
|                       | The parameters are    |                       |
|                       | optional, so if you   |                       |
|                       | call [Time]{.c004}    |                       |
|                       | with no arguments,    |                       |
|                       | you get the default   |                       |
|                       | values.               |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; time = Time()     |                       | |                       | &gt;&gt;&gt; time.print_time() |                       | |                       | 00:00:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | If you provide one    |                       |
|                       | argument, it          |                       |
|                       | overrides             |                       |
|                       | [hour]{.c004}:        |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; time = Time (9)   |                       | |                       | &gt;&gt;&gt; time.print_time() |                       | |                       | 09:00:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | If you provide two    |                       |
|                       | arguments, they       |                       |
|                       | override              |                       |
|                       | [hour]{.c004} and     |                       |
|                       | [minute]{.c004}.      |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;                     |                       | |                       | &gt;&gt; time = Time(9, 45) |                       | |                       | &gt;&gt;&gt; time.print_time() |                       | |                       | 09:45:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | And if you provide    |                       |
|                       | three arguments, they |                       |
|                       | override all three    |                       |
|                       | default values.       |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | an init method for    |                       |
|                       | the [Point]{.c004}    |                       |
|                       | class that takes      |                       |
|                       | [x]{.c004} and        |                       |
|                       | [y]{.c004} as         |                       |
|                       | optional parameters   |                       |
|                       | and assigns them to   |                       |
|                       | the corresponding     |                       |
|                       | attributes.           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1491} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1492} |                       |
|                       |                       |                       |
|                       | ## 17.6  The [_\     |                       |
|                       | _str__]{.c004} meth |                       |
|                       | od {#sec201 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1493} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1494} |                       |
|                       |                       |                       |
|                       | <code>__str__</code> is a        |                       |
|                       | special method, like  |                       |
|                       | <code>__init__</code>, that is   |                       |
|                       | supposed to return a  |                       |
|                       | string representation |                       |
|                       | of an object.         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1495} |                       |
|                       |                       |                       |
|                       | For example, here is  |                       |
|                       | a [str]{.c004} method |                       |
|                       | for Time objects:     |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |                       |                       | |                       |    def __str__(self): |                       | |                       |                       |                       | |                       | return '%.2d:%.2d:%.2 |                       | |                       | d' % (self.hour, self |                       | |                       | .minute, self.second) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When you              |                       |
|                       | [print]{.c004} an     |                       |
|                       | object, Python        |                       |
|                       | invokes the           |                       |
|                       | [str]{.c004} method:  |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1496} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1497} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;                     |                       | |                       | &gt;&gt; time = Time(9, 45) |                       | |                       | &gt;&gt;&gt; print(time)       |                       | |                       | 09:45:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When I write a new    |                       |
|                       | class, I almost       |                       |
|                       | always start by       |                       |
|                       | writing <code>__init__</code>,   |                       |
|                       | which makes it easier |                       |
|                       | to instantiate        |                       |
|                       | objects, and          |                       |
|                       | <code>__str__</code>, which is   |                       |
|                       | useful for debugging. |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | a [str]{.c004} method |                       |
|                       | for the               |                       |
|                       | [Point]{.c004} class. |                       |
|                       | Create a Point object |                       |
|                       | and print it.         |                       |
|                       |                       |                       |
|                       | ## 17.                |                       |
|                       | 7  Operator overloadi |                       |
|                       | ng {#sec202 .section} |                       |
|                       |                       |                       |
|                       | []{#                  |                       |
|                       | operator.overloading} |                       |
|                       |                       |                       |
|                       | By defining other     |                       |
|                       | special methods, you  |                       |
|                       | can specify the       |                       |
|                       | behavior of operators |                       |
|                       | on programmer-defined |                       |
|                       | types. For example,   |                       |
|                       | if you define a       |                       |
|                       | method named          |                       |
|                       | <code>__add__</code> for the     |                       |
|                       | [Time]{.c004} class,  |                       |
|                       | you can use the       |                       |
|                       | [+]{.c004} operator   |                       |
|                       | on Time objects.      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1498} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1499} |                       |
|                       |                       |                       |
|                       | Here is what the      |                       |
|                       | definition might look |                       |
|                       | like:                 |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1500} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1501} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |     def               |                       | |                       | __add__(self, other): |                       | |                       |         seconds       |                       | |                       | = self.time_to_int()  |                       | |                       | + other.time_to_int() |                       | |                       |         return        |                       | |                       |  int_to_time(seconds) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | And here is how you   |                       |
|                       | could use it:         |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; start = Time(9, 45) |                       | |                       | &gt;&gt;&gt; d                 |                       | |                       | uration = Time(1, 35) |                       | |                       | &gt;&gt;&gt; pr                |                       | |                       | int(start + duration) |                       | |                       | 11:20:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When you apply the    |                       |
|                       | [+]{.c004} operator   |                       |
|                       | to Time objects,      |                       |
|                       | Python invokes        |                       |
|                       | <code>__add__</code>. When you   |                       |
|                       | print the result,     |                       |
|                       | Python invokes        |                       |
|                       | <code>__str__</code>. So there   |                       |
|                       | is a lot happening    |                       |
|                       | behind the scenes!    |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1502} |                       |
|                       |                       |                       |
|                       | Changing the behavior |                       |
|                       | of an operator so     |                       |
|                       | that it works with    |                       |
|                       | programmer-defined    |                       |
|                       | types is called       |                       |
|                       | [operator             |                       |
|                       | overloading]{.c010}.  |                       |
|                       | For every operator in |                       |
|                       | Python there is a     |                       |
|                       | corresponding special |                       |
|                       | method, like          |                       |
|                       | <code>__add__</code>. For more   |                       |
|                       | details, see          |                       |
|                       | [[http://doc          |                       |
|                       | s.python.org/3/refere |                       |
|                       | nce/datamodel.html#sp |                       |
|                       | ecialnames]{.c004}](h |                       |
|                       | ttp://docs.python.org |                       |
|                       | /3/reference/datamode |                       |
|                       | l.html#specialnames). |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | an [add]{.c004}       |                       |
|                       | method for the Point  |                       |
|                       | class.                |                       |
|                       |                       |                       |
|                       | ## 17                 |                       |
|                       | .8  Type-based dispat |                       |
|                       | ch {#sec203 .section} |                       |
|                       |                       |                       |
|                       | In the previous       |                       |
|                       | section we added two  |                       |
|                       | Time objects, but you |                       |
|                       | also might want to    |                       |
|                       | add an integer to a   |                       |
|                       | Time object. The      |                       |
|                       | following is a        |                       |
|                       | version of <code>__add__</code>  |                       |
|                       | that checks the type  |                       |
|                       | of [other]{.c004} and |                       |
|                       | invokes either        |                       |
|                       | <code>add_time</code> or         |                       |
|                       | [increment]{.c004}:   |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |     def               |                       | |                       | __add__(self, other): |                       | |                       |         if isi        |                       | |                       | nstance(other, Time): |                       | |                       |             return    |                       | |                       |  self.add_time(other) |                       | |                       |         else:         |                       | |                       |             return    |                       | |                       | self.increment(other) |                       | |                       |                       |                       | |                       |     def a             |                       | |                       | dd_time(self, other): |                       | |                       |         seconds       |                       | |                       | = self.time_to_int()  |                       | |                       | + other.time_to_int() |                       | |                       |         return        |                       | |                       |  int_to_time(seconds) |                       | |                       |                       |                       | |                       |     def incr          |                       | |                       | ement(self, seconds): |                       | |                       |         seconds       |                       | |                       | += self.time_to_int() |                       | |                       |         return        |                       | |                       |  int_to_time(seconds) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The built-in function |                       |
|                       | [isinstance]{.c004}   |                       |
|                       | takes a value and a   |                       |
|                       | class object, and     |                       |
|                       | returns [True]{.c004} |                       |
|                       | if the value is an    |                       |
|                       | instance of the       |                       |
|                       | class.                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1503} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1504} |                       |
|                       |                       |                       |
|                       | If [other]{.c004} is  |                       |
|                       | a Time object,        |                       |
|                       | <code>__add__</code> invokes     |                       |
|                       | <code>add_time</code>. Otherwise |                       |
|                       | it assumes that the   |                       |
|                       | parameter is a number |                       |
|                       | and invokes           |                       |
|                       | [increment]{.c004}.   |                       |
|                       | This operation is     |                       |
|                       | called a [type-based  |                       |
|                       | dispatch]{.c010}      |                       |
|                       | because it dispatches |                       |
|                       | the computation to    |                       |
|                       | different methods     |                       |
|                       | based on the type of  |                       |
|                       | the arguments.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1505} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1506} |                       |
|                       |                       |                       |
|                       | Here are examples     |                       |
|                       | that use the          |                       |
|                       | [+]{.c004} operator   |                       |
|                       | with different types: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; start = Time(9, 45) |                       | |                       | &gt;&gt;&gt; d                 |                       | |                       | uration = Time(1, 35) |                       | |                       | &gt;&gt;&gt; pr                |                       | |                       | int(start + duration) |                       | |                       | 11:20:00              |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; print(start + 1337) |                       | |                       | 10:07:17              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Unfortunately, this   |                       |
|                       | implementation of     |                       |
|                       | addition is not       |                       |
|                       | commutative. If the   |                       |
|                       | integer is the first  |                       |
|                       | operand, you get      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1507} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; print(1337 + start) |                       | |                       | Typ                   |                       | |                       | eError: unsupported o |                       | |                       | perand type(s) for +: |                       | |                       |  'int' and 'instance' |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The problem is,       |                       |
|                       | instead of asking the |                       |
|                       | Time object to add an |                       |
|                       | integer, Python is    |                       |
|                       | asking an integer to  |                       |
|                       | add a Time object,    |                       |
|                       | and it doesn't know   |                       |
|                       | how. But there is a   |                       |
|                       | clever solution for   |                       |
|                       | this problem: the     |                       |
|                       | special method        |                       |
|                       | <code>__radd__</code>, which     |                       |
|                       | stands for            |                       |
|                       | &quot;right-side add&quot;.     |                       |
|                       | This method is        |                       |
|                       | invoked when a Time   |                       |
|                       | object appears on the |                       |
|                       | right side of the     |                       |
|                       | [+]{.c004} operator.  |                       |
|                       | Here's the            |                       |
|                       | definition:           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1508} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1509} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Time:  |                       | |                       |                       |                       | |                       |     def _             |                       | |                       | _radd__(self, other): |                       | |                       |         retur         |                       | |                       | n self.__add__(other) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | And here's how it's   |                       |
|                       | used:                 |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; print(1337 + start) |                       | |                       | 10:07:17              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | an [add]{.c004}       |                       |
|                       | method for Points     |                       |
|                       | that works with       |                       |
|                       | either a Point object |                       |
|                       | or a tuple:           |                       |
|                       |                       |                       |
|                       | -   If the second     |                       |
|                       |     operand is a      |                       |
|                       |     Point, the method |                       |
|                       |     should return a   |                       |
|                       |     new Point whose   |                       |
|                       |     [x]{.c009}        |                       |
|                       |     coordinate is the |                       |
|                       |     sum of the        |                       |
|                       |     [x]{.c009}        |                       |
|                       |     coordinates of    |                       |
|                       |     the operands, and |                       |
|                       |     likewise for the  |                       |
|                       |     [y]{.c009}        |                       |
|                       |     coordinates.      |                       |
|                       | -   If the second     |                       |
|                       |     operand is a      |                       |
|                       |     tuple, the method |                       |
|                       |     should add the    |                       |
|                       |     first element of  |                       |
|                       |     the tuple to the  |                       |
|                       |     [x]{.c009}        |                       |
|                       |     coordinate and    |                       |
|                       |     the second        |                       |
|                       |     element to the    |                       |
|                       |     [y]{.c009}        |                       |
|                       |     coordinate, and   |                       |
|                       |     return a new      |                       |
|                       |     Point with the    |                       |
|                       |     result.           |                       |
|                       |                       |                       |
|                       | ## 17.9  Polymorphi   |                       |
|                       | sm {#sec204 .section} |                       |
|                       |                       |                       |
|                       | []{#polymorphism}     |                       |
|                       |                       |                       |
|                       | Type-based dispatch   |                       |
|                       | is useful when it is  |                       |
|                       | necessary, but        |                       |
|                       | (fortunately) it is   |                       |
|                       | not always necessary. |                       |
|                       | Often you can avoid   |                       |
|                       | it by writing         |                       |
|                       | functions that work   |                       |
|                       | correctly for         |                       |
|                       | arguments with        |                       |
|                       | different types.      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1510} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1511} |                       |
|                       |                       |                       |
|                       | Many of the functions |                       |
|                       | we wrote for strings  |                       |
|                       | also work for other   |                       |
|                       | sequence types. For   |                       |
|                       | example, in           |                       |
|                       | Sect                  |                       |
|                       | ion [11.2](thinkpytho |                       |
|                       | n2012.html#histogram) |                       |
|                       | we used               |                       |
|                       | [histogram]{.c004} to |                       |
|                       | count the number of   |                       |
|                       | times each letter     |                       |
|                       | appears in a word.    |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def histogram(s):     |                       | |                       |     d = dict()        |                       | |                       |     for c in s:       |                       | |                       |                       |                       | |                       |        if c not in d: |                       | |                       |             d[c] = 1  |                       | |                       |         else:         |                       | |                       |                       |                       | |                       |         d[c] = d[c]+1 |                       | |                       |     return d          |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This function also    |                       |
|                       | works for lists,      |                       |
|                       | tuples, and even      |                       |
|                       | dictionaries, as long |                       |
|                       | as the elements of    |                       |
|                       | [s]{.c004} are        |                       |
|                       | hashable, so they can |                       |
|                       | be used as keys in    |                       |
|                       | [d]{.c004}.           |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; t = ['spam        |                       | |                       | ', 'egg', 'spam', 'sp |                       | |                       | am', 'bacon', 'spam'] |                       | |                       | &gt;&gt;&gt; histogram(t)      |                       | |                       | {'bacon': 1,          |                       | |                       |  'egg': 1, 'spam': 4} |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Functions that work   |                       |
|                       | with several types    |                       |
|                       | are called            |                       |
|                       | [polymorphic]{.c010}. |                       |
|                       | Polymorphism can      |                       |
|                       | facilitate code       |                       |
|                       | reuse. For example,   |                       |
|                       | the built-in function |                       |
|                       | [sum]{.c004}, which   |                       |
|                       | adds the elements of  |                       |
|                       | a sequence, works as  |                       |
|                       | long as the elements  |                       |
|                       | of the sequence       |                       |
|                       | support addition.     |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1512} |                       |
|                       |                       |                       |
|                       | Since Time objects    |                       |
|                       | provide an            |                       |
|                       | [add]{.c004} method,  |                       |
|                       | they work with        |                       |
|                       | [sum]{.c004}:         |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; t1 = Time(7, 43)  |                       | |                       | &gt;&gt;&gt; t2 = Time(7, 41)  |                       | |                       | &gt;&gt;&gt; t3 = Time(7, 37)  |                       | |                       | &gt;&gt;&gt; tota              |                       | |                       | l = sum([t1, t2, t3]) |                       | |                       | &gt;&gt;&gt; print(total)      |                       | |                       | 23:01:00              |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | In general, if all of |                       |
|                       | the operations inside |                       |
|                       | a function work with  |                       |
|                       | a given type, the     |                       |
|                       | function works with   |                       |
|                       | that type.            |                       |
|                       |                       |                       |
|                       | The best kind of      |                       |
|                       | polymorphism is the   |                       |
|                       | unintentional kind,   |                       |
|                       | where you discover    |                       |
|                       | that a function you   |                       |
|                       | already wrote can be  |                       |
|                       | applied to a type you |                       |
|                       | never planned for.    |                       |
|                       |                       |                       |
|                       | ## 17.10  Debuggi     |                       |
|                       | ng {#sec205 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1513} |                       |
|                       |                       |                       |
|                       | It is legal to add    |                       |
|                       | attributes to objects |                       |
|                       | at any point in the   |                       |
|                       | execution of a        |                       |
|                       | program, but if you   |                       |
|                       | have objects with the |                       |
|                       | same type that don't  |                       |
|                       | have the same         |                       |
|                       | attributes, it is     |                       |
|                       | easy to make          |                       |
|                       | mistakes. It is       |                       |
|                       | considered a good     |                       |
|                       | idea to initialize    |                       |
|                       | all of an object's    |                       |
|                       | attributes in the     |                       |
|                       | init method.          |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1514} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1515} |                       |
|                       |                       |                       |
|                       | If you are not sure   |                       |
|                       | whether an object has |                       |
|                       | a particular          |                       |
|                       | attribute, you can    |                       |
|                       | use the built-in      |                       |
|                       | function              |                       |
|                       | [hasattr]{.c004} (see |                       |
|                       | Sect                  |                       |
|                       | ion [15.7](thinkpytho |                       |
|                       | n2016.html#hasattr)). |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1516} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1517} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1518} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1519} |                       |
|                       |                       |                       |
|                       | Another way to access |                       |
|                       | attributes is the     |                       |
|                       | built-in function     |                       |
|                       | [vars]{.c004}, which  |                       |
|                       | takes an object and   |                       |
|                       | returns a dictionary  |                       |
|                       | that maps from        |                       |
|                       | attribute names (as   |                       |
|                       | strings) to their     |                       |
|                       | values:               |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; p = Point(3, 4)   |                       | |                       | &gt;&gt;&gt; vars(p)           |                       | |                       | {'y': 4, 'x': 3}      |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | For purposes of       |                       |
|                       | debugging, you might  |                       |
|                       | find it useful to     |                       |
|                       | keep this function    |                       |
|                       | handy:                |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def p                 |                       | |                       | rint_attributes(obj): |                       | |                       |     f                 |                       | |                       | or attr in vars(obj): |                       | |                       |         print(attr    |                       | |                       | , getattr(obj, attr)) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | <code>print_attributes</code>    |                       |
|                       | traverses the         |                       |
|                       | dictionary and prints |                       |
|                       | each attribute name   |                       |
|                       | and its corresponding |                       |
|                       | value.                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1520} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1521} |                       |
|                       |                       |                       |
|                       | The built-in function |                       |
|                       | [getattr]{.c004}      |                       |
|                       | takes an object and   |                       |
|                       | an attribute name (as |                       |
|                       | a string) and returns |                       |
|                       | the attribute's       |                       |
|                       | value.                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1522} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1523} |                       |
|                       |                       |                       |
|                       | ## 17.11  Inter       |                       |
|                       | face and implementati |                       |
|                       | on {#sec206 .section} |                       |
|                       |                       |                       |
|                       | One of the goals of   |                       |
|                       | object-oriented       |                       |
|                       | design is to make     |                       |
|                       | software more         |                       |
|                       | maintainable, which   |                       |
|                       | means that you can    |                       |
|                       | keep the program      |                       |
|                       | working when other    |                       |
|                       | parts of the system   |                       |
|                       | change, and modify    |                       |
|                       | the program to meet   |                       |
|                       | new requirements.     |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1524} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1525} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1526} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1527} |                       |
|                       |                       |                       |
|                       | A design principle    |                       |
|                       | that helps achieve    |                       |
|                       | that goal is to keep  |                       |
|                       | interfaces separate   |                       |
|                       | from implementations. |                       |
|                       | For objects, that     |                       |
|                       | means that the        |                       |
|                       | methods a class       |                       |
|                       | provides should not   |                       |
|                       | depend on how the     |                       |
|                       | attributes are        |                       |
|                       | represented.          |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1528} |                       |
|                       |                       |                       |
|                       | For example, in this  |                       |
|                       | chapter we developed  |                       |
|                       | a class that          |                       |
|                       | represents a time of  |                       |
|                       | day. Methods provided |                       |
|                       | by this class include |                       |
|                       | <code>time_to_int</code>,        |                       |
|                       | <code>is_after</code>, and       |                       |
|                       | <code>add_time</code>.           |                       |
|                       |                       |                       |
|                       | We could implement    |                       |
|                       | those methods in      |                       |
|                       | several ways. The     |                       |
|                       | details of the        |                       |
|                       | implementation depend |                       |
|                       | on how we represent   |                       |
|                       | time. In this         |                       |
|                       | chapter, the          |                       |
|                       | attributes of a       |                       |
|                       | [Time]{.c004} object  |                       |
|                       | are [hour]{.c004},    |                       |
|                       | [minute]{.c004}, and  |                       |
|                       | [second]{.c004}.      |                       |
|                       |                       |                       |
|                       | As an alternative, we |                       |
|                       | could replace these   |                       |
|                       | attributes with a     |                       |
|                       | single integer        |                       |
|                       | representing the      |                       |
|                       | number of seconds     |                       |
|                       | since midnight. This  |                       |
|                       | implementation would  |                       |
|                       | make some methods,    |                       |
|                       | like <code>is_after</code>,      |                       |
|                       | easier to write, but  |                       |
|                       | it makes other        |                       |
|                       | methods harder.       |                       |
|                       |                       |                       |
|                       | After you deploy a    |                       |
|                       | new class, you might  |                       |
|                       | discover a better     |                       |
|                       | implementation. If    |                       |
|                       | other parts of the    |                       |
|                       | program are using     |                       |
|                       | your class, it might  |                       |
|                       | be time-consuming and |                       |
|                       | error-prone to change |                       |
|                       | the interface.        |                       |
|                       |                       |                       |
|                       | But if you designed   |                       |
|                       | the interface         |                       |
|                       | carefully, you can    |                       |
|                       | change the            |                       |
|                       | implementation        |                       |
|                       | without changing the  |                       |
|                       | interface, which      |                       |
|                       | means that other      |                       |
|                       | parts of the program  |                       |
|                       | don't have to change. |                       |
|                       |                       |                       |
|                       | ## 17.12  Glossa      |                       |
|                       | ry {#sec207 .section} |                       |
|                       |                       |                       |
|                       | [object-orien         |                       |
|                       | ted language:]{.c010} |                       |
|                       | :   A language that   |                       |
|                       |     provides          |                       |
|                       |     features, such as |                       |
|                       |                       |                       |
|                       |    programmer-defined |                       |
|                       |     types and         |                       |
|                       |     methods, that     |                       |
|                       |     facilitate        |                       |
|                       |     object-oriented   |                       |
|                       |     programming.      |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1529} |                       |
|                       |                       |                       |
|                       | [object-oriented      |                       |
|                       |  programming:]{.c010} |                       |
|                       | :   A style of        |                       |
|                       |     programming in    |                       |
|                       |     which data and    |                       |
|                       |     the operations    |                       |
|                       |     that manipulate   |                       |
|                       |     it are organized  |                       |
|                       |     into classes and  |                       |
|                       |     methods.          |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1530} |                       |
|                       |                       |                       |
|                       | [method:]{.c010}      |                       |
|                       | :   A function that   |                       |
|                       |     is defined inside |                       |
|                       |     a class           |                       |
|                       |     definition and is |                       |
|                       |     invoked on        |                       |
|                       |     instances of that |                       |
|                       |     class.            |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1531} |                       |
|                       |                       |                       |
|                       | [subject:]{.c010}     |                       |
|                       | :   The object a      |                       |
|                       |     method is invoked |                       |
|                       |     on.               |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1532} |                       |
|                       |                       |                       |
|                       | [positio              |                       |
|                       | nal argument:]{.c010} |                       |
|                       | :   An argument that  |                       |
|                       |     does not include  |                       |
|                       |     a parameter name, |                       |
|                       |     so it is not a    |                       |
|                       |     keyword argument. |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1533} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1534} |                       |
|                       |                       |                       |
|                       | [operator             |                       |
|                       |  overloading:]{.c010} |                       |
|                       | :   Changing the      |                       |
|                       |     behavior of an    |                       |
|                       |     operator like     |                       |
|                       |     [+]{.c004} so it  |                       |
|                       |     works with a      |                       |
|                       |                       |                       |
|                       |    programmer-defined |                       |
|                       |     type.             |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1535} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1536} |                       |
|                       |                       |                       |
|                       | [type-ba              |                       |
|                       | sed dispatch:]{.c010} |                       |
|                       | :   A programming     |                       |
|                       |     pattern that      |                       |
|                       |     checks the type   |                       |
|                       |     of an operand and |                       |
|                       |     invokes different |                       |
|                       |     functions for     |                       |
|                       |     different types.  |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1537} |                       |
|                       |                       |                       |
|                       | [polymorphic:]{.c010} |                       |
|                       | :   Pertaining to a   |                       |
|                       |     function that can |                       |
|                       |     work with more    |                       |
|                       |     than one type.    |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1538} |                       |
|                       |                       |                       |
|                       | ## 17.13  Exercis     |                       |
|                       | es {#sec208 .section} |                       |
|                       |                       |                       |
|                       | ::: theorem           |                       |
|                       | [Exercise 1]{.c010}   |                       |
|                       |                       |                       |
|                       | <em>Download the code    |                       |
|                       | from this chapter     |                       |
|                       | from</em>                 |                       |
|                       | [[<em>http               |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/Time2.py</em>]{.c004} |                       |
|                       | ](https://thinkpython |                       |
|                       | .com/code/Time2.py)<em>. |                       |
|                       | Change the attributes |                       |
|                       | of [Time]{.c004} to   |                       |
|                       | be a single integer   |                       |
|                       | representing seconds  |                       |
|                       | since midnight. Then  |                       |
|                       | modify the methods    |                       |
|                       | (and the function     |                       |
|                       | <code>int_to_time</code>) to     |                       |
|                       | work with the new     |                       |
|                       | implementation. You   |                       |
|                       | should not have to    |                       |
|                       | modify the test code  |                       |
|                       | in [main]{.c004}.     |                       |
|                       | When you are done,    |                       |
|                       | the output should be  |                       |
|                       | the same as before.   |                       |
|                       | Solution:</em>            |                       |
|                       | [[<em>https://thinkpy    |                       |
|                       | thon.com/code/Time2_s |                       |
|                       | oln.py</em>]{.c004}](http |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/Time2_soln.py)<em>.</em> |                       |
|                       | :::                   |                       |
|                       |                       |                       |
|                       | ::: theorem           |                       |
|                       | [Exercise 2]{.c010}   |                       |
|                       | []{#kangaroo}         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1539} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1540} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1541} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1542} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1543} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1544} |                       |
|                       |                       |                       |
|                       | <em>This exercise is a   |                       |
|                       | cautionary tale about |                       |
|                       | one of the most       |                       |
|                       | common, and difficult |                       |
|                       | to find, errors in    |                       |
|                       | Python. Write a       |                       |
|                       | definition for a      |                       |
|                       | class named           |                       |
|                       | [Kangaroo]{.c004}     |                       |
|                       | with the following    |                       |
|                       | methods:</em>             |                       |
|                       |                       |                       |
|                       | 1.  <em>An <code>__init__</code>    |                       |
|                       |     method that       |                       |
|                       |     initializes an    |                       |
|                       |     attribute named   |                       |
|                       |     <code>pouch_contents</code>  |                       |
|                       |     to an empty       |                       |
|                       |     list.</em>            |                       |
|                       | 2.  <em>A method named   |                       |
|                       |     <code>put_in_pouch</code>    |                       |
|                       |     that takes an     |                       |
|                       |     object of any     |                       |
|                       |     type and adds it  |                       |
|                       |     to                |                       |
|                       |                       |                       |
|                       |    <code>pouch_contents</code>.</em> |                       |
|                       | 3.  <em>A <code>__str__</code>      |                       |
|                       |     method that       |                       |
|                       |     returns a string  |                       |
|                       |     representation of |                       |
|                       |     the Kangaroo      |                       |
|                       |     object and the    |                       |
|                       |     contents of the   |                       |
|                       |     pouch.</em>           |                       |
|                       |                       |                       |
|                       | <em>Test your code by    |                       |
|                       | creating two          |                       |
|                       | [Kangaroo]{.c004}     |                       |
|                       | objects, assigning    |                       |
|                       | them to variables     |                       |
|                       | named [kanga]{.c004}  |                       |
|                       | and [roo]{.c004}, and |                       |
|                       | then adding           |                       |
|                       | [roo]{.c004} to the   |                       |
|                       | contents of           |                       |
|                       | [kanga]{.c004}'s      |                       |
|                       | pouch.</em>               |                       |
|                       |                       |                       |
|                       | <em>Download</em>            |                       |
|                       | [<em>[https://thinkpyt   |                       |
|                       | hon.com/code/BadKanga |                       |
|                       | roo.py]{.c004}</em>](http |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/BadKangaroo.py)<em>. |                       |
|                       | It contains a         |                       |
|                       | solution to the       |                       |
|                       | previous problem with |                       |
|                       | one big, nasty bug.   |                       |
|                       | Find and fix the      |                       |
|                       | bug.</em>                 |                       |
|                       |                       |                       |
|                       | <em>If you get stuck,    |                       |
|                       | you can download</em>     |                       |
|                       | [[<em>https://thinkpytho |                       |
|                       | n.com/code/GoodKangar |                       |
|                       | oo.py</em>]{.c004}](https |                       |
|                       | ://thinkpython.com/co |                       |
|                       | de/GoodKangaroo.py)<em>, |                       |
|                       | which explains the    |                       |
|                       | problem and           |                       |
|                       | demonstrates a        |                       |
|                       | solution.</em>            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1545} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1546} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1547} |                       |
|                       | :::                   |                       |
|                       |                       |                       |
|                       | [Buy this book at     |                       |
|                       | Amazon.com](ht        |                       |
|                       | tp://amzn.to/1VUYQUU) |                       |
+-----------------------+-----------------------+-----------------------+</p>
<hr />
<h2><a href="thinkpython2017.html"><img src="back.png" alt="Previous" /></a>
<a href="index.html"><img src="up.png" alt="Up" /></a> <a href="thinkpython2019.html"><img src="next.png" alt="Next" /></a></h2>
<h2>generator: hevea 2.32
title: Inheritance</h2>
<p><a href="thinkpython2018.html"><img src="back.png" alt="Previous" /></a>
<a href="index.html"><img src="up.png" alt="Up" /></a> <a href="thinkpython2020.html"><img src="next.png" alt="Next" /></a></p>
<hr />
<p>+-----------------------+-----------------------+-----------------------+
|                       | [Buy this book at     | #### Contribute       |
|                       | Amazon.com](ht        |                       |
|                       | tp://amzn.to/1VUYQUU) | If you would like to  |
|                       |                       | make a contribution   |
|                       | #                     | to support my books,  |
|                       | Chapter 18  Inheritan | you can use the       |
|                       | ce {#sec209 .chapter} | button below and pay  |
|                       |                       | with PayPal. Thank    |
|                       | The language feature  | you!                  |
|                       | most often associated |                       |
|                       | with object-oriented  |   -----------         |
|                       | programming is        | --------------------- |
|                       | [inheritance]{.c010}. | --------------------- |
|                       | Inheritance is the    | --------------------- |
|                       | ability to define a   | --------------------- |
|                       | new class that is a   |   Pay what you want:  |
|                       | modified version of   |   Small $1           |
|                       | an existing class. In | .00 USD Medium $5.00 |
|                       | this chapter I        |  USD Large $10.00 US |
|                       | demonstrate           | D X-Large $20.00 USD |
|                       | inheritance using     |  XX-Large $50.00 USD |
|                       | classes that          |   -----------         |
|                       | represent playing     | --------------------- |
|                       | cards, decks of       | --------------------- |
|                       | cards, and poker      | --------------------- |
|                       | hands.                | --------------------- |
|                       | [                     |                       |
|                       | ]{#hevea_default1548} | ![](                  |
|                       | [                     | https://www.paypalobj |
|                       | ]{#hevea_default1549} | ects.com/en_US/i/scr/ |
|                       | [                     | pixel.gif){border=&quot;0&quot; |
|                       | ]{#hevea_default1550} | width=&quot;1&quot; height=&quot;1&quot;} |
|                       |                       |                       |
|                       | If you don't play     | ####                  |
|                       | poker, you can read   | Are you using one of  |
|                       | about it at           | our books in a class? |
|                       | [[http://en.wikiped   |                       |
|                       | ia.org/wiki/Poker]{.c | We'd like to know    |
|                       | 004}](http://en.wikip | about it. Please      |
|                       | edia.org/wiki/Poker), | consider filling out  |
|                       | but you don't have    | [this short           |
|                       | to; I'll tell you     | survey](http://s      |
|                       | what you need to know | preadsheets.google.co |
|                       | for the exercises.    | m/viewform?formkey=dC |
|                       |                       | 0tNUZkMjBEdXVoRGljNm9 |
|                       | Code examples from    | FRmlTMHc6MA){onclick= |
|                       | this chapter are      | &quot;javascript: pageTrac |
|                       | available from        | ker._trackPageview('/ |
|                       | [[                    | outbound/survey');&quot;}. |
|                       | https://thinkpython.c |                       |
|                       | om/code/Card.py]{.c00 | \                     |
|                       | 4}](https://thinkpyth |                       |
|                       | on.com/code/Card.py). | [Think                |
|                       |                       | DSP](http             |
|                       | ## 18.1  Card objec   | ://www.amazon.com/gp/ |
|                       | ts {#sec210 .section} | product/1491938455/re |
|                       |                       | f=as_li_tl?ie=UTF8&amp;ca |
|                       | There are fifty-two   | mp=1789&amp;creative=9325 |
|                       | cards in a deck, each | &amp;creativeASIN=1491938 |
|                       | of which belongs to   | 455&amp;linkCode=as2&amp;tag= |
|                       | one of four suits and | greenteapre01-20&amp;link |
|                       | one of thirteen       | Id=2JJH4SWCAVVYSQHO){ |
|                       | ranks. The suits are  | rel=&quot;nofollow&quot;}![](ht |
|                       | Spades, Hearts,       | tp://ir-na.amazon-ads |
|                       | Diamonds, and Clubs   | ystem.com/e/ir?t=gree |
|                       | (in descending order  | nteapre01-20&amp;l=as2&amp;o= |
|                       | in bridge). The ranks | 1&amp;a=1491938455){.c003 |
|                       | are Ace, 2, 3, 4, 5,  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | 6, 7, 8, 9, 10, Jack, | border=&quot;0&quot;}           |
|                       | Queen, and King.      |                       |
|                       | Depending on the game | [                     |
|                       | that you are playing, | ![](http://ws-na.amaz |
|                       | an Ace may be higher  | on-adsystem.com/widge |
|                       | than King or lower    | ts/q?_encoding=UTF8&amp;A |
|                       | than 2.               | SIN=1491938455&amp;Format |
|                       | [                     | =<em>SL160</em>&amp;ID=AsinImage |
|                       | ]{#hevea_default1551} | &amp;MarketPlace=US&amp;Servi |
|                       | [                     | ceVersion=20070822&amp;WS |
|                       | ]{#hevea_default1552} | =1&amp;tag=greenteapre01- |
|                       |                       | 20){border=&quot;0&quot;}](http |
|                       | If we want to define  | ://www.amazon.com/gp/ |
|                       | a new object to       | product/1491938455/re |
|                       | represent a playing   | f=as_li_tl?ie=UTF8&amp;ca |
|                       | card, it is obvious   | mp=1789&amp;creative=9325 |
|                       | what the attributes   | &amp;creativeASIN=1491938 |
|                       | should be:            | 455&amp;linkCode=as2&amp;tag= |
|                       | [rank]{.c004} and     | greenteapre01-20&amp;link |
|                       | [suit]{.c004}. It is  | Id=CTV7PDT7E5EGGJUM){ |
|                       | not as obvious what   | rel=&quot;nofollow&quot;}![](ht |
|                       | type the attributes   | tp://ir-na.amazon-ads |
|                       | should be. One        | ystem.com/e/ir?t=gree |
|                       | possibility is to use | nteapre01-20&amp;l=as2&amp;o= |
|                       | strings containing    | 1&amp;a=1491938455){.c003 |
|                       | words like <code>'Spade'</code>  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | for suits and         | border=&quot;0&quot;}           |
|                       | <code>'Queen'</code> for ranks.  |                       |
|                       | One problem with this | [Think                |
|                       | implementation is     | Java](http            |
|                       | that it would not be  | ://www.amazon.com/gp/ |
|                       | easy to compare cards | product/1491929561/re |
|                       | to see which had a    | f=as_li_tl?ie=UTF8&amp;ca |
|                       | higher rank or suit.  | mp=1789&amp;creative=9325 |
|                       | [                     | &amp;creativeASIN=1491929 |
|                       | ]{#hevea_default1553} | 561&amp;linkCode=as2&amp;tag= |
|                       | [                     | greenteapre01-20&amp;link |
|                       | ]{#hevea_default1554} | Id=ZY6MAYM33ZTNSCNZ){ |
|                       | [                     | rel=&quot;nofollow&quot;}![](ht |
|                       | ]{#hevea_default1555} | tp://ir-na.amazon-ads |
|                       | [                     | ystem.com/e/ir?t=gree |
|                       | ]{#hevea_default1556} | nteapre01-20&amp;l=as2&amp;o= |
|                       |                       | 1&amp;a=1491929561){.c003 |
|                       | An alternative is to  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | use integers to       | border=&quot;0&quot;}           |
|                       | [encode]{.c010} the   |                       |
|                       | ranks and suits. In   | [                     |
|                       | this context,         | ![](http://ws-na.amaz |
|                       | &quot;encode&quot; means that   | on-adsystem.com/widge |
|                       | we are going to       | ts/q?_encoding=UTF8&amp;A |
|                       | define a mapping      | SIN=1491929561&amp;Format |
|                       | between numbers and   | =<em>SL160</em>&amp;ID=AsinImage |
|                       | suits, or between     | &amp;MarketPlace=US&amp;Servi |
|                       | numbers and ranks.    | ceVersion=20070822&amp;WS |
|                       | This kind of encoding | =1&amp;tag=greenteapre01- |
|                       | is not meant to be a  | 20){border=&quot;0&quot;}](http |
|                       | secret (that would be | ://www.amazon.com/gp/ |
|                       | &quot;encryption&quot;).        | product/1491929561/re |
|                       |                       | f=as_li_tl?ie=UTF8&amp;ca |
|                       | For example, this     | mp=1789&amp;creative=9325 |
|                       | table shows the suits | &amp;creativeASIN=1491929 |
|                       | and the corresponding | 561&amp;linkCode=as2&amp;tag= |
|                       | integer codes:        | greenteapre01-20&amp;link |
|                       |                       | Id=PT77ANWARUNNU3UK){ |
|                       |   ---------- --- ---  | rel=&quot;nofollow&quot;}![](ht |
|                       |   Spades     ↦   3    | tp://ir-na.amazon-ads |
|                       |   Hearts     ↦   2    | ystem.com/e/ir?t=gree |
|                       |   Diamonds   ↦   1    | nteapre01-20&amp;l=as2&amp;o= |
|                       |   Clubs      ↦   0    | 1&amp;a=1491929561){.c003 |
|                       |   ---------- --- ---  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       |                       | border=&quot;0&quot;}           |
|                       | This code makes it    |                       |
|                       | easy to compare       | [Think                |
|                       | cards; because higher | Bay                   |
|                       | suits map to higher   | es](http://www.amazon |
|                       | numbers, we can       | .com/gp/product/14493 |
|                       | compare suits by      | 70780/ref=as_li_qf_sp |
|                       | comparing their       | _asin_tl?ie=UTF8&amp;camp |
|                       | codes.                | =1789&amp;creative=9325&amp;c |
|                       |                       | reativeASIN=144937078 |
|                       | The mapping for ranks | 0&amp;linkCode=as2&amp;tag=gr |
|                       | is fairly obvious;    | eenteapre01-20)![](ht |
|                       | each of the numerical | tp://ir-na.amazon-ads |
|                       | ranks maps to the     | ystem.com/e/ir?t=gree |
|                       | corresponding         | nteapre01-20&amp;l=as2&amp;o= |
|                       | integer, and for face | 1&amp;a=1449370780){.c003 |
|                       | cards:                | width=&quot;1&quot; height=&quot;1&quot;  |
|                       |                       | border=&quot;0&quot;}           |
|                       |   ------- --- ----    |                       |
|                       |   Jack    ↦   11      | [![](http://ws        |
|                       |   Queen   ↦   12      | -na.amazon-adsystem.c |
|                       |   King    ↦   13      | om/widgets/q?_encodin |
|                       |   ------- --- ----    | g=UTF8&amp;ASIN=144937078 |
|                       |                       | 0&amp;Format=<em>SL160</em>&amp;ID=A |
|                       | I am using the        | sinImage&amp;MarketPlace= |
|                       | ↦ symbol to make it   | US&amp;ServiceVersion=200 |
|                       | clear that these      | 70822&amp;WS=1&amp;tag=greent |
|                       | mappings are not part | eapre01-20){border=&quot;0 |
|                       | of the Python         | &quot;}](http://www.amazon |
|                       | program. They are     | .com/gp/product/14493 |
|                       | part of the program   | 70780/ref=as_li_qf_sp |
|                       | design, but they      | _asin_il?ie=UTF8&amp;camp |
|                       | don't appear          | =1789&amp;creative=9325&amp;c |
|                       | explicitly in the     | reativeASIN=144937078 |
|                       | code.                 | 0&amp;linkCode=as2&amp;tag=gr |
|                       | [                     | eenteapre01-20)![](ht |
|                       | ]{#hevea_default1557} | tp://ir-na.amazon-ads |
|                       | [                     | ystem.com/e/ir?t=gree |
|                       | ]{#hevea_default1558} | nteapre01-20&amp;l=as2&amp;o= |
|                       |                       | 1&amp;a=1449370780){.c003 |
|                       | The class definition  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | for [Card]{.c004}     | border=&quot;0&quot;}           |
|                       | looks like this:      |                       |
|                       |                       | [Think Python         |
|                       | <code>verbatim          | 2e](http              | |                       | class Card:           | ://www.amazon.com/gp/ | |                       |                       | product/1491939362/re | |                       |  &quot;&quot;&quot;Represents a stan | f=as_li_tl?ie=UTF8&amp;ca | |                       | dard playing card.&quot;&quot;&quot; | mp=1789&amp;creative=9325 | |                       |                       | &amp;creativeASIN=1491939 | |                       |     def __init__(s    | 362&amp;linkCode=as2&amp;tag= | |                       | elf, suit=0, rank=2): | greenteapre01-20&amp;link | |                       |                       | Id=FJKSQ3IHEMY2F2VA){ | |                       |      self.suit = suit | rel=&quot;nofollow&quot;}![](ht | |                       |                       | tp://ir-na.amazon-ads | |                       |      self.rank = rank | ystem.com/e/ir?t=gree | |                       |</code>                   | nteapre01-20&amp;l=as2&amp;o= |
|                       |                       | 1&amp;a=1491939362){.c003 |
|                       | As usual, the init    | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | method takes an       | border=&quot;0&quot;}           |
|                       | optional parameter    |                       |
|                       | for each attribute.   | [                     |
|                       | The default card is   | ![](http://ws-na.amaz |
|                       | the 2 of Clubs.       | on-adsystem.com/widge |
|                       | [                     | ts/q?<em>encoding=UTF8&amp;A |
|                       | ]{#hevea_default1559} | SIN=1491939362&amp;Format |
|                       | [                     | =<em>SL160</em>&amp;ID=AsinImage |
|                       | ]{#hevea_default1560} | &amp;MarketPlace=US&amp;Servi |
|                       |                       | ceVersion=20070822&amp;WS |
|                       | To create a Card, you | =1&amp;tag=greenteapre01- |
|                       | call [Card]{.c004}    | 20){border=&quot;0&quot;}](http |
|                       | with the suit and     | ://www.amazon.com/gp/ |
|                       | rank of the card you  | product/1491939362/re |
|                       | want.                 | f=as_li_tl?ie=UTF8&amp;ca |
|                       |                       | mp=1789&amp;creative=9325 |
|                       | <code>verbatim          | &amp;creativeASIN=1491939 | |                       | queen_of_d            | 362&amp;linkCode=as2&amp;tag= | |                       | iamonds = Card(1, 12) | greenteapre01-20&amp;link | |                       |</code>                   | Id=ZZ454DLQ3IXDHNHX){ |
|                       |                       | rel=&quot;nofollow&quot;}![](ht |
|                       | ##                    | tp://ir-na.amazon-ads |
|                       |  18.2  Class attribut | ystem.com/e/ir?t=gree |
|                       | es {#sec211 .section} | nteapre01-20&amp;l=as2&amp;o= |
|                       |                       | 1&amp;a=1491939362){.c003 |
|                       | []{#class.attribute}  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | [                     | border=&quot;0&quot;}           |
|                       | ]{#hevea_default1561} |                       |
|                       | [                     | [Think Stats          |
|                       | ]{#hevea_default1562} | 2e](http://ww         |
|                       |                       | w.amazon.com/gp/produ |
|                       | In order to print     | ct/1491907339/ref=as</em> |
|                       | Card objects in a way | li_tl?ie=UTF8&amp;camp=17 |
|                       | that people can       | 89&amp;creative=9325&amp;crea |
|                       | easily read, we need  | tiveASIN=1491907339&amp;l |
|                       | a mapping from the    | inkCode=as2&amp;tag=green |
|                       | integer codes to the  | teapre01-20&amp;linkId=O7 |
|                       | corresponding ranks   | WYM6H6YBYUFNWU)![](ht |
|                       | and suits. A natural  | tp://ir-na.amazon-ads |
|                       | way to do that is     | ystem.com/e/ir?t=gree |
|                       | with lists of         | nteapre01-20&amp;l=as2&amp;o= |
|                       | strings. We assign    | 1&amp;a=1491907339){.c003 |
|                       | these lists to [class | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | attributes]{.c010}:   | border=&quot;0&quot;}           |
|                       |                       |                       |
|                       | <code>verbatim          | [![](h                | |                       | # inside class Card:  | ttp://ws-na.amazon-ad | |                       |                       | system.com/widgets/q? | |                       |     suit_names =      | _encoding=UTF8&amp;ASIN=1 | |                       |  ['Clubs', 'Diamonds' | 491907339&amp;Format=_SL1 | |                       | , 'Hearts', 'Spades'] | 60_&amp;ID=AsinImage&amp;Mark | |                       |     rank_names = [N   | etPlace=US&amp;ServiceVer | |                       | one, 'Ace', '2', '3', | sion=20070822&amp;WS=1&amp;ta | |                       |  '4', '5', '6', '7',  | g=greenteapre01-20){b | |                       |                       | order=&quot;0&quot;}](http://ww | |                       |   '8', '9', '10', 'Ja | w.amazon.com/gp/produ | |                       | ck', 'Queen', 'King'] | ct/1491907339/ref=as_ | |                       |                       | li_tl?ie=UTF8&amp;camp=17 | |                       |                       | 89&amp;creative=9325&amp;crea | |                       |    def __str__(self): | tiveASIN=1491907339&amp;l | |                       |         return        | inkCode=as2&amp;tag=green | |                       |  '%s of %s' % (Card.r | teapre01-20&amp;linkId=JV | |                       | ank_names[self.rank], | SYKQHYSUIEYRHL)![](ht | |                       |                       | tp://ir-na.amazon-ads | |                       |                Card.s | ystem.com/e/ir?t=gree | |                       | uit_names[self.suit]) | nteapre01-20&amp;l=as2&amp;o= | |                       |</code>                   | 1&amp;a=1491907339){.c003 |
|                       |                       | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | Variables like        | border=&quot;0&quot;}           |
|                       | <code>suit_names</code> and      |                       |
|                       | <code>rank_names</code>, which   | [Think                |
|                       | are defined inside a  | Complexity](http      |
|                       | class but outside of  | ://www.amazon.com/gp/ |
|                       | any method, are       | product/1449314635/re |
|                       | called class          | f=as_li_tf_tl?ie=UTF8 |
|                       | attributes because    | &amp;tag=greenteapre01-20 |
|                       | they are associated   | &amp;linkCode=as2&amp;camp=17 |
|                       | with the class object | 89&amp;creative=9325&amp;crea |
|                       | [Card]{.c004}.        | tiveASIN=1449314635)! |
|                       | [                     | [](http://www.assoc-a |
|                       | ]{#hevea_default1563} | mazon.com/e/ir?t=gree |
|                       | [                     | nteapre01-20&amp;l=as2&amp;o= |
|                       | ]{#hevea_default1564} | 1&amp;a=1449314635){.c003 |
|                       |                       | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | This term             | border=&quot;0&quot;}           |
|                       | distinguishes them    |                       |
|                       | from variables like   | [                     |
|                       | [suit]{.c004} and     | ![](http://ws-na.amaz |
|                       | [rank]{.c004}, which  | on-adsystem.com/widge |
|                       | are called [instance  | ts/q?_encoding=UTF8&amp;A |
|                       | attributes]{.c010}    | SIN=1449314635&amp;Format |
|                       | because they are      | =<em>SL160</em>&amp;ID=AsinImage |
|                       | associated with a     | &amp;MarketPlace=US&amp;Servi |
|                       | particular instance.  | ceVersion=20070822&amp;WS |
|                       | [                     | =1&amp;tag=greenteapre01- |
|                       | ]{#hevea_default1565} | 20){border=&quot;0&quot;}](http |
|                       |                       | ://www.amazon.com/gp/ |
|                       | Both kinds of         | product/1449314635/re |
|                       | attribute are         | f=as_li_tf_il?ie=UTF8 |
|                       | accessed using dot    | &amp;camp=1789&amp;creative=9 |
|                       | notation. For         | 325&amp;creativeASIN=1449 |
|                       | example, in           | 314635&amp;linkCode=as2&amp;t |
|                       | <code>__str__</code>,            | ag=greenteapre01-20)! |
|                       | [self]{.c004} is a    | [](http://www.assoc-a |
|                       | Card object, and      | mazon.com/e/ir?t=gree |
|                       | [self.rank]{.c004} is | nteapre01-20&amp;l=as2&amp;o= |
|                       | its rank. Similarly,  | 1&amp;a=1449314635){.c003 |
|                       | [Card]{.c004} is a    | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | class object, and     | border=&quot;0&quot;}           |
|                       | <code>Card.rank_names</code> is  |                       |
|                       | a list of strings     |                       |
|                       | associated with the   |                       |
|                       | class.                |                       |
|                       |                       |                       |
|                       | Every card has its    |                       |
|                       | own [suit]{.c004} and |                       |
|                       | [rank]{.c004}, but    |                       |
|                       | there is only one     |                       |
|                       | copy of <code>suit_names</code>  |                       |
|                       | and <code>rank_names</code>.     |                       |
|                       |                       |                       |
|                       | Putting it all        |                       |
|                       | together, the         |                       |
|                       | expression            |                       |
|                       | <code>Card.r               |                       | |                       | ank_names[self.rank]</code> |                       |
|                       | means &quot;use the        |                       |
|                       | attribute             |                       |
|                       | [rank]{.c004} from    |                       |
|                       | the object            |                       |
|                       | [self]{.c004} as an   |                       |
|                       | index into the list   |                       |
|                       | <code>rank_names</code> from the |                       |
|                       | class [Card]{.c004},  |                       |
|                       | and select the        |                       |
|                       | appropriate string.&quot;  |                       |
|                       |                       |                       |
|                       | The first element of  |                       |
|                       | <code>rank_names</code> is       |                       |
|                       | [None]{.c004} because |                       |
|                       | there is no card with |                       |
|                       | rank zero. By         |                       |
|                       | including             |                       |
|                       | [None]{.c004} as a    |                       |
|                       | place-keeper, we get  |                       |
|                       | a mapping with the    |                       |
|                       | nice property that    |                       |
|                       | the index 2 maps to   |                       |
|                       | the string <code>'2'</code>, and |                       |
|                       | so on. To avoid this  |                       |
|                       | tweak, we could have  |                       |
|                       | used a dictionary     |                       |
|                       | instead of a list.    |                       |
|                       |                       |                       |
|                       | With the methods we   |                       |
|                       | have so far, we can   |                       |
|                       | create and print      |                       |
|                       | cards:                |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; card1 = Card(2, 11) |                       | |                       | &gt;&gt;&gt; print(card1)      |                       | |                       | Jack of Hearts        |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt;                     |                       |
|                       | &gt; ------------------- |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt; ![]                 |                       |
|                       | (thinkpython2024.png) |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: caption         |                       |
|                       | &gt;   ---------         |                       |
|                       | --------------------- |                       |
|                       | &gt;   Figure            |                       |
|                       | 18.1: Object diagram. |                       |
|                       | &gt;   ---------         |                       |
|                       | --------------------- |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; []{#fig.card1}      |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt;                     |                       |
|                       | &gt; ------------------- |                       |
|                       | &gt; :::                 |                       |
|                       |                       |                       |
|                       | Figu                  |                       |
|                       | re <a href="#fig.card1">18.1</a> |                       |
|                       | is a diagram of the   |                       |
|                       | [Card]{.c004} class   |                       |
|                       | object and one Card   |                       |
|                       | instance.             |                       |
|                       | [Card]{.c004} is a    |                       |
|                       | class object; its     |                       |
|                       | type is               |                       |
|                       | [type]{.c004}.        |                       |
|                       | [card1]{.c004} is an  |                       |
|                       | instance of           |                       |
|                       | [Card]{.c004}, so its |                       |
|                       | type is               |                       |
|                       | [Card]{.c004}. To     |                       |
|                       | save space, I didn't  |                       |
|                       | draw the contents of  |                       |
|                       | <code>suit_names</code> and      |                       |
|                       | <code>rank_names</code>.         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1566} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1567} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1568} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1569} |                       |
|                       |                       |                       |
|                       | #                     |                       |
|                       | # 18.3  Comparing car |                       |
|                       | ds {#sec212 .section} |                       |
|                       |                       |                       |
|                       | []{#comparecard}      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1570} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1571} |                       |
|                       |                       |                       |
|                       | For built-in types,   |                       |
|                       | there are relational  |                       |
|                       | operators             |                       |
|                       | ([&lt;]{.c004},         |                       |
|                       | [&gt;]{.c004},          |                       |
|                       | [==]{.c004}, etc.)    |                       |
|                       | that compare values   |                       |
|                       | and determine when    |                       |
|                       | one is greater than,  |                       |
|                       | less than, or equal   |                       |
|                       | to another. For       |                       |
|                       | programmer-defined    |                       |
|                       | types, we can         |                       |
|                       | override the behavior |                       |
|                       | of the built-in       |                       |
|                       | operators by          |                       |
|                       | providing a method    |                       |
|                       | named <code>__lt__</code>, which |                       |
|                       | stands for &quot;less      |                       |
|                       | than&quot;.                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1572} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1573} |                       |
|                       |                       |                       |
|                       | <code>__lt__</code> takes two    |                       |
|                       | parameters,           |                       |
|                       | [self]{.c004} and     |                       |
|                       | [other]{.c004}, and   |                       |
|                       | returns [True]{.c004} |                       |
|                       | if [self]{.c004} is   |                       |
|                       | strictly less than    |                       |
|                       | [other]{.c004}.       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1574} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1575} |                       |
|                       |                       |                       |
|                       | The correct ordering  |                       |
|                       | for cards is not      |                       |
|                       | obvious. For example, |                       |
|                       | which is better, the  |                       |
|                       | 3 of Clubs or the 2   |                       |
|                       | of Diamonds? One has  |                       |
|                       | a higher rank, but    |                       |
|                       | the other has a       |                       |
|                       | higher suit. In order |                       |
|                       | to compare cards, you |                       |
|                       | have to decide        |                       |
|                       | whether rank or suit  |                       |
|                       | is more important.    |                       |
|                       |                       |                       |
|                       | The answer might      |                       |
|                       | depend on what game   |                       |
|                       | you are playing, but  |                       |
|                       | to keep things        |                       |
|                       | simple, we'll make    |                       |
|                       | the arbitrary choice  |                       |
|                       | that suit is more     |                       |
|                       | important, so all of  |                       |
|                       | the Spades outrank    |                       |
|                       | all of the Diamonds,  |                       |
|                       | and so on.            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1576} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1577} |                       |
|                       |                       |                       |
|                       | With that decided, we |                       |
|                       | can write <code>__lt__</code>:   |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Card:  |                       | |                       |                       |                       | |                       |     def               |                       | |                       |  __lt__(self, other): |                       | |                       |                       |                       | |                       |     # check the suits |                       | |                       |                       |                       | |                       |     if self.suit &lt; ot |                       | |                       | her.suit: return True |                       | |                       |                       |                       | |                       |    if self.suit &gt; oth |                       | |                       | er.suit: return False |                       | |                       |                       |                       | |                       |                       |                       | |                       |        # suits are th |                       | |                       | e same... check ranks |                       | |                       |         return s      |                       | |                       | elf.rank &lt; other.rank |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | You can write this    |                       |
|                       | more concisely using  |                       |
|                       | tuple comparison:     |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1578} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1579} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Card:  |                       | |                       |                       |                       | |                       |     def               |                       | |                       |  __lt__(self, other): |                       | |                       |         t1 =          |                       | |                       |  self.suit, self.rank |                       | |                       |         t2 = o        |                       | |                       | ther.suit, other.rank |                       | |                       |                       |                       | |                       |        return t1 &lt; t2 |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | an <code>__lt__</code> method    |                       |
|                       | for Time objects. You |                       |
|                       | can use tuple         |                       |
|                       | comparison, but you   |                       |
|                       | also might consider   |                       |
|                       | comparing integers.   |                       |
|                       |                       |                       |
|                       | ## 18.4  Dec          |                       |
|                       | ks {#sec213 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1580} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1581} |                       |
|                       |                       |                       |
|                       | Now that we have      |                       |
|                       | Cards, the next step  |                       |
|                       | is to define Decks.   |                       |
|                       | Since a deck is made  |                       |
|                       | up of cards, it is    |                       |
|                       | natural for each Deck |                       |
|                       | to contain a list of  |                       |
|                       | cards as an           |                       |
|                       | attribute.            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1582} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1583} |                       |
|                       |                       |                       |
|                       | The following is a    |                       |
|                       | class definition for  |                       |
|                       | [Deck]{.c004}. The    |                       |
|                       | init method creates   |                       |
|                       | the attribute         |                       |
|                       | [cards]{.c004} and    |                       |
|                       | generates the         |                       |
|                       | standard set of       |                       |
|                       | fifty-two cards:      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1584} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1585} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1586} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1587} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | class Deck:           |                       | |                       |                       |                       | |                       |                       |                       | |                       |   def __init__(self): |                       | |                       |                       |                       | |                       |       self.cards = [] |                       | |                       |                       |                       | |                       | for suit in range(4): |                       | |                       |             for       |                       | |                       | rank in range(1, 14): |                       | |                       |                 ca    |                       | |                       | rd = Card(suit, rank) |                       | |                       |                 se    |                       | |                       | lf.cards.append(card) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The easiest way to    |                       |
|                       | populate the deck is  |                       |
|                       | with a nested loop.   |                       |
|                       | The outer loop        |                       |
|                       | enumerates the suits  |                       |
|                       | from 0 to 3. The      |                       |
|                       | inner loop enumerates |                       |
|                       | the ranks from 1 to   |                       |
|                       | 13. Each iteration    |                       |
|                       | creates a new Card    |                       |
|                       | with the current suit |                       |
|                       | and rank, and appends |                       |
|                       | it to                 |                       |
|                       | [self.cards]{.c004}.  |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1588} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1589} |                       |
|                       |                       |                       |
|                       | ##                    |                       |
|                       | 18.5  Printing the de |                       |
|                       | ck {#sec214 .section} |                       |
|                       |                       |                       |
|                       | []{#printdeck}        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1590} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1591} |                       |
|                       |                       |                       |
|                       | Here is a <code>__str__</code>   |                       |
|                       | method for            |                       |
|                       | [Deck]{.c004}:        |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Deck:  |                       | |                       |                       |                       | |                       |                       |                       | |                       |    def __str__(self): |                       | |                       |         res = []      |                       | |                       |         fo            |                       | |                       | r card in self.cards: |                       | |                       |                       |                       | |                       | res.append(str(card)) |                       | |                       |                       |                       | |                       | return '\n'.join(res) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This method           |                       |
|                       | demonstrates an       |                       |
|                       | efficient way to      |                       |
|                       | accumulate a large    |                       |
|                       | string: building a    |                       |
|                       | list of strings and   |                       |
|                       | then using the string |                       |
|                       | method [join]{.c004}. |                       |
|                       | The built-in function |                       |
|                       | [str]{.c004} invokes  |                       |
|                       | the <code>__str__</code> method  |                       |
|                       | on each card and      |                       |
|                       | returns the string    |                       |
|                       | representation.       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1592} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1593} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1594} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1595} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1596} |                       |
|                       |                       |                       |
|                       | Since we invoke       |                       |
|                       | [join]{.c004} on a    |                       |
|                       | newline character,    |                       |
|                       | the cards are         |                       |
|                       | separated by          |                       |
|                       | newlines. Here's what |                       |
|                       | the result looks      |                       |
|                       | like:                 |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; deck = Deck()     |                       | |                       | &gt;&gt;&gt; print(deck)       |                       | |                       | Ace of Clubs          |                       | |                       | 2 of Clubs            |                       | |                       | 3 of Clubs            |                       | |                       | ...                   |                       | |                       | 10 of Spades          |                       | |                       | Jack of Spades        |                       | |                       | Queen of Spades       |                       | |                       | King of Spades        |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Even though the       |                       |
|                       | result appears on 52  |                       |
|                       | lines, it is one long |                       |
|                       | string that contains  |                       |
|                       | newlines.             |                       |
|                       |                       |                       |
|                       | ## 18.6  Add, r       |                       |
|                       | emove, shuffle and so |                       |
|                       | rt {#sec215 .section} |                       |
|                       |                       |                       |
|                       | To deal cards, we     |                       |
|                       | would like a method   |                       |
|                       | that removes a card   |                       |
|                       | from the deck and     |                       |
|                       | returns it. The list  |                       |
|                       | method [pop]{.c004}   |                       |
|                       | provides a convenient |                       |
|                       | way to do that:       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1597} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1598} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Deck:  |                       | |                       |                       |                       | |                       |                       |                       | |                       |   def pop_card(self): |                       | |                       |         re            |                       | |                       | turn self.cards.pop() |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Since [pop]{.c004}    |                       |
|                       | removes the <em>last</em>    |                       |
|                       | card in the list, we  |                       |
|                       | are dealing from the  |                       |
|                       | bottom of the deck.   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1599} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1600} |                       |
|                       |                       |                       |
|                       | To add a card, we can |                       |
|                       | use the list method   |                       |
|                       | [append]{.c004}:      |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Deck:  |                       | |                       |                       |                       | |                       |     def               |                       | |                       | add_card(self, card): |                       | |                       |         se            |                       | |                       | lf.cards.append(card) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | A method like this    |                       |
|                       | that uses another     |                       |
|                       | method without doing  |                       |
|                       | much work is          |                       |
|                       | sometimes called a    |                       |
|                       | [veneer]{.c010}. The  |                       |
|                       | metaphor comes from   |                       |
|                       | woodworking, where a  |                       |
|                       | veneer is a thin      |                       |
|                       | layer of good quality |                       |
|                       | wood glued to the     |                       |
|                       | surface of a cheaper  |                       |
|                       | piece of wood to      |                       |
|                       | improve the           |                       |
|                       | appearance.           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1601} |                       |
|                       |                       |                       |
|                       | In this case          |                       |
|                       | <code>add_card</code> is a       |                       |
|                       | &quot;thin&quot; method that    |                       |
|                       | expresses a list      |                       |
|                       | operation in terms    |                       |
|                       | appropriate for       |                       |
|                       | decks. It improves    |                       |
|                       | the appearance, or    |                       |
|                       | interface, of the     |                       |
|                       | implementation.       |                       |
|                       |                       |                       |
|                       | As another example,   |                       |
|                       | we can write a Deck   |                       |
|                       | method named          |                       |
|                       | [shuffle]{.c004}      |                       |
|                       | using the function    |                       |
|                       | [shuffle]{.c004} from |                       |
|                       | the [random]{.c004}   |                       |
|                       | module:               |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1602} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1603} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1604} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1605} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Deck:  |                       | |                       |                       |                       | |                       |                       |                       | |                       |    def shuffle(self): |                       | |                       |         rando         |                       | |                       | m.shuffle(self.cards) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Don't forget to       |                       |
|                       | import                |                       |
|                       | [random]{.c004}.      |                       |
|                       |                       |                       |
|                       | As an exercise, write |                       |
|                       | a Deck method named   |                       |
|                       | [sort]{.c004} that    |                       |
|                       | uses the list method  |                       |
|                       | [sort]{.c004} to sort |                       |
|                       | the cards in a        |                       |
|                       | [Deck]{.c004}.        |                       |
|                       | [sort]{.c004} uses    |                       |
|                       | the <code>__lt__</code> method   |                       |
|                       | we defined to         |                       |
|                       | determine the order.  |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1606} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1607} |                       |
|                       |                       |                       |
|                       | ## 18.7  Inheritan    |                       |
|                       | ce {#sec216 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1608} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1609} |                       |
|                       |                       |                       |
|                       | Inheritance is the    |                       |
|                       | ability to define a   |                       |
|                       | new class that is a   |                       |
|                       | modified version of   |                       |
|                       | an existing class. As |                       |
|                       | an example, let's say |                       |
|                       | we want a class to    |                       |
|                       | represent a &quot;hand&quot;,   |                       |
|                       | that is, the cards    |                       |
|                       | held by one player. A |                       |
|                       | hand is similar to a  |                       |
|                       | deck: both are made   |                       |
|                       | up of a collection of |                       |
|                       | cards, and both       |                       |
|                       | require operations    |                       |
|                       | like adding and       |                       |
|                       | removing cards.       |                       |
|                       |                       |                       |
|                       | A hand is also        |                       |
|                       | different from a      |                       |
|                       | deck; there are       |                       |
|                       | operations we want    |                       |
|                       | for hands that don't  |                       |
|                       | make sense for a      |                       |
|                       | deck. For example, in |                       |
|                       | poker we might        |                       |
|                       | compare two hands to  |                       |
|                       | see which one wins.   |                       |
|                       | In bridge, we might   |                       |
|                       | compute a score for a |                       |
|                       | hand in order to make |                       |
|                       | a bid.                |                       |
|                       |                       |                       |
|                       | This relationship     |                       |
|                       | between               |                       |
|                       | classes---similar,    |                       |
|                       | but different---lends |                       |
|                       | itself to             |                       |
|                       | inheritance. To       |                       |
|                       | define a new class    |                       |
|                       | that inherits from an |                       |
|                       | existing class, you   |                       |
|                       | put the name of the   |                       |
|                       | existing class in     |                       |
|                       | parentheses:          |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1610} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1611} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1612} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1613} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1614} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | class Hand(Deck):     |                       | |                       |                       |                       | |                       |  &quot;&quot;&quot;Represents a hand |                       | |                       |  of playing cards.&quot;&quot;&quot; |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This definition       |                       |
|                       | indicates that        |                       |
|                       | [Hand]{.c004}         |                       |
|                       | inherits from         |                       |
|                       | [Deck]{.c004}; that   |                       |
|                       | means we can use      |                       |
|                       | methods like          |                       |
|                       | <code>pop_card</code> and        |                       |
|                       | <code>add_card</code> for Hands  |                       |
|                       | as well as Decks.     |                       |
|                       |                       |                       |
|                       | When a new class      |                       |
|                       | inherits from an      |                       |
|                       | existing one, the     |                       |
|                       | existing one is       |                       |
|                       | called the            |                       |
|                       | [parent]{.c010} and   |                       |
|                       | the new class is      |                       |
|                       | called the            |                       |
|                       | [child]{.c010}.       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1615} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1616} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1617} |                       |
|                       |                       |                       |
|                       | In this example,      |                       |
|                       | [Hand]{.c004}         |                       |
|                       | inherits <code>__init__</code>   |                       |
|                       | from [Deck]{.c004},   |                       |
|                       | but it doesn't really |                       |
|                       | do what we want:      |                       |
|                       | instead of populating |                       |
|                       | the hand with 52 new  |                       |
|                       | cards, the init       |                       |
|                       | method for Hands      |                       |
|                       | should initialize     |                       |
|                       | [cards]{.c004} with   |                       |
|                       | an empty list.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1618} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1619} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1620} |                       |
|                       |                       |                       |
|                       | If we provide an init |                       |
|                       | method in the         |                       |
|                       | [Hand]{.c004} class,  |                       |
|                       | it overrides the one  |                       |
|                       | in the [Deck]{.c004}  |                       |
|                       | class:                |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Hand:  |                       | |                       |                       |                       | |                       |     def __in          |                       | |                       | it__(self, label=''): |                       | |                       |                       |                       | |                       |       self.cards = [] |                       | |                       |                       |                       | |                       |    self.label = label |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When you create a     |                       |
|                       | Hand, Python invokes  |                       |
|                       | this init method, not |                       |
|                       | the one in            |                       |
|                       | [Deck]{.c004}.        |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; ha                |                       | |                       | nd = Hand('new hand') |                       | |                       | &gt;&gt;&gt; hand.cards        |                       | |                       | []                    |                       | |                       | &gt;&gt;&gt; hand.label        |                       | |                       | 'new hand'            |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The other methods are |                       |
|                       | inherited from        |                       |
|                       | [Deck]{.c004}, so we  |                       |
|                       | can use <code>pop_card</code>    |                       |
|                       | and <code>add_card</code> to     |                       |
|                       | deal a card:          |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; deck = Deck()     |                       | |                       | &gt;&gt;&gt; c                 |                       | |                       | ard = deck.pop_card() |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; hand.add_card(card) |                       | |                       | &gt;&gt;&gt; print(hand)       |                       | |                       | King of Spades        |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | A natural next step   |                       |
|                       | is to encapsulate     |                       |
|                       | this code in a method |                       |
|                       | called <code>move_cards</code>:  |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1621} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | # inside class Deck:  |                       | |                       |                       |                       | |                       |     def move_ca       |                       | |                       | rds(self, hand, num): |                       | |                       |                       |                       | |                       |  for i in range(num): |                       | |                       |             hand.add_ |                       | |                       | card(self.pop_card()) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | <code>move_cards</code> takes    |                       |
|                       | two arguments, a Hand |                       |
|                       | object and the number |                       |
|                       | of cards to deal. It  |                       |
|                       | modifies both         |                       |
|                       | [self]{.c004} and     |                       |
|                       | [hand]{.c004}, and    |                       |
|                       | returns               |                       |
|                       | [None]{.c004}.        |                       |
|                       |                       |                       |
|                       | In some games, cards  |                       |
|                       | are moved from one    |                       |
|                       | hand to another, or   |                       |
|                       | from a hand back to   |                       |
|                       | the deck. You can use |                       |
|                       | <code>move_cards</code> for any  |                       |
|                       | of these operations:  |                       |
|                       | [self]{.c004} can be  |                       |
|                       | either a Deck or a    |                       |
|                       | Hand, and             |                       |
|                       | [hand]{.c004},        |                       |
|                       | despite the name, can |                       |
|                       | also be a             |                       |
|                       | [Deck]{.c004}.        |                       |
|                       |                       |                       |
|                       | Inheritance is a      |                       |
|                       | useful feature. Some  |                       |
|                       | programs that would   |                       |
|                       | be repetitive without |                       |
|                       | inheritance can be    |                       |
|                       | written more          |                       |
|                       | elegantly with it.    |                       |
|                       | Inheritance can       |                       |
|                       | facilitate code       |                       |
|                       | reuse, since you can  |                       |
|                       | customize the         |                       |
|                       | behavior of parent    |                       |
|                       | classes without       |                       |
|                       | having to modify      |                       |
|                       | them. In some cases,  |                       |
|                       | the inheritance       |                       |
|                       | structure reflects    |                       |
|                       | the natural structure |                       |
|                       | of the problem, which |                       |
|                       | makes the design      |                       |
|                       | easier to understand. |                       |
|                       |                       |                       |
|                       | On the other hand,    |                       |
|                       | inheritance can make  |                       |
|                       | programs difficult to |                       |
|                       | read. When a method   |                       |
|                       | is invoked, it is     |                       |
|                       | sometimes not clear   |                       |
|                       | where to find its     |                       |
|                       | definition. The       |                       |
|                       | relevant code may be  |                       |
|                       | spread across several |                       |
|                       | modules. Also, many   |                       |
|                       | of the things that    |                       |
|                       | can be done using     |                       |
|                       | inheritance can be    |                       |
|                       | done as well or       |                       |
|                       | better without it.    |                       |
|                       |                       |                       |
|                       | ## 18.8  Class diagra |                       |
|                       | ms {#sec217 .section} |                       |
|                       |                       |                       |
|                       | []{#class.diagram}    |                       |
|                       |                       |                       |
|                       | So far we have seen   |                       |
|                       | stack diagrams, which |                       |
|                       | show the state of a   |                       |
|                       | program, and object   |                       |
|                       | diagrams, which show  |                       |
|                       | the attributes of an  |                       |
|                       | object and their      |                       |
|                       | values. These         |                       |
|                       | diagrams represent a  |                       |
|                       | snapshot in the       |                       |
|                       | execution of a        |                       |
|                       | program, so they      |                       |
|                       | change as the program |                       |
|                       | runs.                 |                       |
|                       |                       |                       |
|                       | They are also highly  |                       |
|                       | detailed; for some    |                       |
|                       | purposes, too         |                       |
|                       | detailed. A class     |                       |
|                       | diagram is a more     |                       |
|                       | abstract              |                       |
|                       | representation of the |                       |
|                       | structure of a        |                       |
|                       | program. Instead of   |                       |
|                       | showing individual    |                       |
|                       | objects, it shows     |                       |
|                       | classes and the       |                       |
|                       | relationships between |                       |
|                       | them.                 |                       |
|                       |                       |                       |
|                       | There are several     |                       |
|                       | kinds of relationship |                       |
|                       | between classes:      |                       |
|                       |                       |                       |
|                       | -   Objects in one    |                       |
|                       |     class might       |                       |
|                       |     contain           |                       |
|                       |     references to     |                       |
|                       |     objects in        |                       |
|                       |     another class.    |                       |
|                       |     For example, each |                       |
|                       |     Rectangle         |                       |
|                       |     contains a        |                       |
|                       |     reference to a    |                       |
|                       |     Point, and each   |                       |
|                       |     Deck contains     |                       |
|                       |     references to     |                       |
|                       |     many Cards. This  |                       |
|                       |     kind of           |                       |
|                       |     relationship is   |                       |
|                       |     called            |                       |
|                       |     [HAS-A]{.c010},   |                       |
|                       |     as in, &quot;a         |                       |
|                       |     Rectangle has a   |                       |
|                       |     Point.&quot;           |                       |
|                       | -   One class might   |                       |
|                       |     inherit from      |                       |
|                       |     another. This     |                       |
|                       |     relationship is   |                       |
|                       |     called            |                       |
|                       |     [IS-A]{.c010}, as |                       |
|                       |     in, &quot;a Hand is a  |                       |
|                       |     kind of a Deck.&quot;  |                       |
|                       | -   One class might   |                       |
|                       |     depend on another |                       |
|                       |     in the sense that |                       |
|                       |     objects in one    |                       |
|                       |     class take        |                       |
|                       |     objects in the    |                       |
|                       |     second class as   |                       |
|                       |     parameters, or    |                       |
|                       |     use objects in    |                       |
|                       |     the second class  |                       |
|                       |     as part of a      |                       |
|                       |     computation. This |                       |
|                       |     kind of           |                       |
|                       |     relationship is   |                       |
|                       |     called a          |                       |
|                       |                       |                       |
|                       |  [dependency]{.c010}. |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1622} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1623} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1624} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1625} |                       |
|                       |                       |                       |
|                       | A [class              |                       |
|                       | diagram]{.c010} is a  |                       |
|                       | graphical             |                       |
|                       | representation of     |                       |
|                       | these relationships.  |                       |
|                       | For example,          |                       |
|                       | Figur                 |                       |
|                       | e <a href="#fig.class1">18.2</a> |                       |
|                       | shows the             |                       |
|                       | relationships between |                       |
|                       | [Card]{.c004},        |                       |
|                       | [Deck]{.c004} and     |                       |
|                       | [Hand]{.c004}.        |                       |
|                       |                       |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt;                     |                       |
|                       | &gt; ------------------- |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt; ![]                 |                       |
|                       | (thinkpython2025.png) |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: caption         |                       |
|                       | &gt;   --------          |                       |
|                       | --------------------- |                       |
|                       | &gt;   Figure            |                       |
|                       |  18.2: Class diagram. |                       |
|                       | &gt;   --------          |                       |
|                       | --------------------- |                       |
|                       | &gt; :::                 |                       |
|                       | &gt;                     |                       |
|                       | &gt; []{#fig.class1}     |                       |
|                       | &gt;                     |                       |
|                       | &gt; ::: center          |                       |
|                       | &gt;                     |                       |
|                       | &gt; ------------------- |                       |
|                       | &gt; :::                 |                       |
|                       |                       |                       |
|                       | The arrow with a      |                       |
|                       | hollow triangle head  |                       |
|                       | represents an IS-A    |                       |
|                       | relationship; in this |                       |
|                       | case it indicates     |                       |
|                       | that Hand inherits    |                       |
|                       | from Deck.            |                       |
|                       |                       |                       |
|                       | The standard arrow    |                       |
|                       | head represents a     |                       |
|                       | HAS-A relationship;   |                       |
|                       | in this case a Deck   |                       |
|                       | has references to     |                       |
|                       | Card objects.         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1626} |                       |
|                       |                       |                       |
|                       | The star              |                       |
|                       | ([*]{.c004}) near    |                       |
|                       | the arrow head is a   |                       |
|                       | [                     |                       |
|                       | multiplicity]{.c010}; |                       |
|                       | it indicates how many |                       |
|                       | Cards a Deck has. A   |                       |
|                       | multiplicity can be a |                       |
|                       | simple number, like   |                       |
|                       | [52]{.c004}, a range, |                       |
|                       | like [5..7]{.c004} or |                       |
|                       | a star, which         |                       |
|                       | indicates that a Deck |                       |
|                       | can have any number   |                       |
|                       | of Cards.             |                       |
|                       |                       |                       |
|                       | There are no          |                       |
|                       | dependencies in this  |                       |
|                       | diagram. They would   |                       |
|                       | normally be shown     |                       |
|                       | with a dashed arrow.  |                       |
|                       | Or if there are a lot |                       |
|                       | of dependencies, they |                       |
|                       | are sometimes         |                       |
|                       | omitted.              |                       |
|                       |                       |                       |
|                       | A more detailed       |                       |
|                       | diagram might show    |                       |
|                       | that a Deck actually  |                       |
|                       | contains a <em>list</em> of  |                       |
|                       | Cards, but built-in   |                       |
|                       | types like list and   |                       |
|                       | dict are usually not  |                       |
|                       | included in class     |                       |
|                       | diagrams.             |                       |
|                       |                       |                       |
|                       | ## 18.9  Debuggi      |                       |
|                       | ng {#sec218 .section} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1627} |                       |
|                       |                       |                       |
|                       | Inheritance can make  |                       |
|                       | debugging difficult   |                       |
|                       | because when you      |                       |
|                       | invoke a method on an |                       |
|                       | object, it might be   |                       |
|                       | hard to figure out    |                       |
|                       | which method will be  |                       |
|                       | invoked.              |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1628} |                       |
|                       |                       |                       |
|                       | Suppose you are       |                       |
|                       | writing a function    |                       |
|                       | that works with Hand  |                       |
|                       | objects. You would    |                       |
|                       | like it to work with  |                       |
|                       | all kinds of Hands,   |                       |
|                       | like PokerHands,      |                       |
|                       | BridgeHands, etc. If  |                       |
|                       | you invoke a method   |                       |
|                       | like                  |                       |
|                       | [shuffle]{.c004}, you |                       |
|                       | might get the one     |                       |
|                       | defined in            |                       |
|                       | [Deck]{.c004}, but if |                       |
|                       | any of the subclasses |                       |
|                       | override this method, |                       |
|                       | you'll get that       |                       |
|                       | version instead. This |                       |
|                       | behavior is usually a |                       |
|                       | good thing, but it    |                       |
|                       | can be confusing.     |                       |
|                       |                       |                       |
|                       | Any time you are      |                       |
|                       | unsure about the flow |                       |
|                       | of execution through  |                       |
|                       | your program, the     |                       |
|                       | simplest solution is  |                       |
|                       | to add print          |                       |
|                       | statements at the     |                       |
|                       | beginning of the      |                       |
|                       | relevant methods. If  |                       |
|                       | [Deck.shuffle]{.c004} |                       |
|                       | prints a message that |                       |
|                       | says something like   |                       |
|                       | [Running              |                       |
|                       | Deck.shuffle]{.c004}, |                       |
|                       | then as the program   |                       |
|                       | runs it traces the    |                       |
|                       | flow of execution.    |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1629} |                       |
|                       |                       |                       |
|                       | As an alternative,    |                       |
|                       | you could use this    |                       |
|                       | function, which takes |                       |
|                       | an object and a       |                       |
|                       | method name (as a     |                       |
|                       | string) and returns   |                       |
|                       | the class that        |                       |
|                       | provides the          |                       |
|                       | definition of the     |                       |
|                       | method:               |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def find_defining_c   |                       | |                       | lass(obj, meth_name): |                       | |                       |     for t             |                       | |                       | y in type(obj).mro(): |                       | |                       |         if meth       |                       | |                       | _name in ty.__dict__: |                       | |                       |             return ty |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Here's an example:    |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; hand = Hand()     |                       | |                       | &gt;&gt;&gt; find_defining_c   |                       | |                       | lass(hand, 'shuffle') |                       | |                       | &lt;c                    |                       | |                       | lass '__main__.Deck'&gt; |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | So the                |                       |
|                       | [shuffle]{.c004}      |                       |
|                       | method for this Hand  |                       |
|                       | is the one in         |                       |
|                       | [Deck]{.c004}.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1630} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1631} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1632} |                       |
|                       |                       |                       |
|                       | <code>find_defining_class</code> |                       |
|                       | uses the [mro]{.c004} |                       |
|                       | method to get the     |                       |
|                       | list of class objects |                       |
|                       | (types) that will be  |                       |
|                       | searched for methods. |                       |
|                       | &quot;MRO&quot; stands for      |                       |
|                       | &quot;method resolution    |                       |
|                       | order&quot;, which is the  |                       |
|                       | sequence of classes   |                       |
|                       | Python searches to    |                       |
|                       | &quot;resolve&quot; a method    |                       |
|                       | name.                 |                       |
|                       |                       |                       |
|                       | Here's a design       |                       |
|                       | suggestion: when you  |                       |
|                       | override a method,    |                       |
|                       | the interface of the  |                       |
|                       | new method should be  |                       |
|                       | the same as the old.  |                       |
|                       | It should take the    |                       |
|                       | same parameters,      |                       |
|                       | return the same type, |                       |
|                       | and obey the same     |                       |
|                       | preconditions and     |                       |
|                       | postconditions. If    |                       |
|                       | you follow this rule, |                       |
|                       | you will find that    |                       |
|                       | any function designed |                       |
|                       | to work with an       |                       |
|                       | instance of a parent  |                       |
|                       | class, like a Deck,   |                       |
|                       | will also work with   |                       |
|                       | instances of child    |                       |
|                       | classes like a Hand   |                       |
|                       | and PokerHand.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1633} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1634} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1635} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1636} |                       |
|                       |                       |                       |
|                       | If you violate this   |                       |
|                       | rule, which is called |                       |
|                       | the &quot;Liskov           |                       |
|                       | substitution          |                       |
|                       | principle&quot;, your code |                       |
|                       | will collapse like    |                       |
|                       | (sorry) a house of    |                       |
|                       | cards.                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1637} |                       |
|                       |                       |                       |
|                       | ## 18                 |                       |
|                       | .10  Data encapsulati |                       |
|                       | on {#sec219 .section} |                       |
|                       |                       |                       |
|                       | The previous chapters |                       |
|                       | demonstrate a         |                       |
|                       | development plan we   |                       |
|                       | might call            |                       |
|                       | &quot;object-oriented      |                       |
|                       | design&quot;. We           |                       |
|                       | identified objects we |                       |
|                       | needed---like         |                       |
|                       | [Point]{.c004},       |                       |
|                       | [Rectangle]{.c004}    |                       |
|                       | and                   |                       |
|                       | [Time]{.c004}---and   |                       |
|                       | defined classes to    |                       |
|                       | represent them. In    |                       |
|                       | each case there is an |                       |
|                       | obvious               |                       |
|                       | correspondence        |                       |
|                       | between the object    |                       |
|                       | and some entity in    |                       |
|                       | the real world (or at |                       |
|                       | least a mathematical  |                       |
|                       | world).               |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1638} |                       |
|                       |                       |                       |
|                       | But sometimes it is   |                       |
|                       | less obvious what     |                       |
|                       | objects you need and  |                       |
|                       | how they should       |                       |
|                       | interact. In that     |                       |
|                       | case you need a       |                       |
|                       | different development |                       |
|                       | plan. In the same way |                       |
|                       | that we discovered    |                       |
|                       | function interfaces   |                       |
|                       | by encapsulation and  |                       |
|                       | generalization, we    |                       |
|                       | can discover class    |                       |
|                       | interfaces by [data   |                       |
|                       | e                     |                       |
|                       | ncapsulation]{.c010}. |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1639} |                       |
|                       |                       |                       |
|                       | Markov analysis, from |                       |
|                       | Se                    |                       |
|                       | ction [13.8](thinkpyt |                       |
|                       | hon2014.html#markov), |                       |
|                       | provides a good       |                       |
|                       | example. If you       |                       |
|                       | download my code from |                       |
|                       | [[http                |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/markov.py]{.c004} |                       |
|                       | ](https://thinkpython |                       |
|                       | .com/code/markov.py), |                       |
|                       | you'll see that it    |                       |
|                       | uses two global       |                       |
|                       | var                   |                       |
|                       | iables---<code>suffix_map</code> |                       |
|                       | and <code>prefix</code>---that   |                       |
|                       | are read and written  |                       |
|                       | from several          |                       |
|                       | functions.            |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | su                    |                       | |                       | ffix_map = {}         |                       | |                       | pr                    |                       | |                       | efix = ()             |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Because these         |                       |
|                       | variables are global, |                       |
|                       | we can only run one   |                       |
|                       | analysis at a time.   |                       |
|                       | If we read two texts, |                       |
|                       | their prefixes and    |                       |
|                       | suffixes would be     |                       |
|                       | added to the same     |                       |
|                       | data structures       |                       |
|                       | (which makes for some |                       |
|                       | interesting generated |                       |
|                       | text).                |                       |
|                       |                       |                       |
|                       | To run multiple       |                       |
|                       | analyses, and keep    |                       |
|                       | them separate, we can |                       |
|                       | encapsulate the state |                       |
|                       | of each analysis in   |                       |
|                       | an object. Here's     |                       |
|                       | what that looks like: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | class Markov:         |                       | |                       |                       |                       | |                       |                       |                       | |                       |   def __init__(self): |                       | |                       |                       |                       | |                       |  self.suffix_map = {} |                       | |                       |                       |                       | |                       |  self.prefix = ()     |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Next, we transform    |                       |
|                       | the functions into    |                       |
|                       | methods. For example, |                       |
|                       | here's                |                       |
|                       | <code>process_word</code>:       |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       |     def process_word( |                       | |                       | self, word, order=2): |                       | |                       |         if len(       |                       | |                       | self.prefix) &lt; order: |                       | |                       |             s         |                       | |                       | elf.prefix += (word,) |                       | |                       |             return    |                       | |                       |                       |                       | |                       |         try:          |                       | |                       |                       |                       | |                       |  self.suffix_map[self |                       | |                       | .prefix].append(word) |                       | |                       |                       |                       | |                       |      except KeyError: |                       | |                       |             # if t    |                       | |                       | here is no entry for  |                       | |                       | this prefix, make one |                       | |                       |                       |                       | |                       |      self.suffix_map[ |                       | |                       | self.prefix] = [word] |                       | |                       |                       |                       | |                       |         self          |                       | |                       | .prefix = shift(self. |                       | |                       | prefix, word)         |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Transforming a        |                       |
|                       | program like          |                       |
|                       | this---changing the   |                       |
|                       | design without        |                       |
|                       | changing the          |                       |
|                       | behavior---is another |                       |
|                       | example of            |                       |
|                       | refactoring (see      |                       |
|                       | Section               |                       |
|                       |  [4.7](thinkpython200 |                       |
|                       | 5.html#refactoring)). |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1640} |                       |
|                       |                       |                       |
|                       | This example suggests |                       |
|                       | a development plan    |                       |
|                       | for designing objects |                       |
|                       | and methods:          |                       |
|                       |                       |                       |
|                       | 1.  Start by writing  |                       |
|                       |     functions that    |                       |
|                       |     read and write    |                       |
|                       |     global variables  |                       |
|                       |     (when necessary). |                       |
|                       | 2.  Once you get the  |                       |
|                       |     program working,  |                       |
|                       |     look for          |                       |
|                       |     associations      |                       |
|                       |     between global    |                       |
|                       |     variables and the |                       |
|                       |     functions that    |                       |
|                       |     use them.         |                       |
|                       | 3.  Encapsulate       |                       |
|                       |     related variables |                       |
|                       |     as attributes of  |                       |
|                       |     an object.        |                       |
|                       | 4.  Transform the     |                       |
|                       |     associated        |                       |
|                       |     functions into    |                       |
|                       |     methods of the    |                       |
|                       |     new class.        |                       |
|                       |                       |                       |
|                       | As an exercise,       |                       |
|                       | download my Markov    |                       |
|                       | code from             |                       |
|                       | [[http                |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/markov.py]{.c004} |                       |
|                       | ](https://thinkpython |                       |
|                       | .com/code/markov.py), |                       |
|                       | and follow the steps  |                       |
|                       | described above to    |                       |
|                       | encapsulate the       |                       |
|                       | global variables as   |                       |
|                       | attributes of a new   |                       |
|                       | class called          |                       |
|                       | [Markov]{.c004}.      |                       |
|                       | Solution:             |                       |
|                       | [[https:              |                       |
|                       | //thinkpython.com/cod |                       |
|                       | e/markov2.py]{.c004}] |                       |
|                       | (https://thinkpython. |                       |
|                       | com/code/markov2.py). |                       |
|                       |                       |                       |
|                       | ## 18.11  Glossa      |                       |
|                       | ry {#sec220 .section} |                       |
|                       |                       |                       |
|                       | [encode:]{.c010}      |                       |
|                       | :   To represent one  |                       |
|                       |     set of values     |                       |
|                       |     using another set |                       |
|                       |     of values by      |                       |
|                       |     constructing a    |                       |
|                       |     mapping between   |                       |
|                       |     them.             |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1641} |                       |
|                       |                       |                       |
|                       | [cla                  |                       |
|                       | ss attribute:]{.c010} |                       |
|                       | :   An attribute      |                       |
|                       |     associated with a |                       |
|                       |     class object.     |                       |
|                       |     Class attributes  |                       |
|                       |     are defined       |                       |
|                       |     inside a class    |                       |
|                       |     definition but    |                       |
|                       |     outside any       |                       |
|                       |     method.           |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1642} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1643} |                       |
|                       |                       |                       |
|                       | [instan               |                       |
|                       | ce attribute:]{.c010} |                       |
|                       | :   An attribute      |                       |
|                       |     associated with   |                       |
|                       |     an instance of a  |                       |
|                       |     class.            |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1644} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1645} |                       |
|                       |                       |                       |
|                       | [veneer:]{.c010}      |                       |
|                       | :   A method or       |                       |
|                       |     function that     |                       |
|                       |     provides a        |                       |
|                       |     different         |                       |
|                       |     interface to      |                       |
|                       |     another function  |                       |
|                       |     without doing     |                       |
|                       |     much computation. |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1646} |                       |
|                       |                       |                       |
|                       | [inheritance:]{.c010} |                       |
|                       | :   The ability to    |                       |
|                       |     define a new      |                       |
|                       |     class that is a   |                       |
|                       |     modified version  |                       |
|                       |     of a previously   |                       |
|                       |     defined class.    |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1647} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | parent class:]{.c010} |                       |
|                       | :   The class from    |                       |
|                       |     which a child     |                       |
|                       |     class inherits.   |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1648} |                       |
|                       |                       |                       |
|                       | [child class:]{.c010} |                       |
|                       | :   A new class       |                       |
|                       |     created by        |                       |
|                       |     inheriting from   |                       |
|                       |     an existing       |                       |
|                       |     class; also       |                       |
|                       |     called a          |                       |
|                       |     &quot;subclass&quot;.       |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1649} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1650} |                       |
|                       |                       |                       |
|                       | [IS-A                 |                       |
|                       | relationship:]{.c010} |                       |
|                       | :   A relationship    |                       |
|                       |     between a child   |                       |
|                       |     class and its     |                       |
|                       |     parent class.     |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1651} |                       |
|                       |                       |                       |
|                       | [HAS-A                |                       |
|                       | relationship:]{.c010} |                       |
|                       | :   A relationship    |                       |
|                       |     between two       |                       |
|                       |     classes where     |                       |
|                       |     instances of one  |                       |
|                       |     class contain     |                       |
|                       |     references to     |                       |
|                       |     instances of the  |                       |
|                       |     other.            |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1652} |                       |
|                       |                       |                       |
|                       | [dependency:]{.c010}  |                       |
|                       | :   A relationship    |                       |
|                       |     between two       |                       |
|                       |     classes where     |                       |
|                       |     instances of one  |                       |
|                       |     class use         |                       |
|                       |     instances of the  |                       |
|                       |     other class, but  |                       |
|                       |     do not store them |                       |
|                       |     as attributes.    |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1653} |                       |
|                       |                       |                       |
|                       | [c                    |                       |
|                       | lass diagram:]{.c010} |                       |
|                       | :   A diagram that    |                       |
|                       |     shows the classes |                       |
|                       |     in a program and  |                       |
|                       |     the relationships |                       |
|                       |     between them.     |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1654} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1655} |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | multiplicity:]{.c010} |                       |
|                       | :   A notation in a   |                       |
|                       |     class diagram     |                       |
|                       |     that shows, for a |                       |
|                       |     HAS-A             |                       |
|                       |     relationship, how |                       |
|                       |     many references   |                       |
|                       |     there are to      |                       |
|                       |     instances of      |                       |
|                       |     another class.    |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1656} |                       |
|                       |                       |                       |
|                       | [data e               |                       |
|                       | ncapsulation:]{.c010} |                       |
|                       | :   A program         |                       |
|                       |     development plan  |                       |
|                       |     that involves a   |                       |
|                       |     prototype using   |                       |
|                       |     global variables  |                       |
|                       |     and a final       |                       |
|                       |     version that      |                       |
|                       |     makes the global  |                       |
|                       |     variables into    |                       |
|                       |     instance          |                       |
|                       |     attributes.       |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1657} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1658} |                       |
|                       |                       |                       |
|                       | ## 18.12  Exercis     |                       |
|                       | es {#sec221 .section} |                       |
|                       |                       |                       |
|                       | ::: theorem           |                       |
|                       | [Exercise 1]{.c010}   |                       |
|                       | <em>For the following    |                       |
|                       | program, draw a UML   |                       |
|                       | class diagram that    |                       |
|                       | shows these classes   |                       |
|                       | and the relationships |                       |
|                       | among them.</em>          |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | class PingPongParent: |                       | |                       |     pass              |                       | |                       |                       |                       | |                       | class                 |                       | |                       | Ping(PingPongParent): |                       | |                       |     def               |                       | |                       | __init__(self, pong): |                       | |                       |                       |                       | |                       |      self.pong = pong |                       | |                       |                       |                       | |                       |                       |                       | |                       | class                 |                       | |                       | Pong(PingPongParent): |                       | |                       |     def __init        |                       | |                       | __(self, pings=None): |                       | |                       |                       |                       | |                       |     if pings is None: |                       | |                       |                       |                       | |                       |       self.pings = [] |                       | |                       |         else:         |                       | |                       |                       |                       | |                       |    self.pings = pings |                       | |                       |                       |                       | |                       |     def               |                       | |                       | add_ping(self, ping): |                       | |                       |         se            |                       | |                       | lf.pings.append(ping) |                       | |                       |                       |                       | |                       | pong = Pong()         |                       | |                       | ping = Ping(pong)     |                       | |                       | pong.add_ping(ping)   |                       | |                       |</code>                   |                       |
|                       | :::                   |                       |
|                       |                       |                       |
|                       | ::: theorem           |                       |
|                       | [Exercise 2]{.c010}   |                       |
|                       | <em>Write a Deck method  |                       |
|                       | called <code>deal_hands</code>   |                       |
|                       | that takes two        |                       |
|                       | parameters, the       |                       |
|                       | number of hands and   |                       |
|                       | the number of cards   |                       |
|                       | per hand. It should   |                       |
|                       | create the            |                       |
|                       | appropriate number of |                       |
|                       | Hand objects, deal    |                       |
|                       | the appropriate       |                       |
|                       | number of cards per   |                       |
|                       | hand, and return a    |                       |
|                       | list of Hands.</em>       |                       |
|                       | :::                   |                       |
|                       |                       |                       |
|                       | ::: theorem           |                       |
|                       | [Exercise 3]{.c010}   |                       |
|                       | []{#poker}            |                       |
|                       |                       |                       |
|                       | <em>The following are    |                       |
|                       | the possible hands in |                       |
|                       | poker, in increasing  |                       |
|                       | order of value and    |                       |
|                       | decreasing order of   |                       |
|                       | probability:</em>         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1659} |                       |
|                       |                       |                       |
|                       | <em>[pair:]{.c010}</em>      |                       |
|                       | :   <em>two cards with   |                       |
|                       |     the same rank</em>    |                       |
|                       |                       |                       |
|                       | [<em>two pair:</em>]{.c010}  |                       |
|                       | :   <em>two pairs of     |                       |
|                       |     cards with the    |                       |
|                       |     same rank</em>        |                       |
|                       |                       |                       |
|                       | [<em>thre                |                       |
|                       | e of a kind:</em>]{.c010} |                       |
|                       | :   <em>three cards with |                       |
|                       |     the same rank</em>    |                       |
|                       |                       |                       |
|                       | [<em>straight:</em>]{.c010}  |                       |
|                       | :   <em>five cards with  |                       |
|                       |     ranks in sequence |                       |
|                       |     (aces can be high |                       |
|                       |     or low, so        |                       |
|                       |                       |                       |
|                       |  [Ace-2-3-4-5]{.c004} |                       |
|                       |     is a straight and |                       |
|                       |     so is             |                       |
|                       |     [10-Jack-Qu       |                       |
|                       | een-King-Ace]{.c004}, |                       |
|                       |     but               |                       |
|                       |     [Queen            |                       |
|                       | -King-Ace-2-3]{.c004} |                       |
|                       |     is not.)</em>         |                       |
|                       |                       |                       |
|                       | [<em>flush:</em>]{.c010}     |                       |
|                       | :   <em>five cards with  |                       |
|                       |     the same suit</em>    |                       |
|                       |                       |                       |
|                       | [                     |                       |
|                       | <em>full house:</em>]{.c010} |                       |
|                       | :   <em>three cards with |                       |
|                       |     one rank, two     |                       |
|                       |     cards with        |                       |
|                       |     another</em>          |                       |
|                       |                       |                       |
|                       | [<em>fou                 |                       |
|                       | r of a kind:</em>]{.c010} |                       |
|                       | :   <em>four cards with  |                       |
|                       |     the same rank</em>    |                       |
|                       |                       |                       |
|                       | [<em>str                 |                       |
|                       | aight flush:</em>]{.c010} |                       |
|                       | :   <em>five cards in    |                       |
|                       |     sequence (as      |                       |
|                       |     defined above)    |                       |
|                       |     and with the same |                       |
|                       |     suit</em>             |                       |
|                       |                       |                       |
|                       | <em>The goal of these    |                       |
|                       | exercises is to       |                       |
|                       | estimate the          |                       |
|                       | probability of        |                       |
|                       | drawing these various |                       |
|                       | hands.</em>               |                       |
|                       |                       |                       |
|                       | 1.  <em>Download the     |                       |
|                       |     following files   |                       |
|                       |     from</em>             |                       |
|                       |     [<em>[https://       |                       |
|                       | thinkpython.com/code] |                       |
|                       | {.c004}</em>](https://thi |                       |
|                       | nkpython.com/code)<em>:</em> |                       |
|                       |                       |                       |
|                       |                       |                       |
|                       |    [<em>Card.py</em>]{.c005} |                       |
|                       |     :   <em>: A complete |                       |
|                       |         version of    |                       |
|                       |         the           |                       |
|                       |                       |                       |
|                       |        [Card]{.c004}, |                       |
|                       |         [Deck]{.c004} |                       |
|                       |         and           |                       |
|                       |         [Hand]{.c004} |                       |
|                       |         classes in    |                       |
|                       |         this          |                       |
|                       |         chapter.</em>     |                       |
|                       |                       |                       |
|                       |     [*                |                       |
|                       | PokerHand.py*]{.c005} |                       |
|                       |     :   <em>: An         |                       |
|                       |         incomplete    |                       |
|                       |                       |                       |
|                       |        implementation |                       |
|                       |         of a class    |                       |
|                       |         that          |                       |
|                       |         represents a  |                       |
|                       |         poker hand,   |                       |
|                       |         and some code |                       |
|                       |         that tests    |                       |
|                       |         it.</em>          |                       |
|                       | 2.  <em>If you run       |                       |
|                       |     [                 |                       |
|                       | PokerHand.py]{.c004}, |                       |
|                       |     it deals seven    |                       |
|                       |     7-card poker      |                       |
|                       |     hands and checks  |                       |
|                       |     to see if any of  |                       |
|                       |     them contains a   |                       |
|                       |     flush. Read this  |                       |
|                       |     code carefully    |                       |
|                       |     before you go     |                       |
|                       |     on.</em>              |                       |
|                       | 3.  <em>Add methods to   |                       |
|                       |                       |                       |
|                       | [PokerHand.py]{.c004} |                       |
|                       |     named <code>has_pair</code>, |                       |
|                       |     <code>has_twopair</code>,    |                       |
|                       |     etc. that return  |                       |
|                       |     True or False     |                       |
|                       |     according to      |                       |
|                       |     whether or not    |                       |
|                       |     the hand meets    |                       |
|                       |     the relevant      |                       |
|                       |     criteria. Your    |                       |
|                       |     code should work  |                       |
|                       |     correctly for     |                       |
|                       |     &quot;hands&quot; that      |                       |
|                       |     contain any       |                       |
|                       |     number of cards   |                       |
|                       |     (although 5 and 7 |                       |
|                       |     are the most      |                       |
|                       |     common sizes).</em>   |                       |
|                       | 4.  <em>Write a method   |                       |
|                       |     named             |                       |
|                       |     [classify]{.c004} |                       |
|                       |     that figures out  |                       |
|                       |     the highest-value |                       |
|                       |     classification    |                       |
|                       |     for a hand and    |                       |
|                       |     sets the          |                       |
|                       |     [label]{.c004}    |                       |
|                       |     attribute         |                       |
|                       |     accordingly. For  |                       |
|                       |     example, a 7-card |                       |
|                       |     hand might        |                       |
|                       |     contain a flush   |                       |
|                       |     and a pair; it    |                       |
|                       |     should be labeled |                       |
|                       |     &quot;flush&quot;.</em>         |                       |
|                       | 5.  <em>When you are     |                       |
|                       |     convinced that    |                       |
|                       |     your              |                       |
|                       |     classification    |                       |
|                       |     methods are       |                       |
|                       |     working, the next |                       |
|                       |     step is to        |                       |
|                       |     estimate the      |                       |
|                       |     probabilities of  |                       |
|                       |     the various       |                       |
|                       |     hands. Write a    |                       |
|                       |     function in       |                       |
|                       |                       |                       |
|                       | [PokerHand.py]{.c004} |                       |
|                       |     that shuffles a   |                       |
|                       |     deck of cards,    |                       |
|                       |     divides it into   |                       |
|                       |     hands, classifies |                       |
|                       |     the hands, and    |                       |
|                       |     counts the number |                       |
|                       |     of times various  |                       |
|                       |     classifications   |                       |
|                       |     appear.</em>          |                       |
|                       | 6.  <em>Print a table of |                       |
|                       |     the               |                       |
|                       |     classifications   |                       |
|                       |     and their         |                       |
|                       |     probabilities.    |                       |
|                       |     Run your program  |                       |
|                       |     with larger and   |                       |
|                       |     larger numbers of |                       |
|                       |     hands until the   |                       |
|                       |     output values     |                       |
|                       |     converge to a     |                       |
|                       |     reasonable degree |                       |
|                       |     of accuracy.      |                       |
|                       |     Compare your      |                       |
|                       |     results to the    |                       |
|                       |     values at</em>        |                       |
|                       |                       |                       |
|                       |    [[<em>http://en.wikip |                       |
|                       | edia.org/wiki/Hand_ra |                       |
|                       | nkings</em>]{.c004}](http |                       |
|                       | ://en.wikipedia.org/w |                       |
|                       | iki/Hand_rankings)<em>.</em> |                       |
|                       |                       |                       |
|                       | <em>Solution:</em>           |                       |
|                       | [<em>[                   |                       |
|                       | https://thinkpython.c |                       |
|                       | om/code/PokerHandSoln |                       |
|                       | .py]{.c004}</em>](https:/ |                       |
|                       | /thinkpython.com/code |                       |
|                       | /PokerHandSoln.py)<em>.</em> |                       |
|                       | :::                   |                       |
|                       |                       |                       |
|                       | [Buy this book at     |                       |
|                       | Amazon.com](ht        |                       |
|                       | tp://amzn.to/1VUYQUU) |                       |
+-----------------------+-----------------------+-----------------------+</p>
<hr />
<h2><a href="thinkpython2018.html"><img src="back.png" alt="Previous" /></a>
<a href="index.html"><img src="up.png" alt="Up" /></a> <a href="thinkpython2020.html"><img src="next.png" alt="Next" /></a></h2>
<h2>generator: hevea 2.32
title: The Goodies</h2>
<p><a href="thinkpython2019.html"><img src="back.png" alt="Previous" /></a>
<a href="index.html"><img src="up.png" alt="Up" /></a> <a href="thinkpython2021.html"><img src="next.png" alt="Next" /></a></p>
<hr />
<p>+-----------------------+-----------------------+-----------------------+
|                       | [Buy this book at     | #### Contribute       |
|                       | Amazon.com](ht        |                       |
|                       | tp://amzn.to/1VUYQUU) | If you would like to  |
|                       |                       | make a contribution   |
|                       | #                     | to support my books,  |
|                       | Chapter 19  The Goodi | you can use the       |
|                       | es {#sec222 .chapter} | button below and pay  |
|                       |                       | with PayPal. Thank    |
|                       | One of my goals for   | you!                  |
|                       | this book has been to |                       |
|                       | teach you as little   |   -----------         |
|                       | Python as possible.   | --------------------- |
|                       | When there were two   | --------------------- |
|                       | ways to do something, | --------------------- |
|                       | I picked one and      | --------------------- |
|                       | avoided mentioning    |   Pay what you want:  |
|                       | the other. Or         |   Small $1           |
|                       | sometimes I put the   | .00 USD Medium $5.00 |
|                       | second one into an    |  USD Large $10.00 US |
|                       | exercise.             | D X-Large $20.00 USD |
|                       |                       |  XX-Large $50.00 USD |
|                       | Now I want to go back |   -----------         |
|                       | for some of the good  | --------------------- |
|                       | bits that got left    | --------------------- |
|                       | behind. Python        | --------------------- |
|                       | provides a number of  | --------------------- |
|                       | features that are not |                       |
|                       | really                | ![](                  |
|                       | necessary---you can   | https://www.paypalobj |
|                       | write good code       | ects.com/en_US/i/scr/ |
|                       | without them---but    | pixel.gif){border=&quot;0&quot; |
|                       | with them you can     | width=&quot;1&quot; height=&quot;1&quot;} |
|                       | sometimes write code  |                       |
|                       | that's more concise,  | ####                  |
|                       | readable or           | Are you using one of  |
|                       | efficient, and        | our books in a class? |
|                       | sometimes all three.  |                       |
|                       |                       | We'd like to know    |
|                       | ## 19.1               | about it. Please      |
|                       | Conditional expressio | consider filling out  |
|                       | ns {#sec223 .section} | [this short           |
|                       |                       | survey](http://s      |
|                       | We saw conditional    | preadsheets.google.co |
|                       | statements in         | m/viewform?formkey=dC |
|                       | Section [5.4](th      | 0tNUZkMjBEdXVoRGljNm9 |
|                       | inkpython2006.html#co | FRmlTMHc6MA){onclick= |
|                       | nditional.execution). | &quot;javascript: pageTrac |
|                       | Conditional           | ker._trackPageview('/ |
|                       | statements are often  | outbound/survey');&quot;}. |
|                       | used to choose one of |                       |
|                       | two values; for       | \                     |
|                       | example:              |                       |
|                       | [                     | [Think                |
|                       | ]{#hevea_default1660} | DSP](http             |
|                       | [                     | ://www.amazon.com/gp/ |
|                       | ]{#hevea_default1661} | product/1491938455/re |
|                       |                       | f=as_li_tl?ie=UTF8&amp;ca |
|                       | <code>verbatim          | mp=1789&amp;creative=9325 | |                       | if x &gt; 0:             | &amp;creativeASIN=1491938 | |                       |     y = math.log(x)   | 455&amp;linkCode=as2&amp;tag= | |                       | else:                 | greenteapre01-20&amp;link | |                       |     y = float('nan')  | Id=2JJH4SWCAVVYSQHO){ | |                       |</code>                   | rel=&quot;nofollow&quot;}![](ht |
|                       |                       | tp://ir-na.amazon-ads |
|                       | This statement checks | ystem.com/e/ir?t=gree |
|                       | whether [x]{.c004} is | nteapre01-20&amp;l=as2&amp;o= |
|                       | positive. If so, it   | 1&amp;a=1491938455){.c003 |
|                       | computes              | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | [math.log]{.c004}. If | border=&quot;0&quot;}           |
|                       | not,                  |                       |
|                       | [math.log]{.c004}     | [                     |
|                       | would raise a         | ![](http://ws-na.amaz |
|                       | ValueError. To avoid  | on-adsystem.com/widge |
|                       | stopping the program, | ts/q?_encoding=UTF8&amp;A |
|                       | we generate a &quot;NaN&quot;,  | SIN=1491938455&amp;Format |
|                       | which is a special    | =<em>SL160</em>&amp;ID=AsinImage |
|                       | floating-point value  | &amp;MarketPlace=US&amp;Servi |
|                       | that represents &quot;Not  | ceVersion=20070822&amp;WS |
|                       | a Number&quot;.            | =1&amp;tag=greenteapre01- |
|                       | [                     | 20){border=&quot;0&quot;}](http |
|                       | ]{#hevea_default1662} | ://www.amazon.com/gp/ |
|                       | [                     | product/1491938455/re |
|                       | ]{#hevea_default1663} | f=as_li_tl?ie=UTF8&amp;ca |
|                       |                       | mp=1789&amp;creative=9325 |
|                       | We can write this     | &amp;creativeASIN=1491938 |
|                       | statement more        | 455&amp;linkCode=as2&amp;tag= |
|                       | concisely using a     | greenteapre01-20&amp;link |
|                       | [conditional          | Id=CTV7PDT7E5EGGJUM){ |
|                       | expression]{.c010}:   | rel=&quot;nofollow&quot;}![](ht |
|                       |                       | tp://ir-na.amazon-ads |
|                       | <code>verbatim          | ystem.com/e/ir?t=gree | |                       | y = math.log(x) if x  | nteapre01-20&amp;l=as2&amp;o= | |                       | &gt; 0 else float('nan') | 1&amp;a=1491938455){.c003 | |                       |</code>                   | width=&quot;1&quot; height=&quot;1&quot;  |
|                       |                       | border=&quot;0&quot;}           |
|                       | You can almost read   |                       |
|                       | this line like        | [Think                |
|                       | English: &quot;[y]{.c004}  | Java](http            |
|                       | gets log-[x]{.c004}   | ://www.amazon.com/gp/ |
|                       | if [x]{.c004} is      | product/1491929561/re |
|                       | greater than 0;       | f=as_li_tl?ie=UTF8&amp;ca |
|                       | otherwise it gets     | mp=1789&amp;creative=9325 |
|                       | NaN&quot;.                 | &amp;creativeASIN=1491929 |
|                       |                       | 561&amp;linkCode=as2&amp;tag= |
|                       | Recursive functions   | greenteapre01-20&amp;link |
|                       | can sometimes be      | Id=ZY6MAYM33ZTNSCNZ){ |
|                       | rewritten using       | rel=&quot;nofollow&quot;}![](ht |
|                       | conditional           | tp://ir-na.amazon-ads |
|                       | expressions. For      | ystem.com/e/ir?t=gree |
|                       | example, here is a    | nteapre01-20&amp;l=as2&amp;o= |
|                       | recursive version of  | 1&amp;a=1491929561){.c003 |
|                       | [factorial]{.c004}:   | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | [                     | border=&quot;0&quot;}           |
|                       | ]{#hevea_default1664} |                       |
|                       | [                     | [                     |
|                       | ]{#hevea_default1665} | ![](http://ws-na.amaz |
|                       |                       | on-adsystem.com/widge |
|                       | <code>verbatim          | ts/q?_encoding=UTF8&amp;A | |                       | def factorial(n):     | SIN=1491929561&amp;Format | |                       |     if n == 0:        | =_SL160_&amp;ID=AsinImage | |                       |         return 1      | &amp;MarketPlace=US&amp;Servi | |                       |     else:             | ceVersion=20070822&amp;WS | |                       |         retu          | =1&amp;tag=greenteapre01- | |                       | rn n * factorial(n-1) | 20){border=&quot;0&quot;}](http | |                       |</code>                   | ://www.amazon.com/gp/ |
|                       |                       | product/1491929561/re |
|                       | We can rewrite it     | f=as_li_tl?ie=UTF8&amp;ca |
|                       | like this:            | mp=1789&amp;creative=9325 |
|                       |                       | &amp;creativeASIN=1491929 |
|                       | <code>verbatim          | 561&amp;linkCode=as2&amp;tag= | |                       | def factorial(n):     | greenteapre01-20&amp;link | |                       |                       | Id=PT77ANWARUNNU3UK){ | |                       | return 1 if n == 0 el | rel=&quot;nofollow&quot;}![](ht | |                       | se n * factorial(n-1) | tp://ir-na.amazon-ads | |                       |</code>                   | ystem.com/e/ir?t=gree |
|                       |                       | nteapre01-20&amp;l=as2&amp;o= |
|                       | Another use of        | 1&amp;a=1491929561){.c003 |
|                       | conditional           | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | expressions is        | border=&quot;0&quot;}           |
|                       | handling optional     |                       |
|                       | arguments. For        | [Think                |
|                       | example, here is the  | Bay                   |
|                       | init method from      | es](http://www.amazon |
|                       | [GoodKangaroo]{.c004} | .com/gp/product/14493 |
|                       | (see                  | 70780/ref=as_li_qf_sp |
|                       | Exe                   | _asin_tl?ie=UTF8&amp;camp |
|                       | rcise [2](thinkpython | =1789&amp;creative=9325&amp;c |
|                       | 2018.html#kangaroo)): | reativeASIN=144937078 |
|                       | [                     | 0&amp;linkCode=as2&amp;tag=gr |
|                       | ]{#hevea_default1666} | eenteapre01-20)![](ht |
|                       | [                     | tp://ir-na.amazon-ads |
|                       | ]{#hevea_default1667} | ystem.com/e/ir?t=gree |
|                       |                       | nteapre01-20&amp;l=as2&amp;o= |
|                       | <code>verbatim          | 1&amp;a=1449370780){.c003 | |                       |                       | width=&quot;1&quot; height=&quot;1&quot;  | |                       |   def __init__(self,  | border=&quot;0&quot;}           | |                       | name, contents=None): |                       | |                       |                       | [![](http://ws        | |                       |      self.name = name | -na.amazon-adsystem.c | |                       |                       | om/widgets/q?_encodin | |                       |  if contents == None: | g=UTF8&amp;ASIN=144937078 | |                       |                       | 0&amp;Format=_SL160_&amp;ID=A | |                       |         contents = [] | sinImage&amp;MarketPlace= | |                       |         self.pouc     | US&amp;ServiceVersion=200 | |                       | h_contents = contents | 70822&amp;WS=1&amp;tag=greent | |                       |</code>                   | eapre01-20){border=&quot;0 |
|                       |                       | &quot;}](http://www.amazon |
|                       | We can rewrite this   | .com/gp/product/14493 |
|                       | one like this:        | 70780/ref=as_li_qf_sp |
|                       |                       | <em>asin_il?ie=UTF8&amp;camp |
|                       | <code>verbatim          | =1789&amp;creative=9325&amp;c | |                       |                       | reativeASIN=144937078 | |                       |   def __init__(self,  | 0&amp;linkCode=as2&amp;tag=gr | |                       | name, contents=None): | eenteapre01-20)![](ht | |                       |                       | tp://ir-na.amazon-ads | |                       |      self.name = name | ystem.com/e/ir?t=gree | |                       |                       | nteapre01-20&amp;l=as2&amp;o= | |                       |     self.pouch_conten | 1&amp;a=1449370780){.c003 | |                       | ts = [] if contents = | width=&quot;1&quot; height=&quot;1&quot;  | |                       | = None else contents  | border=&quot;0&quot;}           | |                       |</code>                   |                       |
|                       |                       | [Think Python         |
|                       | In general, you can   | 2e](http              |
|                       | replace a conditional | ://www.amazon.com/gp/ |
|                       | statement with a      | product/1491939362/re |
|                       | conditional           | f=as_li_tl?ie=UTF8&amp;ca |
|                       | expression if both    | mp=1789&amp;creative=9325 |
|                       | branches contain      | &amp;creativeASIN=1491939 |
|                       | simple expressions    | 362&amp;linkCode=as2&amp;tag= |
|                       | that are either       | greenteapre01-20&amp;link |
|                       | returned or assigned  | Id=FJKSQ3IHEMY2F2VA){ |
|                       | to the same variable. | rel=&quot;nofollow&quot;}![](ht |
|                       | [                     | tp://ir-na.amazon-ads |
|                       | ]{#hevea_default1668} | ystem.com/e/ir?t=gree |
|                       | [                     | nteapre01-20&amp;l=as2&amp;o= |
|                       | ]{#hevea_default1669} | 1&amp;a=1491939362){.c003 |
|                       |                       | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | ## 19                 | border=&quot;0&quot;}           |
|                       | .2  List comprehensio |                       |
|                       | ns {#sec224 .section} | [                     |
|                       |                       | ![](http://ws-na.amaz |
|                       | In                    | on-adsystem.com/widge |
|                       | S                     | ts/q?<em>encoding=UTF8&amp;A |
|                       | ection [10.7](thinkpy | SIN=1491939362&amp;Format |
|                       | thon2011.html#filter) | =<em>SL160</em>&amp;ID=AsinImage |
|                       | we saw the map and    | &amp;MarketPlace=US&amp;Servi |
|                       | filter patterns. For  | ceVersion=20070822&amp;WS |
|                       | example, this         | =1&amp;tag=greenteapre01- |
|                       | function takes a list | 20){border=&quot;0&quot;}](http |
|                       | of strings, maps the  | ://www.amazon.com/gp/ |
|                       | string method         | product/1491939362/re |
|                       | [capitalize]{.c004}   | f=as_li_tl?ie=UTF8&amp;ca |
|                       | to the elements, and  | mp=1789&amp;creative=9325 |
|                       | returns a new list of | &amp;creativeASIN=1491939 |
|                       | strings:              | 362&amp;linkCode=as2&amp;tag= |
|                       |                       | greenteapre01-20&amp;link |
|                       | <code>verbatim          | Id=ZZ454DLQ3IXDHNHX){ | |                       | d                     | rel=&quot;nofollow&quot;}![](ht | |                       | ef capitalize_all(t): | tp://ir-na.amazon-ads | |                       |     res = []          | ystem.com/e/ir?t=gree | |                       |     for s in t:       | nteapre01-20&amp;l=as2&amp;o= | |                       |         res.a         | 1&amp;a=1491939362){.c003 | |                       | ppend(s.capitalize()) | width=&quot;1&quot; height=&quot;1&quot;  | |                       |     return res        | border=&quot;0&quot;}           | |                       |</code>                   |                       |
|                       |                       | [Think Stats          |
|                       | We can write this     | 2e](http://ww         |
|                       | more concisely using  | w.amazon.com/gp/produ |
|                       | a [list               | ct/1491907339/ref=as</em> |
|                       | c                     | li_tl?ie=UTF8&amp;camp=17 |
|                       | omprehension]{.c010}: | 89&amp;creative=9325&amp;crea |
|                       | [                     | tiveASIN=1491907339&amp;l |
|                       | ]{#hevea_default1670} | inkCode=as2&amp;tag=green |
|                       |                       | teapre01-20&amp;linkId=O7 |
|                       | <code>verbatim          | WYM6H6YBYUFNWU)![](ht | |                       | d                     | tp://ir-na.amazon-ads | |                       | ef capitalize_all(t): | ystem.com/e/ir?t=gree | |                       |     return [s.cap     | nteapre01-20&amp;l=as2&amp;o= | |                       | italize() for s in t] | 1&amp;a=1491907339){.c003 | |                       |</code>                   | width=&quot;1&quot; height=&quot;1&quot;  |
|                       |                       | border=&quot;0&quot;}           |
|                       | The bracket operators |                       |
|                       | indicate that we are  | [![](h                |
|                       | constructing a new    | ttp://ws-na.amazon-ad |
|                       | list. The expression  | system.com/widgets/q? |
|                       | inside the brackets   | <em>encoding=UTF8&amp;ASIN=1 |
|                       | specifies the         | 491907339&amp;Format=<em>SL1 |
|                       | elements of the list, | 60</em>&amp;ID=AsinImage&amp;Mark |
|                       | and the [for]{.c004}  | etPlace=US&amp;ServiceVer |
|                       | clause indicates what | sion=20070822&amp;WS=1&amp;ta |
|                       | sequence we are       | g=greenteapre01-20){b |
|                       | traversing.           | order=&quot;0&quot;}](http://ww |
|                       | [                     | w.amazon.com/gp/produ |
|                       | ]{#hevea_default1671} | ct/1491907339/ref=as</em> |
|                       | [                     | li_tl?ie=UTF8&amp;camp=17 |
|                       | ]{#hevea_default1672} | 89&amp;creative=9325&amp;crea |
|                       |                       | tiveASIN=1491907339&amp;l |
|                       | The syntax of a list  | inkCode=as2&amp;tag=green |
|                       | comprehension is a    | teapre01-20&amp;linkId=JV |
|                       | little awkward        | SYKQHYSUIEYRHL)![](ht |
|                       | because the loop      | tp://ir-na.amazon-ads |
|                       | variable, [s]{.c004}  | ystem.com/e/ir?t=gree |
|                       | in this example,      | nteapre01-20&amp;l=as2&amp;o= |
|                       | appears in the        | 1&amp;a=1491907339){.c003 |
|                       | expression before we  | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | get to the            | border=&quot;0&quot;}           |
|                       | definition.           |                       |
|                       | [                     | [Think                |
|                       | ]{#hevea_default1673} | Complexity](http      |
|                       |                       | ://www.amazon.com/gp/ |
|                       | List comprehensions   | product/1449314635/re |
|                       | can also be used for  | f=as_li_tf_tl?ie=UTF8 |
|                       | filtering. For        | &amp;tag=greenteapre01-20 |
|                       | example, this         | &amp;linkCode=as2&amp;camp=17 |
|                       | function selects only | 89&amp;creative=9325&amp;crea |
|                       | the elements of       | tiveASIN=1449314635)! |
|                       | [t]{.c004} that are   | [](http://www.assoc-a |
|                       | upper case, and       | mazon.com/e/ir?t=gree |
|                       | returns a new list:   | nteapre01-20&amp;l=as2&amp;o= |
|                       | [                     | 1&amp;a=1449314635){.c003 |
|                       | ]{#hevea_default1674} | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | [                     | border=&quot;0&quot;}           |
|                       | ]{#hevea_default1675} |                       |
|                       |                       | [                     |
|                       | <code>verbatim          | ![](http://ws-na.amaz | |                       | def only_upper(t):    | on-adsystem.com/widge | |                       |     res = []          | ts/q?_encoding=UTF8&amp;A | |                       |     for s in t:       | SIN=1449314635&amp;Format | |                       |                       | =_SL160_&amp;ID=AsinImage | |                       |       if s.isupper(): | &amp;MarketPlace=US&amp;Servi | |                       |                       | ceVersion=20070822&amp;WS | |                       |         res.append(s) | =1&amp;tag=greenteapre01- | |                       |     return res        | 20){border=&quot;0&quot;}](http | |                       |</code>                   | ://www.amazon.com/gp/ |
|                       |                       | product/1449314635/re |
|                       | We can rewrite it     | f=as_li_tf_il?ie=UTF8 |
|                       | using a list          | &amp;camp=1789&amp;creative=9 |
|                       | comprehension         | 325&amp;creativeASIN=1449 |
|                       |                       | 314635&amp;linkCode=as2&amp;t |
|                       | <code>verbatim          | ag=greenteapre01-20)! | |                       | def only_upper(t):    | [](http://www.assoc-a | |                       |     return [s for s   | mazon.com/e/ir?t=gree | |                       |  in t if s.isupper()] | nteapre01-20&amp;l=as2&amp;o= | |                       |</code>                   | 1&amp;a=1449314635){.c003 |
|                       |                       | width=&quot;1&quot; height=&quot;1&quot;  |
|                       | List comprehensions   | border=&quot;0&quot;}           |
|                       | are concise and easy  |                       |
|                       | to read, at least for |                       |
|                       | simple expressions.   |                       |
|                       | And they are usually  |                       |
|                       | faster than the       |                       |
|                       | equivalent for loops, |                       |
|                       | sometimes much        |                       |
|                       | faster. So if you are |                       |
|                       | mad at me for not     |                       |
|                       | mentioning them       |                       |
|                       | earlier, I            |                       |
|                       | understand.           |                       |
|                       |                       |                       |
|                       | But, in my defense,   |                       |
|                       | list comprehensions   |                       |
|                       | are harder to debug   |                       |
|                       | because you can't put |                       |
|                       | a print statement     |                       |
|                       | inside the loop. I    |                       |
|                       | suggest that you use  |                       |
|                       | them only if the      |                       |
|                       | computation is simple |                       |
|                       | enough that you are   |                       |
|                       | likely to get it      |                       |
|                       | right the first time. |                       |
|                       | And for beginners     |                       |
|                       | that means never.     |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1676} |                       |
|                       |                       |                       |
|                       | ## 19.3               |                       |
|                       |   Generator expressio |                       |
|                       | ns {#sec225 .section} |                       |
|                       |                       |                       |
|                       | [Generator            |                       |
|                       | expressions]{.c010}   |                       |
|                       | are similar to list   |                       |
|                       | comprehensions, but   |                       |
|                       | with parentheses      |                       |
|                       | instead of square     |                       |
|                       | brackets:             |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1677} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1678} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; g = (x*           |                       | |                       | *2 for x in range(5)) |                       | |                       | &gt;&gt;&gt; g                 |                       | |                       | &lt;gen                  |                       | |                       | erator object &lt;genexp |                       | |                       | r&gt; at 0x7f4c45a786c0&gt; |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The result is a       |                       |
|                       | generator object that |                       |
|                       | knows how to iterate  |                       |
|                       | through a sequence of |                       |
|                       | values. But unlike a  |                       |
|                       | list comprehension,   |                       |
|                       | it does not compute   |                       |
|                       | the values all at     |                       |
|                       | once; it waits to be  |                       |
|                       | asked. The built-in   |                       |
|                       | function              |                       |
|                       | [next]{.c004} gets    |                       |
|                       | the next value from   |                       |
|                       | the generator:        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1679} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1680} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; next(g)           |                       | |                       | 0                     |                       | |                       | &gt;&gt;&gt; next(g)           |                       | |                       | 1                     |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When you get to the   |                       |
|                       | end of the sequence,  |                       |
|                       | [next]{.c004} raises  |                       |
|                       | a StopIteration       |                       |
|                       | exception. You can    |                       |
|                       | also use a            |                       |
|                       | [for]{.c004} loop to  |                       |
|                       | iterate through the   |                       |
|                       | values:               |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1681} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1682} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; for val in g:     |                       | |                       | ...     print(val)    |                       | |                       | 4                     |                       | |                       | 9                     |                       | |                       | 16                    |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The generator object  |                       |
|                       | keeps track of where  |                       |
|                       | it is in the          |                       |
|                       | sequence, so the      |                       |
|                       | [for]{.c004} loop     |                       |
|                       | picks up where        |                       |
|                       | [next]{.c004} left    |                       |
|                       | off. Once the         |                       |
|                       | generator is          |                       |
|                       | exhausted, it         |                       |
|                       | continues to raise    |                       |
|                       | [S                    |                       |
|                       | topIteration]{.c004}: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; next(g)           |                       | |                       | StopIteration         |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Generator expressions |                       |
|                       | are often used with   |                       |
|                       | functions like        |                       |
|                       | [sum]{.c004},         |                       |
|                       | [max]{.c004}, and     |                       |
|                       | [min]{.c004}:         |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1683} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1684} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; sum(x*            |                       | |                       | *2 for x in range(5)) |                       | |                       | 30                    |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | ## 19.4  [any]{       |                       |
|                       | .c004} and [all]{.c00 |                       |
|                       | 4} {#sec226 .section} |                       |
|                       |                       |                       |
|                       | Python provides a     |                       |
|                       | built-in function,    |                       |
|                       | [any]{.c004}, that    |                       |
|                       | takes a sequence of   |                       |
|                       | boolean values and    |                       |
|                       | returns [True]{.c004} |                       |
|                       | if any of the values  |                       |
|                       | are [True]{.c004}. It |                       |
|                       | works on lists:       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1685} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1686} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; any(              |                       | |                       | [False, False, True]) |                       | |                       | True                  |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | But it is often used  |                       |
|                       | with generator        |                       |
|                       | expressions:          |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1687} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1688} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;                    |                       | |                       | &gt; any(letter == 't' f |                       | |                       | or letter in 'monty') |                       | |                       | True                  |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | That example isn't    |                       |
|                       | very useful because   |                       |
|                       | it does the same      |                       |
|                       | thing as the          |                       |
|                       | [in]{.c004} operator. |                       |
|                       | But we could use      |                       |
|                       | [any]{.c004} to       |                       |
|                       | rewrite some of the   |                       |
|                       | search functions we   |                       |
|                       | wrote in              |                       |
|                       | S                     |                       |
|                       | ection [9.3](thinkpyt |                       |
|                       | hon2010.html#search). |                       |
|                       | For example, we could |                       |
|                       | write [avoids]{.c004} |                       |
|                       | like this:            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1689} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1690} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def avo               |                       | |                       | ids(word, forbidden): |                       | |                       |     return not a      |                       | |                       | ny(letter in forbidde |                       | |                       | n for letter in word) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The function almost   |                       |
|                       | reads like English,   |                       |
|                       | &quot;[word]{.c004} avoids |                       |
|                       | [forbidden]{.c004} if |                       |
|                       | there are not any     |                       |
|                       | forbidden letters in  |                       |
|                       | [word]{.c004}.&quot;       |                       |
|                       |                       |                       |
|                       | Using [any]{.c004}    |                       |
|                       | with a generator      |                       |
|                       | expression is         |                       |
|                       | efficient because it  |                       |
|                       | stops immediately if  |                       |
|                       | it finds a            |                       |
|                       | [True]{.c004} value,  |                       |
|                       | so it doesn't have to |                       |
|                       | evaluate the whole    |                       |
|                       | sequence.             |                       |
|                       |                       |                       |
|                       | Python provides       |                       |
|                       | another built-in      |                       |
|                       | function,             |                       |
|                       | [all]{.c004}, that    |                       |
|                       | returns [True]{.c004} |                       |
|                       | if every element of   |                       |
|                       | the sequence is       |                       |
|                       | [True]{.c004}. As an  |                       |
|                       | exercise, use         |                       |
|                       | [all]{.c004} to       |                       |
|                       | re-write <code>uses_all</code>   |                       |
|                       | from                  |                       |
|                       | S                     |                       |
|                       | ection [9.3](thinkpyt |                       |
|                       | hon2010.html#search). |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1691} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1692} |                       |
|                       |                       |                       |
|                       | ## 19.5  Se           |                       |
|                       | ts {#sec227 .section} |                       |
|                       |                       |                       |
|                       | []{#sets}             |                       |
|                       |                       |                       |
|                       | In                    |                       |
|                       | Se                    |                       |
|                       | ction [13.6](thinkpyt |                       |
|                       | hon2014.html#dictsub) |                       |
|                       | I use dictionaries to |                       |
|                       | find the words that   |                       |
|                       | appear in a document  |                       |
|                       | but not in a word     |                       |
|                       | list. The function I  |                       |
|                       | wrote takes           |                       |
|                       | [d1]{.c004}, which    |                       |
|                       | contains the words    |                       |
|                       | from the document as  |                       |
|                       | keys, and             |                       |
|                       | [d2]{.c004}, which    |                       |
|                       | contains the list of  |                       |
|                       | words. It returns a   |                       |
|                       | dictionary that       |                       |
|                       | contains the keys     |                       |
|                       | from [d1]{.c004} that |                       |
|                       | are not in            |                       |
|                       | [d2]{.c004}.          |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def subtract(d1, d2): |                       | |                       |     res = dict()      |                       | |                       |     for key in d1:    |                       | |                       |                       |                       | |                       |     if key not in d2: |                       | |                       |                       |                       | |                       |       res[key] = None |                       | |                       |     return res        |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | In all of these       |                       |
|                       | dictionaries, the     |                       |
|                       | values are            |                       |
|                       | [None]{.c004} because |                       |
|                       | we never use them. As |                       |
|                       | a result, we waste    |                       |
|                       | some storage space.   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1693} |                       |
|                       |                       |                       |
|                       | Python provides       |                       |
|                       | another built-in      |                       |
|                       | type, called a        |                       |
|                       | [set]{.c004}, that    |                       |
|                       | behaves like a        |                       |
|                       | collection of         |                       |
|                       | dictionary keys with  |                       |
|                       | no values. Adding     |                       |
|                       | elements to a set is  |                       |
|                       | fast; so is checking  |                       |
|                       | membership. And sets  |                       |
|                       | provide methods and   |                       |
|                       | operators to compute  |                       |
|                       | common set            |                       |
|                       | operations.           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1694} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1695} |                       |
|                       |                       |                       |
|                       | For example, set      |                       |
|                       | subtraction is        |                       |
|                       | available as a method |                       |
|                       | called                |                       |
|                       | [difference]{.c004}   |                       |
|                       | or as an operator,    |                       |
|                       | [-]{.c004}. So we can |                       |
|                       | rewrite               |                       |
|                       | [subtract]{.c004}     |                       |
|                       | like this:            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1696} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def subtract(d1, d2): |                       | |                       |     ret               |                       | |                       | urn set(d1) - set(d2) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The result is a set   |                       |
|                       | instead of a          |                       |
|                       | dictionary, but for   |                       |
|                       | operations like       |                       |
|                       | iteration, the        |                       |
|                       | behavior is the same. |                       |
|                       |                       |                       |
|                       | Some of the exercises |                       |
|                       | in this book can be   |                       |
|                       | done concisely and    |                       |
|                       | efficiently with      |                       |
|                       | sets. For example,    |                       |
|                       | here is a solution to |                       |
|                       | <code>has_duplicates</code>,     |                       |
|                       | from                  |                       |
|                       | Exe                   |                       |
|                       | rcise [7](thinkpython |                       |
|                       | 2011.html#duplicate), |                       |
|                       | that uses a           |                       |
|                       | dictionary:           |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | d                     |                       | |                       | ef has_duplicates(t): |                       | |                       |     d = {}            |                       | |                       |     for x in t:       |                       | |                       |         if x in d:    |                       | |                       |                       |                       | |                       |           return True |                       | |                       |         d[x] = True   |                       | |                       |     return False      |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When an element       |                       |
|                       | appears for the first |                       |
|                       | time, it is added to  |                       |
|                       | the dictionary. If    |                       |
|                       | the same element      |                       |
|                       | appears again, the    |                       |
|                       | function returns      |                       |
|                       | [True]{.c004}.        |                       |
|                       |                       |                       |
|                       | Using sets, we can    |                       |
|                       | write the same        |                       |
|                       | function like this:   |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | d                     |                       | |                       | ef has_duplicates(t): |                       | |                       |     return            |                       | |                       |  len(set(t)) &lt; len(t) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | An element can only   |                       |
|                       | appear in a set once, |                       |
|                       | so if an element in   |                       |
|                       | [t]{.c004} appears    |                       |
|                       | more than once, the   |                       |
|                       | set will be smaller   |                       |
|                       | than [t]{.c004}. If   |                       |
|                       | there are no          |                       |
|                       | duplicates, the set   |                       |
|                       | will be the same size |                       |
|                       | as [t]{.c004}.        |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1697} |                       |
|                       |                       |                       |
|                       | We can also use sets  |                       |
|                       | to do some of the     |                       |
|                       | exercises in          |                       |
|                       | C                     |                       |
|                       | hapter [9](thinkpytho |                       |
|                       | n2010.html#wordplay). |                       |
|                       | For example, here's a |                       |
|                       | version of            |                       |
|                       | <code>uses_only</code> with a    |                       |
|                       | loop:                 |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def uses_o            |                       | |                       | nly(word, available): |                       | |                       |                       |                       | |                       |  for letter in word:  |                       | |                       |         if let        |                       | |                       | ter not in available: |                       | |                       |                       |                       | |                       |          return False |                       | |                       |     return True       |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | <code>uses_only</code> checks    |                       |
|                       | whether all letters   |                       |
|                       | in [word]{.c004} are  |                       |
|                       | in                    |                       |
|                       | [available]{.c004}.   |                       |
|                       | We can rewrite it     |                       |
|                       | like this:            |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def uses_o            |                       | |                       | nly(word, available): |                       | |                       |     return set(wo     |                       | |                       | rd) &lt;= set(available) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The <code>&lt;=</code> operator     |                       |
|                       | checks whether one    |                       |
|                       | set is a subset of    |                       |
|                       | another, including    |                       |
|                       | the possibility that  |                       |
|                       | they are equal, which |                       |
|                       | is true if all the    |                       |
|                       | letters in            |                       |
|                       | [word]{.c004} appear  |                       |
|                       | in                    |                       |
|                       | [available]{.c004}.   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1698} |                       |
|                       |                       |                       |
|                       | As an exercise,       |                       |
|                       | rewrite <code>avoids</code>      |                       |
|                       | using sets.           |                       |
|                       |                       |                       |
|                       | ## 19.6  Counte       |                       |
|                       | rs {#sec228 .section} |                       |
|                       |                       |                       |
|                       | A Counter is like a   |                       |
|                       | set, except that if   |                       |
|                       | an element appears    |                       |
|                       | more than once, the   |                       |
|                       | Counter keeps track   |                       |
|                       | of how many times it  |                       |
|                       | appears. If you are   |                       |
|                       | familiar with the     |                       |
|                       | mathematical idea of  |                       |
|                       | a [multiset]{.c010},  |                       |
|                       | a Counter is a        |                       |
|                       | natural way to        |                       |
|                       | represent a multiset. |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1699} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1700} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1701} |                       |
|                       |                       |                       |
|                       | Counter is defined in |                       |
|                       | a standard module     |                       |
|                       | called                |                       |
|                       | [collections]{.c004}, |                       |
|                       | so you have to import |                       |
|                       | it. You can           |                       |
|                       | initialize a Counter  |                       |
|                       | with a string, list,  |                       |
|                       | or anything else that |                       |
|                       | supports iteration:   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1702} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1703} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; from colle        |                       | |                       | ctions import Counter |                       | |                       | &gt;&gt;&gt; coun              |                       | |                       | t = Counter('parrot') |                       | |                       | &gt;&gt;&gt; count             |                       | |                       | Counter               |                       | |                       | ({'r': 2, 't': 1, 'o' |                       | |                       | : 1, 'p': 1, 'a': 1}) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Counters behave like  |                       |
|                       | dictionaries in many  |                       |
|                       | ways; they map from   |                       |
|                       | each key to the       |                       |
|                       | number of times it    |                       |
|                       | appears. As in        |                       |
|                       | dictionaries, the     |                       |
|                       | keys have to be       |                       |
|                       | hashable.             |                       |
|                       |                       |                       |
|                       | Unlike dictionaries,  |                       |
|                       | Counters don't raise  |                       |
|                       | an exception if you   |                       |
|                       | access an element     |                       |
|                       | that doesn't appear.  |                       |
|                       | Instead, they return  |                       |
|                       | 0:                    |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; count['d']        |                       | |                       | 0                     |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | We can use Counters   |                       |
|                       | to rewrite            |                       |
|                       | <code>is_anagram</code> from     |                       |
|                       | E                     |                       |
|                       | xercise [6](thinkpyth |                       |
|                       | on2011.html#anagram): |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def is_a              |                       | |                       | nagram(word1, word2): |                       | |                       |                       |                       | |                       |    return Counter(wor |                       | |                       | d1) == Counter(word2) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | If two words are      |                       |
|                       | anagrams, they        |                       |
|                       | contain the same      |                       |
|                       | letters with the same |                       |
|                       | counts, so their      |                       |
|                       | Counters are          |                       |
|                       | equivalent.           |                       |
|                       |                       |                       |
|                       | Counters provide      |                       |
|                       | methods and operators |                       |
|                       | to perform set-like   |                       |
|                       | operations, including |                       |
|                       | addition,             |                       |
|                       | subtraction, union    |                       |
|                       | and intersection. And |                       |
|                       | they provide an       |                       |
|                       | often-useful method,  |                       |
|                       | <code>most_common</code>, which  |                       |
|                       | returns a list of     |                       |
|                       | value-frequency       |                       |
|                       | pairs, sorted from    |                       |
|                       | most common to least: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; coun              |                       | |                       | t = Counter('parrot') |                       | |                       | &gt;&gt;&gt; for val, freq in  |                       | |                       | count.most_common(3): |                       | |                       | ...                   |                       | |                       |      print(val, freq) |                       | |                       | r 2                   |                       | |                       | p 1                   |                       | |                       | a 1                   |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | ## 19.7  defaultdi    |                       |
|                       | ct {#sec229 .section} |                       |
|                       |                       |                       |
|                       | The                   |                       |
|                       | [collections]{.c004}  |                       |
|                       | module also provides  |                       |
|                       | [defaultdict]{.c004}, |                       |
|                       | which is like a       |                       |
|                       | dictionary except     |                       |
|                       | that if you access a  |                       |
|                       | key that doesn't      |                       |
|                       | exist, it can         |                       |
|                       | generate a new value  |                       |
|                       | on the fly.           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1704} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1705} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1706} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1707} |                       |
|                       |                       |                       |
|                       | When you create a     |                       |
|                       | defaultdict, you      |                       |
|                       | provide a function    |                       |
|                       | that's used to create |                       |
|                       | new values. A         |                       |
|                       | function used to      |                       |
|                       | create objects is     |                       |
|                       | sometimes called a    |                       |
|                       | [factory]{.c010}. The |                       |
|                       | built-in functions    |                       |
|                       | that create lists,    |                       |
|                       | sets, and other types |                       |
|                       | can be used as        |                       |
|                       | factories:            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1708} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; from collectio    |                       | |                       | ns import defaultdict |                       | |                       | &gt;&gt;&gt;                   |                       | |                       | d = defaultdict(list) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Notice that the       |                       |
|                       | argument is           |                       |
|                       | [list]{.c004}, which  |                       |
|                       | is a class object,    |                       |
|                       | not [list()]{.c004},  |                       |
|                       | which is a new list.  |                       |
|                       | The function you      |                       |
|                       | provide doesn't get   |                       |
|                       | called unless you     |                       |
|                       | access a key that     |                       |
|                       | doesn't exist.        |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; t = d['new key']  |                       | |                       | &gt;&gt;&gt; t                 |                       | |                       | []                    |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The new list, which   |                       |
|                       | we're calling         |                       |
|                       | [t]{.c004}, is also   |                       |
|                       | added to the          |                       |
|                       | dictionary. So if we  |                       |
|                       | modify [t]{.c004},    |                       |
|                       | the change appears in |                       |
|                       | [d]{.c004}:           |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt;                   |                       | |                       | t.append('new value') |                       | |                       | &gt;&gt;&gt; d                 |                       | |                       | defaultdict(&lt;         |                       | |                       | class 'list'&gt;, {'new  |                       | |                       | key': ['new value']}) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | If you are making a   |                       |
|                       | dictionary of lists,  |                       |
|                       | you can often write   |                       |
|                       | simpler code using    |                       |
|                       | [defaultdict]{.c004}. |                       |
|                       | In my solution to     |                       |
|                       | Ex                    |                       |
|                       | ercise [2](thinkpytho |                       |
|                       | n2013.html#anagrams), |                       |
|                       | which you can get     |                       |
|                       | from                  |                       |
|                       | [[https://thinkpyt    |                       |
|                       | hon.com/code/anagram</em> |                       |
|                       | sets.py]{.c004}](http |                       |
|                       | s://thinkpython.com/c |                       |
|                       | ode/anagram_sets.py), |                       |
|                       | I make a dictionary   |                       |
|                       | that maps from a      |                       |
|                       | sorted string of      |                       |
|                       | letters to the list   |                       |
|                       | of words that can be  |                       |
|                       | spelled with those    |                       |
|                       | letters. For example, |                       |
|                       | ['opst']{.c004} maps  |                       |
|                       | to the list           |                       |
|                       | [['opts', 'post',    |                       |
|                       | 'pots', 'spot',       |                       |
|                       | 'stop',               |                       |
|                       | 'tops']]{.c004}.     |                       |
|                       |                       |                       |
|                       | Here's the original   |                       |
|                       | code:                 |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def al                |                       | |                       | l_anagrams(filename): |                       | |                       |     d = {}            |                       | |                       |     for li            |                       | |                       | ne in open(filename): |                       | |                       |         word =        |                       | |                       |  line.strip().lower() |                       | |                       |                       |                       | |                       |   t = signature(word) |                       | |                       |                       |                       | |                       |        if t not in d: |                       | |                       |                       |                       | |                       |         d[t] = [word] |                       | |                       |         else:         |                       | |                       |                       |                       | |                       |     d[t].append(word) |                       | |                       |     return d          |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This can be           |                       |
|                       | simplified using      |                       |
|                       | [setdefault]{.c004},  |                       |
|                       | which you might have  |                       |
|                       | used in               |                       |
|                       | Exer                  |                       |
|                       | cise [2](thinkpython2 |                       |
|                       | 012.html#setdefault): |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1709} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def al                |                       | |                       | l_anagrams(filename): |                       | |                       |     d = {}            |                       | |                       |     for li            |                       | |                       | ne in open(filename): |                       | |                       |         word =        |                       | |                       |  line.strip().lower() |                       | |                       |                       |                       | |                       |   t = signature(word) |                       | |                       |         d.setdefaul   |                       | |                       | t(t, []).append(word) |                       | |                       |     return d          |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This solution has the |                       |
|                       | drawback that it      |                       |
|                       | makes a new list      |                       |
|                       | every time,           |                       |
|                       | regardless of whether |                       |
|                       | it is needed. For     |                       |
|                       | lists, that's no big  |                       |
|                       | deal, but if the      |                       |
|                       | factory function is   |                       |
|                       | complicated, it might |                       |
|                       | be.                   |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1710} |                       |
|                       |                       |                       |
|                       | We can avoid this     |                       |
|                       | problem and simplify  |                       |
|                       | the code using a      |                       |
|                       | [defaultdict]{.c004}: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def al                |                       | |                       | l_anagrams(filename): |                       | |                       |                       |                       | |                       | d = defaultdict(list) |                       | |                       |     for li            |                       | |                       | ne in open(filename): |                       | |                       |         word =        |                       | |                       |  line.strip().lower() |                       | |                       |                       |                       | |                       |   t = signature(word) |                       | |                       |                       |                       | |                       |     d[t].append(word) |                       | |                       |     return d          |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | My solution to        |                       |
|                       | Exercise [3](thinkpy  |                       |
|                       | thon2019.html#poker), |                       |
|                       | which you can         |                       |
|                       | download from         |                       |
|                       | [[https://thinkpytho  |                       |
|                       | n.com/code/PokerHandS |                       |
|                       | oln.py]{.c004}](https |                       |
|                       | ://thinkpython.com/co |                       |
|                       | de/PokerHandSoln.py), |                       |
|                       | uses                  |                       |
|                       | [setdefault]{.c004}   |                       |
|                       | in the function       |                       |
|                       | <code>has_straightflush</code>.  |                       |
|                       | This solution has the |                       |
|                       | drawback of creating  |                       |
|                       | a [Hand]{.c004}       |                       |
|                       | object every time     |                       |
|                       | through the loop,     |                       |
|                       | whether it is needed  |                       |
|                       | or not. As an         |                       |
|                       | exercise, rewrite it  |                       |
|                       | using a defaultdict.  |                       |
|                       |                       |                       |
|                       | ## 19.8  Named tupl   |                       |
|                       | es {#sec230 .section} |                       |
|                       |                       |                       |
|                       | Many simple objects   |                       |
|                       | are basically         |                       |
|                       | collections of        |                       |
|                       | related values. For   |                       |
|                       | example, the Point    |                       |
|                       | object defined in     |                       |
|                       | Ch                    |                       |
|                       | apter [15](thinkpytho |                       |
|                       | n2016.html#clobjects) |                       |
|                       | contains two numbers, |                       |
|                       | [x]{.c004} and        |                       |
|                       | [y]{.c004}. When you  |                       |
|                       | define a class like   |                       |
|                       | this, you usually     |                       |
|                       | start with an init    |                       |
|                       | method and a str      |                       |
|                       | method:               |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | class Point:          |                       | |                       |                       |                       | |                       |     def __in          |                       | |                       | it__(self, x=0, y=0): |                       | |                       |         self.x = x    |                       | |                       |         self.y = y    |                       | |                       |                       |                       | |                       |                       |                       | |                       |    def __str__(self): |                       | |                       |                       |                       | |                       |       return '(%g, %g |                       | |                       | )' % (self.x, self.y) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | This is a lot of code |                       |
|                       | to convey a small     |                       |
|                       | amount of             |                       |
|                       | information. Python   |                       |
|                       | provides a more       |                       |
|                       | concise way to say    |                       |
|                       | the same thing:       |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | from collecti         |                       | |                       | ons import namedtuple |                       | |                       | Point = namedtuple    |                       | |                       | ('Point', ['x', 'y']) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The first argument is |                       |
|                       | the name of the class |                       |
|                       | you want to create.   |                       |
|                       | The second is a list  |                       |
|                       | of the attributes     |                       |
|                       | Point objects should  |                       |
|                       | have, as strings. The |                       |
|                       | return value from     |                       |
|                       | [namedtuple]{.c004}   |                       |
|                       | is a class object:    |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1711} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1712} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1713} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1714} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; Point             |                       | |                       | &lt;cl                   |                       | |                       | ass '__main__.Point'&gt; |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | [Point]{.c004}        |                       |
|                       | automatically         |                       |
|                       | provides methods like |                       |
|                       | <code>__init__</code> and        |                       |
|                       | <code>__str__</code> so you      |                       |
|                       | don't have to write   |                       |
|                       | them.                 |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1715} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1716} |                       |
|                       |                       |                       |
|                       | To create a Point     |                       |
|                       | object, you use the   |                       |
|                       | Point class as a      |                       |
|                       | function:             |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; p = Point(1, 2)   |                       | |                       | &gt;&gt;&gt; p                 |                       | |                       | Point(x=1, y=2)       |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | The init method       |                       |
|                       | assigns the arguments |                       |
|                       | to attributes using   |                       |
|                       | the names you         |                       |
|                       | provided. The str     |                       |
|                       | method prints a       |                       |
|                       | representation of the |                       |
|                       | Point object and its  |                       |
|                       | attributes.           |                       |
|                       |                       |                       |
|                       | You can access the    |                       |
|                       | elements of the named |                       |
|                       | tuple by name:        |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; p.x, p.y          |                       | |                       | (1, 2)                |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | But you can also      |                       |
|                       | treat a named tuple   |                       |
|                       | as a tuple:           |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; p[0], p[1]        |                       | |                       | (1, 2)                |                       | |                       |                       |                       | |                       | &gt;&gt;&gt; x, y = p          |                       | |                       | &gt;&gt;&gt; x, y              |                       | |                       | (1, 2)                |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Named tuples provide  |                       |
|                       | a quick way to define |                       |
|                       | simple classes. The   |                       |
|                       | drawback is that      |                       |
|                       | simple classes don't  |                       |
|                       | always stay simple.   |                       |
|                       | You might decide      |                       |
|                       | later that you want   |                       |
|                       | to add methods to a   |                       |
|                       | named tuple. In that  |                       |
|                       | case, you could       |                       |
|                       | define a new class    |                       |
|                       | that inherits from    |                       |
|                       | the named tuple:      |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1717} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | c                     |                       | |                       | lass Pointier(Point): |                       | |                       |     #                 |                       | |                       | add more methods here |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Or you could switch   |                       |
|                       | to a conventional     |                       |
|                       | class definition.     |                       |
|                       |                       |                       |
|                       | ## 19.9               |                       |
|                       |  Gathering keyword ar |                       |
|                       | gs {#sec231 .section} |                       |
|                       |                       |                       |
|                       | In                    |                       |
|                       | Se                    |                       |
|                       | ction [12.4](thinkpyt |                       |
|                       | hon2013.html#gather), |                       |
|                       | we saw how to write a |                       |
|                       | function that gathers |                       |
|                       | its arguments into a  |                       |
|                       | tuple:                |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1718} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def printall(*args):  |                       | |                       |     print(args)       |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | You can call this     |                       |
|                       | function with any     |                       |
|                       | number of positional  |                       |
|                       | arguments (that is,   |                       |
|                       | arguments that don't  |                       |
|                       | have keywords):       |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1719} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1720} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt;                   |                       | |                       | printall(1, 2.0, '3') |                       | |                       | (1, 2.0, '3')         |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | But the [*]{.c004}   |                       |
|                       | operator doesn't      |                       |
|                       | gather keyword        |                       |
|                       | arguments:            |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1721} |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1722} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; printa            |                       | |                       | ll(1, 2.0, third='3') |                       | |                       | T                     |                       | |                       | ypeError: printall()  |                       | |                       | got an unexpected key |                       | |                       | word argument 'third' |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | To gather keyword     |                       |
|                       | arguments, you can    |                       |
|                       | use the [**]{.c004} |                       |
|                       | operator:             |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | def print             |                       | |                       | all(*args, **kwargs): |                       | |                       |                       |                       | |                       |   print(args, kwargs) |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | You can call the      |                       |
|                       | keyword gathering     |                       |
|                       | parameter anything    |                       |
|                       | you want, but         |                       |
|                       | [kwargs]{.c004} is a  |                       |
|                       | common choice. The    |                       |
|                       | result is a           |                       |
|                       | dictionary that maps  |                       |
|                       | from keywords to      |                       |
|                       | values:               |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;&gt;&gt; printa            |                       | |                       | ll(1, 2.0, third='3') |                       | |                       | (1                    |                       | |                       | , 2.0) {'third': '3'} |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | If you have a         |                       |
|                       | dictionary of         |                       |
|                       | keywords and values,  |                       |
|                       | you can use the       |                       |
|                       | scatter operator,     |                       |
|                       | [**]{.c004} to call |                       |
|                       | a function:           |                       |
|                       | [                     |                       |
|                       | ]{#hevea_default1723} |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;                     |                       | |                       | &gt;&gt; d = dict(x=1, y=2) |                       | |                       | &gt;&gt;&gt; Point(**d)        |                       | |                       | Point(x=1, y=2)       |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | Without the scatter   |                       |
|                       | operator, the         |                       |
|                       | function would treat  |                       |
|                       | [d]{.c004} as a       |                       |
|                       | single positional     |                       |
|                       | argument, so it would |                       |
|                       | assign [d]{.c004} to  |                       |
|                       | [x]{.c004} and        |                       |
|                       | complain because      |                       |
|                       | there's nothing to    |                       |
|                       | assign to [y]{.c004}: |                       |
|                       |                       |                       |
|                       | <code>verbatim          |                       | |                       | &gt;                     |                       | |                       | &gt;&gt; d = dict(x=1, y=2) |                       | |                       | &gt;&gt;&gt; Point(d)          |                       | |                       | Traceback (mo         |                       | |                       | st recent call last): |                       | |                       |   File &quot;&lt;stdin&gt;&quot;      |                       | |                       | , line 1, in &lt;module&gt; |                       | |                       | T                     |                       | |                       | ypeError: __new__() m |                       | |                       | issing 1 required pos |                       | |                       | itional argument: 'y' |                       | |                       |</code>                   |                       |
|                       |                       |                       |
|                       | When you are working  |                       |
|                       | with functions that   |                       |
|                       | have a large number   |                       |
|                       | of parameters, it is  |                       |
|                       | often useful to       |                       |
|                       | create and pass       |                       |
|                       | around dictionaries   |                       |
|                       | that specify          |                       |
|                       | frequently used       |                       |
|                       | options.              |                       |
|                       |                       |                       |
|                       | ## 19.10  Glossa      |                       |
|                       | ry {#sec232 .section} |                       |
|                       |                       |                       |
|                       | [conditiona           |                       |
|                       | l expression:]{.c010} |                       |
|                       | :   An expression     |                       |
|                       |     that has one of   |                       |
|                       |     two values,       |                       |
|                       |     depending on a    |                       |
|                       |     condition.        |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1724} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1725} |                       |
|                       |                       |                       |
|                       | [list c               |                       |
|                       | omprehension:]{.c010} |                       |
|                       | :   An expression     |                       |
|                       |     with a            |                       |
|                       |     [for]{.c004} loop |                       |
|                       |     in square         |                       |
|                       |     brackets that     |                       |
|                       |     yields a new      |                       |
|                       |     list.             |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1726} |                       |
|                       |                       |                       |
|                       | [generato             |                       |
|                       | r expression:]{.c010} |                       |
|                       | :   An expression     |                       |
|                       |     with a            |                       |
|                       |     [for]{.c004} loop |                       |
|                       |     in parentheses    |                       |
|                       |     that yields a     |                       |
|                       |     generator object. |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1727} |                       |
|                       |     [                 |                       |
|                       | ]{#hevea_default1728} |                       |
|                       |                       |                       |
|                       | [multiset:]{.c010}    |           </p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ThinkPython/part_6.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../ThinkPython/part_8.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ThinkPython/part_6.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../ThinkPython/part_8.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
