called a <span class="c010">class</span>.
A class definition looks like this:
<a id="hevea_default1332"></a>
<a id="hevea_default1333"></a>
<a id="hevea_default1334"></a>
<a id="hevea_default1335"></a></p><pre class="verbatim">class Point:
    """Represents a point in 2-D space."""
</pre><p>
The header indicates that the new class is called <span class="c004">Point</span>.
The body is a docstring that explains what the class is for.
You can define variables and methods inside a class definition,
but we will get back to that later.
<a id="hevea_default1336"></a>
<a id="hevea_default1337"></a>
<a id="hevea_default1338"></a></p><p>Defining a class named <span class="c004">Point</span> creates a <span class="c010">class object</span>.</p><pre class="verbatim">&gt;&gt;&gt; Point
&lt;class '__main__.Point'&gt;
</pre><p>
Because <span class="c004">Point</span> is defined at the top level, its &#X201C;full
name&#X201D; is <code>__main__.Point</code>.
<a id="hevea_default1339"></a>
<a id="hevea_default1340"></a></p><p>The class object is like a factory for creating objects. To create a
Point, you call <span class="c004">Point</span> as if it were a function.</p><pre class="verbatim">&gt;&gt;&gt; blank = Point()
&gt;&gt;&gt; blank
&lt;__main__.Point object at 0xb7e9d3ac&gt;
</pre><p>
The return value is a reference to a Point object, which we
assign to <span class="c004">blank</span>. </p><p>Creating a new object is called
<span class="c010">instantiation</span>, and the object is an <span class="c010">instance</span> of
the class.
<a id="hevea_default1341"></a>
<a id="hevea_default1342"></a></p><p>When you print an instance, Python tells you what class it
belongs to and where it is stored in memory (the prefix
<span class="c004">0x</span> means that the following number is in hexadecimal).
<a id="hevea_default1343"></a></p><p>Every object is an instance of some class, so &#X201C;object&#X201D; and
&#X201C;instance&#X201D; are interchangeable. But in this chapter I use
&#X201C;instance&#X201D; to indicate that I am talking about a programmer-defined
type.</p>
<h2 class="section" id="sec179">15.2&#XA0;&#XA0;Attributes</h2>
<p>
<a id="attributes"></a>
<a id="hevea_default1344"></a>
<a id="hevea_default1345"></a>
<a id="hevea_default1346"></a></p><p>You can assign values to an instance using dot notation:</p><pre class="verbatim">&gt;&gt;&gt; blank.x = 3.0
&gt;&gt;&gt; blank.y = 4.0
</pre><p>
This syntax is similar to the syntax for selecting a variable from a
module, such as <span class="c004">math.pi</span> or <span class="c004">string.whitespace</span>. In this case,
though, we are assigning values to named elements of an object.
These elements are called <span class="c010">attributes</span>.</p><p>As a noun, &#X201C;AT-trib-ute&#X201D; is pronounced with emphasis on the first
syllable, as opposed to &#X201C;a-TRIB-ute&#X201D;, which is a verb.</p><p>Figure&#XA0;<a href="#fig.point">15.1</a> is a state diagram that shows the result of these assignments.
A state diagram that shows an object and its attributes is
called an <span class="c010">object diagram</span>.
<a id="hevea_default1347"></a>
<a id="hevea_default1348"></a>
<a id="hevea_default1349"></a>
<a id="hevea_default1350"></a></p><blockquote class="figure"><div class="center"><hr class="c019"></div>
<div class="center"><img src="thinkpython2020.png"></div>
<div class="caption"><table class="c001 cellpading0"><tr><td class="c018">Figure 15.1: Object diagram.</td></tr>
</table></div>
<a id="fig.point"></a>
<div class="center"><hr class="c019"></div></blockquote><p>The variable <span class="c004">blank</span> refers to a Point object, which
contains two attributes. Each attribute refers to a
floating-point number.</p><p>You can read the value of an attribute using the same syntax:</p><pre class="verbatim">&gt;&gt;&gt; blank.y
4.0
&gt;&gt;&gt; x = blank.x
&gt;&gt;&gt; x
3.0
</pre><p>
The expression <span class="c004">blank.x</span> means, &#X201C;Go to the object <span class="c004">blank</span>
refers to and get the value of <span class="c004">x</span>.&#X201D; In the example, we assign that
value to a variable named <span class="c004">x</span>. There is no conflict between
the variable <span class="c004">x</span> and the attribute <span class="c004">x</span>.</p><p>You can use dot notation as part of any expression. For example:</p><pre class="verbatim">&gt;&gt;&gt; '(%g, %g)' % (blank.x, blank.y)
'(3.0, 4.0)'
&gt;&gt;&gt; distance = math.sqrt(blank.x**2 + blank.y**2)
&gt;&gt;&gt; distance
5.0
</pre><p>
You can pass an instance as an argument in the usual way.
For example:
<a id="hevea_default1351"></a></p><pre class="verbatim">def print_point(p):
    print('(%g, %g)' % (p.x, p.y))
</pre><p>
<code>print_point</code> takes a point as an argument and displays it in
mathematical notation. To invoke it, you can pass <span class="c004">blank</span> as
an argument:</p><pre class="verbatim">&gt;&gt;&gt; print_point(blank)
(3.0, 4.0)
</pre><p>
Inside the function, <span class="c004">p</span> is an alias for <span class="c004">blank</span>, so if
the function modifies <span class="c004">p</span>, <span class="c004">blank</span> changes.
<a id="hevea_default1352"></a></p><p>As an exercise, write a function called <code>distance_between_points</code>
that takes two Points as arguments and returns the distance between
them.</p>
<h2 class="section" id="sec180">15.3&#XA0;&#XA0;Rectangles</h2>
<p>
<a id="rectangles"></a></p><p>Sometimes it is obvious what the attributes of an object should be,
but other times you have to make decisions. For example, imagine you
are designing a class to represent rectangles. What attributes would
you use to specify the location and size of a rectangle? You can
ignore angle; to keep things simple, assume that the rectangle is
either vertical or horizontal.
<a id="hevea_default1353"></a></p><p>There are at least two possibilities: </p><ul class="itemize"><li class="li-itemize">You could specify one corner of the rectangle
(or the center), the width, and the height.</li><li class="li-itemize">You could specify two opposing corners.</li></ul><p>At this point it is hard to say whether either is better than
the other, so we&#X2019;ll implement the first one, just as an example.
<a id="hevea_default1354"></a>
<a id="hevea_default1355"></a></p><p>Here is the class definition:</p><pre class="verbatim">class Rectangle:
    """Represents a rectangle. 

    attributes: width, height, corner.
    """
</pre><p>
The docstring lists the attributes: <span class="c004">width</span> and
<span class="c004">height</span> are numbers; <span class="c004">corner</span> is a Point object that
specifies the lower-left corner.</p><p>To represent a rectangle, you have to instantiate a Rectangle
object and assign values to the attributes:</p><pre class="verbatim">box = Rectangle()
box.width = 100.0
box.height = 200.0
box.corner = Point()
box.corner.x = 0.0
box.corner.y = 0.0
</pre><p>
The expression <span class="c004">box.corner.x</span> means,
&#X201C;Go to the object <span class="c004">box</span> refers to and select the attribute named
<span class="c004">corner</span>; then go to that object and select the attribute named
<span class="c004">x</span>.&#X201D;</p><blockquote class="figure"><div class="center"><hr class="c019"></div>
<div class="center"><img src="thinkpython2021.png"></div>
<div class="caption"><table class="c001 cellpading0"><tr><td class="c018">Figure 15.2: Object diagram.</td></tr>
</table></div>
<a id="fig.rectangle"></a>
<div class="center"><hr class="c019"></div></blockquote><p>Figure&#XA0;<a href="#fig.rectangle">15.2</a> shows the state of this object.
An object that is an attribute of another object is <span class="c010">embedded</span>.
<a id="hevea_default1356"></a>
<a id="hevea_default1357"></a>
<a id="hevea_default1358"></a>
<a id="hevea_default1359"></a>
<a id="hevea_default1360"></a>
<a id="hevea_default1361"></a></p>
<h2 class="section" id="sec181">15.4&#XA0;&#XA0;Instances as return values</h2>
<p>
<a id="hevea_default1362"></a>
<a id="hevea_default1363"></a></p><p>Functions can return instances. For example, <code>find_center</code>
takes a <span class="c004">Rectangle</span> as an argument and returns a <span class="c004">Point</span>
that contains the coordinates of the center of the <span class="c004">Rectangle</span>:</p><pre class="verbatim">def find_center(rect):
    p = Point()
    p.x = rect.corner.x + rect.width/2
    p.y = rect.corner.y + rect.height/2
    return p
</pre><p>
Here is an example that passes <span class="c004">box</span> as an argument and assigns
the resulting Point to <span class="c004">center</span>:</p><pre class="verbatim">&gt;&gt;&gt; center = find_center(box)
&gt;&gt;&gt; print_point(center)
(50, 100)
</pre>
<h2 class="section" id="sec182">15.5&#XA0;&#XA0;Objects are mutable</h2>
<p>
<a id="hevea_default1364"></a>
<a id="hevea_default1365"></a></p><p>You can change the state of an object by making an assignment to one of
its attributes. For example, to change the size of a rectangle
without changing its position, you can modify the values of <span class="c004">width</span> and <span class="c004">height</span>:</p><pre class="verbatim">box.width = box.width + 50
box.height = box.height + 100
</pre><p>
You can also write functions that modify objects. For example,
<code>grow_rectangle</code> takes a Rectangle object and two numbers,
<span class="c004">dwidth</span> and <span class="c004">dheight</span>, and adds the numbers to the
width and height of the rectangle:</p><pre class="verbatim">def grow_rectangle(rect, dwidth, dheight):
    rect.width += dwidth
    rect.height += dheight
</pre><p>
Here is an example that demonstrates the effect:</p><pre class="verbatim">&gt;&gt;&gt; box.width, box.height
(150.0, 300.0)
&gt;&gt;&gt; grow_rectangle(box, 50, 100)
&gt;&gt;&gt; box.width, box.height
(200.0, 400.0)
</pre><p>
Inside the function, <span class="c004">rect</span> is an
alias for <span class="c004">box</span>, so when the function modifies <span class="c004">rect</span>, 
<span class="c004">box</span> changes.</p><p>As an exercise, write a function named <code>move_rectangle</code> that takes
a Rectangle and two numbers named <span class="c004">dx</span> and <span class="c004">dy</span>. It
should change the location of the rectangle by adding <span class="c004">dx</span>
to the <span class="c004">x</span> coordinate of <span class="c004">corner</span> and adding <span class="c004">dy</span>
to the <span class="c004">y</span> coordinate of <span class="c004">corner</span>.</p>
<h2 class="section" id="sec183">15.6&#XA0;&#XA0;Copying</h2>
<p>
<a id="copying"></a>
<a id="hevea_default1366"></a></p><p>Aliasing can make a program difficult to read because changes
in one place might have unexpected effects in another place.
It is hard to keep track of all the variables that might refer
to a given object.
<a id="hevea_default1367"></a>
<a id="hevea_default1368"></a>
<a id="hevea_default1369"></a>
<a id="hevea_default1370"></a></p><p>Copying an object is often an alternative to aliasing.
The <span class="c004">copy</span> module contains a function called <span class="c004">copy</span> that
can duplicate any object:</p><pre class="verbatim">&gt;&gt;&gt; p1 = Point()
&gt;&gt;&gt; p1.x = 3.0
&gt;&gt;&gt; p1.y = 4.0

&gt;&gt;&gt; import copy
&gt;&gt;&gt; p2 = copy.copy(p1)
</pre><p>
<span class="c004">p1</span> and <span class="c004">p2</span> contain the same data, but they are
not the same Point.</p><pre class="verbatim">&gt;&gt;&gt; print_point(p1)
(3, 4)
&gt;&gt;&gt; print_point(p2)
(3, 4)
&gt;&gt;&gt; p1 is p2
False
&gt;&gt;&gt; p1 == p2
False
</pre><p>
The <span class="c004">is</span> operator indicates that <span class="c004">p1</span> and <span class="c004">p2</span> are not the
same object, which is what we expected. But you might have expected
<span class="c004">==</span> to yield <span class="c004">True</span> because these points contain the same
data. In that case, you will be disappointed to learn that for
instances, the default behavior of the <span class="c004">==</span> operator is the same
as the <span class="c004">is</span> operator; it checks object identity, not object
equivalence. That&#X2019;s because for programmer-defined types, Python doesn&#X2019;t
know what should be considered equivalent. At least, not yet.
<a id="hevea_default1371"></a>
<a id="hevea_default1372"></a>
<a id="hevea_default1373"></a>
<a id="hevea_default1374"></a></p><p>If you use <span class="c004">copy.copy</span> to duplicate a Rectangle, you will find
that it copies the Rectangle object but not the embedded Point.
<a id="hevea_default1375"></a></p><pre class="verbatim">&gt;&gt;&gt; box2 = copy.copy(box)
&gt;&gt;&gt; box2 is box
False
&gt;&gt;&gt; box2.corner is box.corner
True
</pre><blockquote class="figure"><div class="center"><hr class="c019"></div>
<div class="center"><img src="thinkpython2022.png"></div>
<div class="caption"><table class="c001 cellpading0"><tr><td class="c018">Figure 15.3: Object diagram.</td></tr>
</table></div>
<a id="fig.rectangle2"></a>
<div class="center"><hr class="c019"></div></blockquote><p>Figure&#XA0;<a href="#fig.rectangle2">15.3</a> shows what the object diagram looks like.
<a id="hevea_default1376"></a>
<a id="hevea_default1377"></a>
<a id="hevea_default1378"></a>
<a id="hevea_default1379"></a>
This operation is called a <span class="c010">shallow copy</span> because it copies the
object and any references it contains, but not the embedded objects.
<a id="hevea_default1380"></a>
<a id="hevea_default1381"></a></p><p>For most applications, this is not what you want. In this example,
invoking <code>grow_rectangle</code> on one of the Rectangles would not
affect the other, but invoking <code>move_rectangle</code> on either would
affect both! This behavior is confusing and error-prone.
<a id="hevea_default1382"></a>
<a id="hevea_default1383"></a></p><p>Fortunately, the <span class="c004">copy</span> module provides a method named <span class="c004">deepcopy</span> that copies not only the object but also 
the objects it refers to, and the objects <em>they</em> refer to,
and so on.
You will not be surprised to learn that this operation is
called a <span class="c010">deep copy</span>.
<a id="hevea_default1384"></a>
<a id="hevea_default1385"></a></p><pre class="verbatim">&gt;&gt;&gt; box3 = copy.deepcopy(box)
&gt;&gt;&gt; box3 is box
False
&gt;&gt;&gt; box3.corner is box.corner
False
</pre><p>
<span class="c004">box3</span> and <span class="c004">box</span> are completely separate objects.</p><p>As an exercise, write a version of <code>move_rectangle</code> that creates and
returns a new Rectangle instead of modifying the old one.</p>
<h2 class="section" id="sec184">15.7&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hasattr"></a>
<a id="hevea_default1386"></a></p><p>When you start working with objects, you are likely to encounter
some new exceptions. If you try to access an attribute
that doesn&#X2019;t exist, you get an <span class="c004">AttributeError</span>:
<a id="hevea_default1387"></a>
<a id="hevea_default1388"></a></p><pre class="verbatim">&gt;&gt;&gt; p = Point()
&gt;&gt;&gt; p.x = 3
&gt;&gt;&gt; p.y = 4
&gt;&gt;&gt; p.z
AttributeError: Point instance has no attribute 'z'
</pre><p>
If you are not sure what type an object is, you can ask:
<a id="hevea_default1389"></a>
<a id="hevea_default1390"></a></p><pre class="verbatim">&gt;&gt;&gt; type(p)
&lt;class '__main__.Point'&gt;
</pre><p>
You can also use <span class="c004">isinstance</span> to check whether an object
is an instance of a class:
<a id="hevea_default1391"></a>
<a id="hevea_default1392"></a></p><pre class="verbatim">&gt;&gt;&gt; isinstance(p, Point)
True
</pre><p>
If you are not sure whether an object has a particular attribute,
you can use the built-in function <span class="c004">hasattr</span>:
<a id="hevea_default1393"></a>
<a id="hevea_default1394"></a></p><pre class="verbatim">&gt;&gt;&gt; hasattr(p, 'x')
True
&gt;&gt;&gt; hasattr(p, 'z')
False
</pre><p>
The first argument can be any object; the second argument is a <em>string</em> that contains the name of the attribute.
<a id="hevea_default1395"></a></p><p>You can also use a <span class="c004">try</span> statement to see if the object has the
attributes you need:
<a id="hevea_default1396"></a>
<a id="hevea_default1397"></a></p><pre class="verbatim">try:
    x = p.x
except AttributeError:
    x = 0
</pre><p>This approach can make it easier to write functions that work with
different types; more on that topic is
coming up in Section&#XA0;<a href="thinkpython2018.html#polymorphism">17.9</a>.</p>
<h2 class="section" id="sec185">15.8&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">class:</span></dt><dd class="dd-description"> A programmer-defined type. A class definition creates a new
class object.
<a id="hevea_default1398"></a>
<a id="hevea_default1399"></a>
<a id="hevea_default1400"></a></dd><dt class="dt-description"><span class="c010">class object:</span></dt><dd class="dd-description"> An object that contains information about a
programmer-defined type. The class object can be used to create instances
of the type.
<a id="hevea_default1401"></a>
<a id="hevea_default1402"></a></dd><dt class="dt-description"><span class="c010">instance:</span></dt><dd class="dd-description"> An object that belongs to a class.
<a id="hevea_default1403"></a></dd><dt class="dt-description"><span class="c010">instantiate:</span></dt><dd class="dd-description"> To create a new object.
<a id="hevea_default1404"></a></dd><dt class="dt-description"><span class="c010">attribute:</span></dt><dd class="dd-description"> One of the named values associated with an object.
<a id="hevea_default1405"></a>
<a id="hevea_default1406"></a></dd><dt class="dt-description"><span class="c010">embedded object:</span></dt><dd class="dd-description"> An object that is stored as an attribute
of another object.
<a id="hevea_default1407"></a>
<a id="hevea_default1408"></a></dd><dt class="dt-description"><span class="c010">shallow copy:</span></dt><dd class="dd-description"> To copy the contents of an object, including
any references to embedded objects;
implemented by the <span class="c004">copy</span> function in the <span class="c004">copy</span> module.
<a id="hevea_default1409"></a></dd><dt class="dt-description"><span class="c010">deep copy:</span></dt><dd class="dd-description"> To copy the contents of an object as well as any
embedded objects, and any objects embedded in them, and so on;
implemented by the <span class="c004">deepcopy</span> function in the <span class="c004">copy</span> module.
<a id="hevea_default1410"></a></dd><dt class="dt-description"><span class="c010">object diagram:</span></dt><dd class="dd-description"> A diagram that shows objects, their
attributes, and the values of the attributes.
<a id="hevea_default1411"></a>
<a id="hevea_default1412"></a></dd></dl>
<h2 class="section" id="sec186">15.9&#XA0;&#XA0;Exercises</h2>
<div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Write a definition for a class named <span class="c004">Circle</span> with attributes
<span class="c004">center</span> and <span class="c004">radius</span>, where <span class="c004">center</span> is a Point object
and <span class="c004">radius</span> is a number.</em></p><p><em>Instantiate a Circle object that represents a circle with its center
at </em>(150, 100)<em> and radius 75.</em></p><p><em>Write a function named <code>point_in_circle</code> that takes a Circle and
a Point and returns True if the Point lies in or on the boundary of
the circle.</em></p><p><em>Write a function named <code>rect_in_circle</code> that takes a Circle and a
Rectangle and returns True if the Rectangle lies entirely in or on the boundary
of the circle.</em></p><p><em>Write a function named <code>rect_circle_overlap</code> that takes a Circle
and a Rectangle and returns True if any of the corners of the Rectangle fall
inside the Circle. Or as a more challenging version, return True if
any part of the Rectangle falls inside the Circle.</em></p><p><em>Solution: </em><a href="https://thinkpython.com/code/Circle.py"><em><span class="c004">https://thinkpython.com/code/Circle.py</span></em></a><em>.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;<p><em>Write a function called <code>draw_rect</code> that takes a Turtle object
and a Rectangle and uses the Turtle to draw the Rectangle. See
Chapter&#XA0;</em><a href="thinkpython2005.html#turtlechap"><em>4</em></a><em> for examples using Turtle objects.</em></p><p><em>Write a function called <code>draw_circle</code> that takes a Turtle and
a Circle and draws the Circle.</em></p><p><em>Solution: </em><a href="https://thinkpython.com/code/draw.py"><em><span class="c004">https://thinkpython.com/code/draw.py</span></em></a><em>.</em></p></div>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2015.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2017.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Classes and functions</title>
</head>
<body>
<a href="thinkpython2016.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2018.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec187">Chapter&#XA0;16&#XA0;&#XA0;Classes and functions</h1>
<p>
<a id="time"></a></p><p>Now that we know how to create new types, the next
step is to write functions that take programmer-defined objects
as parameters and return them as results. In this chapter I
also present &#X201C;functional programming style&#X201D; and two new
program development plans.</p><p>Code examples from this chapter are available from
<a href="https://thinkpython.com/code/Time1.py"><span class="c004">https://thinkpython.com/code/Time1.py</span></a>.
Solutions to the exercises are at
<a href="https://thinkpython.com/code/Time1_soln.py"><span class="c004">https://thinkpython.com/code/Time1_soln.py</span></a>.</p>
<h2 class="section" id="sec188">16.1&#XA0;&#XA0;Time</h2>
<p>
<a id="isafter"></a></p><p>As another example of a programmer-defined type, we&#X2019;ll define a class
called <span class="c004">Time</span> that records the time of day. The class definition
looks like this: <a id="hevea_default1413"></a>
<a id="hevea_default1414"></a> <a id="hevea_default1415"></a> <a id="hevea_default1416"></a></p><pre class="verbatim">class Time:
    """Represents the time of day.
       
    attributes: hour, minute, second
    """
</pre><p>
We can create a new <span class="c004">Time</span> object and assign
attributes for hours, minutes, and seconds:</p><pre class="verbatim">time = Time()
time.hour = 11
time.minute = 59
time.second = 30
</pre><p>
The state diagram for the <span class="c004">Time</span> object looks like Figure&#XA0;<a href="#fig.time">16.1</a>.
<a id="hevea_default1417"></a>
<a id="hevea_default1418"></a>
<a id="hevea_default1419"></a>
<a id="hevea_default1420"></a></p><p>As an exercise, write a function called <code>print_time</code> that takes a 
Time object and prints it in the form <span class="c004">hour:minute:second</span>.
Hint: the format sequence <code>'%.2d'</code> prints an integer using
at least two digits, including a leading zero if necessary.</p><p>Write a boolean function called <code>is_after</code> that
takes two Time objects, <span class="c004">t1</span> and <span class="c004">t2</span>, and
returns <span class="c004">True</span> if <span class="c004">t1</span> follows <span class="c004">t2</span> chronologically and
<span class="c004">False</span> otherwise. Challenge: don&#X2019;t use an <span class="c004">if</span> statement.</p><blockquote class="figure"><div class="center"><hr class="c019"></div>
<div class="center"><img src="thinkpython2023.png"></div>
<div class="caption"><table class="c001 cellpading0"><tr><td class="c018">Figure 16.1: Object diagram.</td></tr>
</table></div>
<a id="fig.time"></a>
<div class="center"><hr class="c019"></div></blockquote>
<h2 class="section" id="sec189">16.2&#XA0;&#XA0;Pure functions</h2>
<p>
<a id="hevea_default1421"></a>
<a id="hevea_default1422"></a></p><p>In the next few sections, we&#X2019;ll write two functions that add time
values. They demonstrate two kinds of functions: pure functions and
modifiers. They also demonstrate a development plan I&#X2019;ll call <span class="c010">prototype and patch</span>, which is a way of tackling a complex problem
by starting with a simple prototype and incrementally dealing with the
complications.</p><p>Here is a simple prototype of <code>add_time</code>:</p><pre class="verbatim">def add_time(t1, t2):
    sum = Time()
    sum.hour = t1.hour + t2.hour
    sum.minute = t1.minute + t2.minute
    sum.second = t1.second + t2.second
    return sum
</pre><p>
The function creates a new <span class="c004">Time</span> object, initializes its
attributes, and returns a reference to the new object. This is called
a <span class="c010">pure function</span> because it does not modify any of the objects
passed to it as arguments and it has no effect,
like displaying a value or getting user input, 
other than returning a value.
<a id="hevea_default1423"></a>
<a id="hevea_default1424"></a></p><p>To test this function, I&#X2019;ll create two Time objects: <span class="c004">start</span>
contains the start time of a movie, like <em>Monty Python and the
Holy Grail</em>, and <span class="c004">duration</span> contains the run time of the movie,
which is one hour 35 minutes.
<a id="hevea_default1425"></a></p><p><code>add_time</code> figures out when the movie will be done.</p><pre class="verbatim">&gt;&gt;&gt; start = Time()
&gt;&gt;&gt; start.hour = 9
&gt;&gt;&gt; start.minute = 45
&gt;&gt;&gt; start.second =  0

&gt;&gt;&gt; duration = Time()
&gt;&gt;&gt; duration.hour = 1
&gt;&gt;&gt; duration.minute = 35
&gt;&gt;&gt; duration.second = 0

&gt;&gt;&gt; done = add_time(start, duration)
&gt;&gt;&gt; print_time(done)
10:80:00
</pre><p>
The result, <span class="c004">10:80:00</span> might not be what you were hoping
for. The problem is that this function does not deal with cases where the
number of seconds or minutes adds up to more than sixty. When that
happens, we have to &#X201C;carry&#X201D; the extra seconds into the minute column
or the extra minutes into the hour column.
<a id="hevea_default1426"></a></p><p>Here&#X2019;s an improved version:</p><pre class="verbatim">def add_time(t1, t2):
    sum = Time()
    sum.hour = t1.hour + t2.hour
    sum.minute = t1.minute + t2.minute
    sum.second = t1.second + t2.second

    if sum.second &gt;= 60:
        sum.second -= 60
        sum.minute += 1

    if sum.minute &gt;= 60:
        sum.minute -= 60
        sum.hour += 1

    return sum
</pre><p>
Although this function is correct, it is starting to get big.
We will see a shorter alternative later.</p>
<h2 class="section" id="sec190">16.3&#XA0;&#XA0;Modifiers</h2>
<p>
<a id="increment"></a>
<a id="hevea_default1427"></a>
<a id="hevea_default1428"></a></p><p>Sometimes it is useful for a function to modify the objects it gets as
parameters. In that case, the changes are visible to the caller.
Functions that work this way are called <span class="c010">modifiers</span>.
<a id="hevea_default1429"></a></p><p><span class="c004">increment</span>, which adds a given number of seconds to a <span class="c004">Time</span>
object, can be written naturally as a
modifier. Here is a rough draft:</p><pre class="verbatim">def increment(time, seconds):
    time.second += seconds

    if time.second &gt;= 60:
        time.second -= 60
        time.minute += 1

    if time.minute &gt;= 60:
        time.minute -= 60
        time.hour += 1
</pre><p>
The first line performs the basic operation; the remainder deals
with the special cases we saw before.
<a id="hevea_default1430"></a></p><p>Is this function correct? What happens if <span class="c004">seconds</span>
is much greater than sixty? </p><p>In that case, it is not enough to carry once; we have to keep doing it
until <span class="c004">time.second</span> is less than sixty. One solution is to
replace the <span class="c004">if</span> statements with <span class="c004">while</span> statements. That
would make the function correct, but not very efficient. As an
exercise, write a correct version of <span class="c004">increment</span> that doesn&#X2019;t
contain any loops.</p><p>Anything that can be done with modifiers can also be done with pure
functions. In fact, some programming languages only allow pure
functions. There is some evidence that programs that use pure
functions are faster to develop and less error-prone than programs
that use modifiers. But modifiers are convenient at times,
and functional programs tend to be less efficient.</p><p>In general, I recommend that you write pure functions whenever it is
reasonable and resort to modifiers only if there is a compelling
advantage. This approach might be called a <span class="c010">functional
programming style</span>.
<a id="hevea_default1431"></a></p><p>As an exercise, write a &#X201C;pure&#X201D; version of <span class="c004">increment</span> that
creates and returns a new Time object rather than modifying the
parameter.</p>
<h2 class="section" id="sec191">16.4&#XA0;&#XA0;Prototyping versus planning</h2>
<p>
<a id="prototype"></a>
<a id="hevea_default1432"></a>
<a id="hevea_default1433"></a>
<a id="hevea_default1434"></a>
<a id="hevea_default1435"></a></p><p>The development plan I am demonstrating is called &#X201C;prototype and
patch&#X201D;. For each function, I wrote a prototype that performed the
basic calculation and then tested it, patching errors along the
way.</p><p>This approach can be effective, especially if you don&#X2019;t yet have a
deep understanding of the problem. But incremental corrections can
generate code that is unnecessarily complicated&#X2014;since it deals with
many special cases&#X2014;and unreliable&#X2014;since it is hard to know if you
have found all the errors.</p><p>An alternative is <span class="c010">designed development</span>, in which high-level
insight into the problem can make the programming much easier. In
this case, the insight is that a Time object is really a three-digit
number in base 60 (see <a href="http://en.wikipedia.org/wiki/Sexagesimal"><span class="c004">http://en.wikipedia.org/wiki/Sexagesimal</span></a>). The
<span class="c004">second</span> attribute is the &#X201C;ones column&#X201D;, the <span class="c004">minute</span>
attribute is the &#X201C;sixties column&#X201D;, and the <span class="c004">hour</span> attribute is
the &#X201C;thirty-six hundreds column&#X201D;.
<a id="hevea_default1436"></a></p><p>When we wrote <code>add_time</code> and <span class="c004">increment</span>, we were effectively
doing addition in base 60, which is why we had to carry from one
column to the next.
<a id="hevea_default1437"></a></p><p>This observation suggests another approach to the whole problem&#X2014;we
can convert Time objects to integers and take advantage of the fact
that the computer knows how to do integer arithmetic. </p><p>Here is a function that converts Times to integers:</p><pre class="verbatim">def time_to_int(time):
    minutes = time.hour * 60 + time.minute
    seconds = minutes * 60 + time.second
    return seconds
</pre><p>
And here is a function that converts an integer to a Time
(recall that <span class="c004">divmod</span> divides the first argument by the second
and returns the quotient and remainder as a tuple).
<a id="hevea_default1438"></a></p><pre class="verbatim">def int_to_time(seconds):
    time = Time()
    minutes, time.second = divmod(seconds, 60)
    time.hour, time.minute = divmod(minutes, 60)
    return time
</pre><p>
You might have to think a bit, and run some tests, to convince
yourself that these functions are correct. One way to test them is to
check that <code>time_to_int(int_to_time(x)) == x</code> for many values of
<span class="c004">x</span>. This is an example of a consistency check.
<a id="hevea_default1439"></a></p><p>Once you are convinced they are correct, you can use them to 
rewrite <code>add_time</code>:</p><pre class="verbatim">def add_time(t1, t2):
    seconds = time_to_int(t1) + time_to_int(t2)
    return int_to_time(seconds)
</pre><p>
This version is shorter than the original, and easier to verify. As
an exercise, rewrite <span class="c004">increment</span> using <code>time_to_int</code> and
<code>int_to_time</code>.</p><p>In some ways, converting from base 60 to base 10 and back is harder
than just dealing with times. Base conversion is more abstract; our
intuition for dealing with time values is better.</p><p>But if we have the insight to treat times as base 60 numbers and make
the investment of writing the conversion functions (<code>time_to_int</code>
and <code>int_to_time</code>), we get a program that is shorter, easier to
read and debug, and more reliable.</p><p>It is also easier to add features later. For example, imagine
subtracting two Times to find the duration between them. The
naive approach would be to implement subtraction with borrowing.
Using the conversion functions would be easier and more likely to be
correct.
<a id="hevea_default1440"></a>
<a id="hevea_default1441"></a>
<a id="hevea_default1442"></a></p><p>Ironically, sometimes making a problem harder (or more general) makes it
easier (because there are fewer special cases and fewer opportunities
for error).</p>
<h2 class="section" id="sec192">16.5&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hevea_default1443"></a></p><p>A Time object is well-formed if the values of <span class="c004">minute</span> and <span class="c004">second</span> are between 0 and 60 (including 0 but not 60) and if 
<span class="c004">hour</span> is positive. <span class="c004">hour</span> and <span class="c004">minute</span> should be
integer values, but we might allow <span class="c004">second</span> to have a
fraction part.
<a id="hevea_default1444"></a></p><p>Requirements like these are called <span class="c010">invariants</span> because
they should always be true. To put it a different way, if they
are not true, something has gone wrong.</p><p>Writing code to check invariants can help detect errors
and find their causes. For example, you might have a function
like <code>valid_time</code> that takes a Time object and returns
<span class="c004">False</span> if it violates an invariant:</p><pre class="verbatim">def valid_time(time):
    if time.hour &lt; 0 or time.minute &lt; 0 or time.second &lt; 0:
        return False
    if time.minute &gt;= 60 or time.second &gt;= 60:
        return False
    return True
</pre><p>
At the beginning of each function you could check the
arguments to make sure they are valid:
<a id="hevea_default1445"></a>
<a id="hevea_default1446"></a></p><pre class="verbatim">def add_time(t1, t2):
    if not valid_time(t1) or not valid_time(t2):
        raise ValueError('invalid Time object in add_time')
    seconds = time_to_int(t1) + time_to_int(t2)
    return int_to_time(seconds)
</pre><p>
Or you could use an <span class="c010">assert statement</span>, which checks a given invariant
and raises an exception if it fails:
<a id="hevea_default1447"></a>
<a id="hevea_default1448"></a></p><pre class="verbatim">def add_time(t1, t2):
    assert valid_time(t1) and valid_time(t2)
    seconds = time_to_int(t1) + time_to_int(t2)
    return int_to_time(seconds)
</pre><p>
<span class="c004">assert</span> statements are useful because they distinguish
code that deals with normal conditions from code
that checks for errors.</p>
<h2 class="section" id="sec193">16.6&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">prototype and patch:</span></dt><dd class="dd-description"> A development plan that involves
writing a rough draft of a program, testing, and correcting errors as
they are found.
<a id="hevea_default1449"></a></dd><dt class="dt-description"><span class="c010">designed development:</span></dt><dd class="dd-description"> A development plan that involves
high-level insight into the problem and more planning than incremental
development or prototype development.
<a id="hevea_default1450"></a></dd><dt class="dt-description"><span class="c010">pure function:</span></dt><dd class="dd-description"> A function that does not modify any of the objects it
receives as arguments. Most pure functions are fruitful.
<a id="hevea_default1451"></a></dd><dt class="dt-description"><span class="c010">modifier:</span></dt><dd class="dd-description"> A function that changes one or more of the objects it
receives as arguments. Most modifiers are void; that is, they
return <span class="c004">None</span>. <a id="hevea_default1452"></a></dd><dt class="dt-description"><span class="c010">functional programming style:</span></dt><dd class="dd-description"> A style of program design in which the
majority of functions are pure.
<a id="hevea_default1453"></a></dd><dt class="dt-description"><span class="c010">invariant:</span></dt><dd class="dd-description"> A condition that should always be true during the
execution of a program.
<a id="hevea_default1454"></a></dd><dt class="dt-description"><span class="c010">assert statement:</span></dt><dd class="dd-description"> A statement that checks a condition and raises
an exception if it fails.
<a id="hevea_default1455"></a>
<a id="hevea_default1456"></a></dd></dl>
<h2 class="section" id="sec194">16.7&#XA0;&#XA0;Exercises</h2>
<p>Code examples from this chapter are available from
<a href="https://thinkpython.com/code/Time1.py"><span class="c004">https://thinkpython.com/code/Time1.py</span></a>; solutions to the
exercises are available from <a href="https://thinkpython.com/code/Time1_soln.py"><span class="c004">https://thinkpython.com/code/Time1_soln.py</span></a>.</p><div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Write a function called <code>mul_time</code> that takes a Time object
and a number and returns a new Time object that contains
the product of the original Time and the number.</em></p><p><em>Then use <code>mul_time</code> to write a function that takes a Time
object that represents the finishing time in a race, and a number
that represents the distance, and returns a Time object that represents
the average pace (time per mile).
</em><a id="hevea_default1457"></a></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;
<a id="hevea_default1458"></a>
<a id="hevea_default1459"></a><p><em>The <span class="c004">datetime</span> module provides <span class="c004">time</span> objects
that are similar to the Time objects in this chapter, but
they provide a rich set of methods and operators. Read the
documentation at </em><a href="http://docs.python.org/3/library/datetime.html"><span class="c004"><em>http://docs.python.org/3/library/datetime.html</em></span></a><em>.</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>Use the <span class="c004">datetime</span> module to write a program that gets the
current date and prints the day of the week.</em></li><li class="li-enumerate"><em>Write a program that takes a birthday as input and prints the
user&#X2019;s age and the number of days, hours, minutes and seconds until
their next birthday.
</em><a id="hevea_default1460"></a></li><li class="li-enumerate"><em>For two people born on different days, there is a day when one
is twice as old as the other. That&#X2019;s their Double Day. Write a
program that takes two birth dates and computes their Double Day.</em></li><li class="li-enumerate"><em>For a little more challenge, write the more general version that
computes the day when one person is </em><span class="c009">n</span><em> times older than the other.
</em><a id="hevea_default1461"></a></li></ol><p><em>Solution: </em><a href="https://thinkpython.com/code/double.py"><em><span class="c004">https://thinkpython.com/code/double.py</span></em></a></p></div>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2016.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2018.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Classes and methods</title>
</head>
<body>
<a href="thinkpython2017.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2019.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec195">Chapter&#XA0;17&#XA0;&#XA0;Classes and methods</h1>
<p>Although we are using some of Python&#X2019;s object-oriented features,
the programs from the last two chapters are not really
object-oriented because they don&#X2019;t represent the relationships
between programmer-defined types and the functions that operate
on them. The next step is to transform those functions into
methods that make the relationships explicit.</p><p>Code examples from this chapter are available from
<a href="https://thinkpython.com/code/Time2.py"><span class="c004">https://thinkpython.com/code/Time2.py</span></a>, and solutions
to the exercises are in <a href="https://thinkpython.com/code/Point2_soln.py"><span class="c004">https://thinkpython.com/code/Point2_soln.py</span></a>.</p>
<h2 class="section" id="sec196">17.1&#XA0;&#XA0;Object-oriented features</h2>
<p>
<a id="hevea_default1462"></a></p><p>Python is an <span class="c010">object-oriented programming language</span>, which means
that it provides features that support object-oriented
programming, which has these defining characteristics:</p><ul class="itemize"><li class="li-itemize">Programs include class and method definitions.</li><li class="li-itemize">Most of the computation is expressed in terms of operations on
objects.</li><li class="li-itemize">Objects often represent things
in the real world, and methods often
correspond to the ways things in the real world interact.</li></ul><p>For example, the <span class="c004">Time</span> class defined in Chapter&#XA0;<a href="thinkpython2017.html#time">16</a>
corresponds to the way people record the time of day, and the
functions we defined correspond to the kinds of things people do with
times. Similarly, the <span class="c004">Point</span> and <span class="c004">Rectangle</span> classes
in Chapter&#XA0;<a href="thinkpython2016.html#clobjects">15</a>
correspond to the mathematical concepts of a point and a rectangle.</p><p>So far, we have not taken advantage of the features Python provides to
support object-oriented programming. These
features are not strictly necessary; most of them provide
alternative syntax for things we have already done. But in many cases,
the alternative is more concise and more accurately conveys the
structure of the program.</p><p>For example, in <span class="c004">Time1.py</span> there is no obvious
connection between the class definition and the function definitions
that follow. With some examination, it is apparent that every function
takes at least one <span class="c004">Time</span> object as an argument.
<a id="hevea_default1463"></a>
<a id="hevea_default1464"></a></p><p>This observation is the motivation for <span class="c010">methods</span>; a method is
a function that is associated with a particular class.
We have seen methods for strings, lists, dictionaries and tuples.
In this chapter, we will define methods for programmer-defined types.
<a id="hevea_default1465"></a>
<a id="hevea_default1466"></a>
<a id="hevea_default1467"></a>
<a id="hevea_default1468"></a></p><p>Methods are semantically the same as functions, but there are
two syntactic differences:</p><ul class="itemize"><li class="li-itemize">Methods are defined inside a class definition in order
to make the relationship between the class and the method explicit.</li><li class="li-itemize">The syntax for invoking a method is different from the
syntax for calling a function.</li></ul><p>In the next few sections, we will take the functions from the previous
two chapters and transform them into methods. This transformation is
purely mechanical; you can do it by following a sequence of
steps. If you are comfortable converting from one form to another,
you will be able to choose the best form for whatever you are doing.</p>
<h2 class="section" id="sec197">17.2&#XA0;&#XA0;Printing objects</h2>
<p>
<a id="hevea_default1469"></a></p><p>In Chapter&#XA0;<a href="thinkpython2017.html#time">16</a>, we defined a class named
<span class="c004">Time</span> and in Section&#XA0;<a href="thinkpython2017.html#isafter">16.1</a>, you 
wrote a function named <code>print_time</code>:</p><pre class="verbatim">class Time:
    """Represents the time of day."""

def print_time(time):
    print('%.2d:%.2d:%.2d' % (time.hour, time.minute, time.second))
</pre><p>
To call this function, you have to pass a <span class="c004">Time</span> object as an
argument:</p><pre class="verbatim">&gt;&gt;&gt; start = Time()
&gt;&gt;&gt; start.hour = 9
&gt;&gt;&gt; start.minute = 45
&gt;&gt;&gt; start.second = 00
&gt;&gt;&gt; print_time(start)
09:45:00
</pre><p>
To make <code>print_time</code> a method, all we have to do is
move the function definition inside the class definition. Notice
the change in indentation.
<a id="hevea_default1470"></a></p><pre class="verbatim">class Time:
    def print_time(time):
        print('%.2d:%.2d:%.2d' % (time.hour, time.minute, time.second))
</pre><p>
Now there are two ways to call <code>print_time</code>. The first
(and less common) way is to use function syntax:
<a id="hevea_default1471"></a>
<a id="hevea_default1472"></a></p><pre class="verbatim">&gt;&gt;&gt; Time.print_time(start)
09:45:00
</pre><p>
In this use of dot notation, <span class="c004">Time</span> is the name of the class,
and <code>print_time</code> is the name of the method. <span class="c004">start</span> is
passed as a parameter.</p><p>The second (and more concise) way is to use method syntax:
<a id="hevea_default1473"></a></p><pre class="verbatim">&gt;&gt;&gt; start.print_time()
09:45:00
</pre><p>
In this use of dot notation, <code>print_time</code> is the name of the
method (again), and <span class="c004">start</span> is the object the method is
invoked on, which is called the <span class="c010">subject</span>. Just as the
subject of a sentence is what the sentence is about, the subject
of a method invocation is what the method is about.
<a id="hevea_default1474"></a></p><p>Inside the method, the subject is assigned to the first
parameter, so in this case <span class="c004">start</span> is assigned
to <span class="c004">time</span>.
<a id="hevea_default1475"></a>
<a id="hevea_default1476"></a></p><p>By convention, the first parameter of a method is
called <span class="c004">self</span>, so it would be more common to write
<code>print_time</code> like this:</p><pre class="verbatim">class Time:
    def print_time(self):
        print('%.2d:%.2d:%.2d' % (self.hour, self.minute, self.second))
</pre><p>
The reason for this convention is an implicit metaphor:
<a id="hevea_default1477"></a></p><ul class="itemize"><li class="li-itemize">The syntax for a function call, <code>print_time(start)</code>,
suggests that the function is the active agent. It says something
like, &#X201C;Hey <code>print_time</code>! Here&#X2019;s an object for you to print.&#X201D;</li><li class="li-itemize">In object-oriented programming, the objects are the active
agents. A method invocation like <code>start.print_time()</code> says
&#X201C;Hey <span class="c004">start</span>! Please print yourself.&#X201D;</li></ul><p>This change in perspective might be more polite, but it is not obvious
that it is useful. In the examples we have seen so far, it may not
be. But sometimes shifting responsibility from the functions onto the
objects makes it possible to write more versatile functions (or
methods), and makes it easier to maintain and reuse code.</p><p>As an exercise, rewrite <code>time_to_int</code> (from
Section&#XA0;<a href="thinkpython2017.html#prototype">16.4</a>) as a method. You might be tempted to
rewrite <code>int_to_time</code> as a method, too, but that doesn&#X2019;t
really make sense because there would be no object to invoke
it on.</p>
<h2 class="section" id="sec198">17.3&#XA0;&#XA0;Another example</h2>
<p>
<a id="hevea_default1478"></a></p><p>Here&#X2019;s a version of <span class="c004">increment</span> (from Section&#XA0;<a href="thinkpython2017.html#increment">16.3</a>)
rewritten as a method:</p><pre class="verbatim"># inside class Time:

    def increment(self, seconds):
        seconds += self.time_to_int()
        return int_to_time(seconds)
</pre><p>
This version assumes that <code>time_to_int</code> is written
as a method. Also, note that
it is a pure function, not a modifier.</p><p>Here&#X2019;s how you would invoke <span class="c004">increment</span>:</p><pre class="verbatim">&gt;&gt;&gt; start.print_time()
09:45:00
&gt;&gt;&gt; end = start.increment(1337)
&gt;&gt;&gt; end.print_time()
10:07:17
</pre><p>
The subject, <span class="c004">start</span>, gets assigned to the first parameter,
<span class="c004">self</span>. The argument, <span class="c004">1337</span>, gets assigned to the
second parameter, <span class="c004">seconds</span>.</p><p>This mechanism can be confusing, especially if you make an error.
For example, if you invoke <span class="c004">increment</span> with two arguments, you
get:
<a id="hevea_default1479"></a>
<a id="hevea_default1480"></a></p><pre class="verbatim">&gt;&gt;&gt; end = start.increment(1337, 460)
TypeError: increment() takes 2 positional arguments but 3 were given
</pre><p>
The error message is initially confusing, because there are
only two arguments in parentheses. But the subject is also
considered an argument, so all together that&#X2019;s three.</p><p>By the way, a <span class="c010">positional argument</span> is an argument that
doesn&#X2019;t have a parameter name; that is, it is not a keyword
argument. In this function call:
<a id="hevea_default1481"></a>
<a id="hevea_default1482"></a></p><pre class="verbatim">sketch(parrot, cage, dead=True)
</pre><p><span class="c004">parrot</span> and <span class="c004">cage</span> are positional, and <span class="c004">dead</span> is
a keyword argument.</p>
<h2 class="section" id="sec199">17.4&#XA0;&#XA0;A more complicated example</h2>
<p>Rewriting <code>is_after</code> (from Section&#XA0;<a href="thinkpython2017.html#isafter">16.1</a>) is slightly
more complicated because it takes two Time objects as parameters. In
this case it is conventional to name the first parameter <span class="c004">self</span>
and the second parameter <span class="c004">other</span>: <a id="hevea_default1483"></a>
<a id="hevea_default1484"></a></p><pre class="verbatim"># inside class Time:

    def is_after(self, other):
        return self.time_to_int() &gt; other.time_to_int()
</pre><p>
To use this method, you have to invoke it on one object and pass
the other as an argument:</p><pre class="verbatim">&gt;&gt;&gt; end.is_after(start)
True
</pre><p>
One nice thing about this syntax is that it almost reads
like English: &#X201C;end is after start?&#X201D;</p>
<h2 class="section" id="sec200">17.5&#XA0;&#XA0;The init method</h2>
<p>
<a id="hevea_default1485"></a>
<a id="hevea_default1486"></a></p><p>The init method (short for &#X201C;initialization&#X201D;) is
a special method that gets invoked when an object is instantiated. 
Its full name is <code>__init__</code> (two underscore characters,
followed by <span class="c004">init</span>, and then two more underscores). An
init method for the <span class="c004">Time</span> class might look like this:</p><pre class="verbatim"># inside class Time:

    def __init__(self, hour=0, minute=0, second=0):
        self.hour = hour
        self.minute = minute
        self.second = second
</pre><p>
It is common for the parameters of <code>__init__</code>
to have the same names as the attributes. The statement</p><pre class="verbatim">        self.hour = hour
</pre><p>
stores the value of the parameter <span class="c004">hour</span> as an attribute
of <span class="c004">self</span>.
<a id="hevea_default1487"></a>
<a id="hevea_default1488"></a>
<a id="hevea_default1489"></a>
<a id="hevea_default1490"></a></p><p>The parameters are optional, so if you call <span class="c004">Time</span> with
no arguments, you get the default values.</p><pre class="verbatim">&gt;&gt;&gt; time = Time()
&gt;&gt;&gt; time.print_time()
00:00:00
</pre><p>
If you provide one argument, it overrides <span class="c004">hour</span>:</p><pre class="verbatim">&gt;&gt;&gt; time = Time (9)
&gt;&gt;&gt; time.print_time()
09:00:00
</pre><p>
If you provide two arguments, they override <span class="c004">hour</span> and
<span class="c004">minute</span>.</p><pre class="verbatim">&gt;&gt;&gt; time = Time(9, 45)
&gt;&gt;&gt; time.print_time()
09:45:00
</pre><p>
And if you provide three arguments, they override all three
default values.</p><p>As an exercise, write an init method for the <span class="c004">Point</span> class that takes
<span class="c004">x</span> and <span class="c004">y</span> as optional parameters and assigns
them to the corresponding attributes.
<a id="hevea_default1491"></a>
<a id="hevea_default1492"></a></p>
<h2 class="section" id="sec201">17.6&#XA0;&#XA0;The <span class="c004">__str__</span> method</h2>
<p>
<a id="hevea_default1493"></a>
<a id="hevea_default1494"></a></p><p><code>__str__</code> is a special method, like <code>__init__</code>,
that is supposed to return a string representation of an object.
<a id="hevea_default1495"></a></p><p>For example, here is a <span class="c004">str</span> method for Time objects:</p><pre class="verbatim"># inside class Time:

    def __str__(self):
        return '%.2d:%.2d:%.2d' % (self.hour, self.minute, self.second)
</pre><p>
When you <span class="c004">print</span> an object, Python invokes the <span class="c004">str</span> method:
<a id="hevea_default1496"></a>
<a id="hevea_default1497"></a></p><pre class="verbatim">&gt;&gt;&gt; time = Time(9, 45)
&gt;&gt;&gt; print(time)
09:45:00
</pre><p>
When I write a new class, I almost always start by writing 
<code>__init__</code>, which makes it easier to instantiate objects, and 
<code>__str__</code>, which is useful for debugging.</p><p>As an exercise, write a <span class="c004">str</span> method for the <span class="c004">Point</span> class.
Create a Point object and print it.</p>
<h2 class="section" id="sec202">17.7&#XA0;&#XA0;Operator overloading</h2>
<p>
<a id="operator.overloading"></a></p><p>By defining other special methods, you can specify the behavior
of operators on programmer-defined types. For example, if you define
a method named <code>__add__</code> for the <span class="c004">Time</span> class, you can use the
<span class="c004">+</span> operator on Time objects.
<a id="hevea_default1498"></a>
<a id="hevea_default1499"></a></p><p>Here is what the definition might look like:
<a id="hevea_default1500"></a>
<a id="hevea_default1501"></a></p><pre class="verbatim"># inside class Time:

    def __add__(self, other):
        seconds = self.time_to_int() + other.time_to_int()
        return int_to_time(seconds)
</pre><p>
And here is how you could use it:</p><pre class="verbatim">&gt;&gt;&gt; start = Time(9, 45)
&gt;&gt;&gt; duration = Time(1, 35)
&gt;&gt;&gt; print(start + duration)
11:20:00
</pre><p>
When you apply the <span class="c004">+</span> operator to Time objects, Python invokes
<code>__add__</code>. When you print the result, Python invokes 
<code>__str__</code>. So there is a lot happening behind the scenes!
<a id="hevea_default1502"></a></p><p>Changing the behavior of an operator so that it works with
programmer-defined types is called <span class="c010">operator overloading</span>. For every
operator in Python there is a corresponding special method, like 
<code>__add__</code>. For more details, see
<a href="http://docs.python.org/3/reference/datamodel.html#specialnames"><span class="c004">http://docs.python.org/3/reference/datamodel.html#specialnames</span></a>.</p><p>As an exercise, write an <span class="c004">add</span> method for the Point class. </p>
<h2 class="section" id="sec203">17.8&#XA0;&#XA0;Type-based dispatch</h2>
<p>In the previous section we added two Time objects, but you
also might want to add an integer to a Time object. The
following is a version of <code>__add__</code>
that checks the type of <span class="c004">other</span> and invokes either
<code>add_time</code> or <span class="c004">increment</span>:</p><pre class="verbatim"># inside class Time:

    def __add__(self, other):
        if isinstance(other, Time):
            return self.add_time(other)
        else:
            return self.increment(other)

    def add_time(self, other):
        seconds = self.time_to_int() + other.time_to_int()
        return int_to_time(seconds)

    def increment(self, seconds):
        seconds += self.time_to_int()
        return int_to_time(seconds)
</pre><p>
The built-in function <span class="c004">isinstance</span> takes a value and a
class object, and returns <span class="c004">True</span> if the value is an instance
of the class.
<a id="hevea_default1503"></a>
<a id="hevea_default1504"></a></p><p>If <span class="c004">other</span> is a Time object, <code>__add__</code> invokes
<code>add_time</code>. Otherwise it assumes that the parameter
is a number and invokes <span class="c004">increment</span>. This operation is
called a <span class="c010">type-based dispatch</span> because it dispatches the
computation to different methods based on the type of the
arguments.
<a id="hevea_default1505"></a>
<a id="hevea_default1506"></a></p><p>Here are examples that use the <span class="c004">+</span> operator with different
types:</p><pre class="verbatim">&gt;&gt;&gt; start = Time(9, 45)
&gt;&gt;&gt; duration = Time(1, 35)
&gt;&gt;&gt; print(start + duration)
11:20:00
&gt;&gt;&gt; print(start + 1337)
10:07:17
</pre><p>
Unfortunately, this implementation of addition is not commutative.
If the integer is the first operand, you get
<a id="hevea_default1507"></a></p><pre class="verbatim">&gt;&gt;&gt; print(1337 + start)
TypeError: unsupported operand type(s) for +: 'int' and 'instance'
</pre><p>
The problem is, instead of asking the Time object to add an integer,
Python is asking an integer to add a Time object, and it doesn&#X2019;t know
how. But there is a clever solution for this problem: the
special method <code>__radd__</code>, which stands for &#X201C;right-side add&#X201D;.
This method is invoked when a Time object appears on the right side of
the <span class="c004">+</span> operator. Here&#X2019;s the definition:
<a id="hevea_default1508"></a>
<a id="hevea_default1509"></a></p><pre class="verbatim"># inside class Time:

    def __radd__(self, other):
        return self.__add__(other)
</pre><p>
And here&#X2019;s how it&#X2019;s used:</p><pre class="verbatim">&gt;&gt;&gt; print(1337 + start)
10:07:17
</pre><p>As an exercise, write an <span class="c004">add</span> method for Points that works with
either a Point object or a tuple:</p><ul class="itemize"><li class="li-itemize">If the second operand is a Point, the method should return a new
Point whose <span class="c009">x</span> coordinate is the sum of the <span class="c009">x</span> coordinates of the
operands, and likewise for the <span class="c009">y</span> coordinates.</li><li class="li-itemize">If the second operand is a tuple, the method should add the
first element of the tuple to the <span class="c009">x</span> coordinate and the second
element to the <span class="c009">y</span> coordinate, and return a new Point with the result. </li></ul>
<h2 class="section" id="sec204">17.9&#XA0;&#XA0;Polymorphism</h2>
<p>
<a id="polymorphism"></a></p><p>Type-based dispatch is useful when it is necessary, but (fortunately)
it is not always necessary. Often you can avoid it by writing functions
that work correctly for arguments with different types.
<a id="hevea_default1510"></a>
<a id="hevea_default1511"></a></p><p>Many of the functions we wrote for strings also
work for other sequence types.
For example, in Section&#XA0;<a href="thinkpython2012.html#histogram">11.2</a>
we used <span class="c004">histogram</span> to count the number of times each letter
appears in a word.</p><pre class="verbatim">def histogram(s):
    d = dict()
    for c in s:
        if c not in d:
            d[c] = 1
        else:
            d[c] = d[c]+1
    return d
</pre><p>
This function also works for lists, tuples, and even dictionaries,
as long as the elements of <span class="c004">s</span> are hashable, so they can be used
as keys in <span class="c004">d</span>.</p><pre class="verbatim">&gt;&gt;&gt; t = ['spam', 'egg', 'spam', 'spam', 'bacon', 'spam']
&gt;&gt;&gt; histogram(t)
{'bacon': 1, 'egg': 1, 'spam': 4}
</pre><p>
Functions that work with several types are called <span class="c010">polymorphic</span>.
Polymorphism can facilitate code reuse. For example, the built-in
function <span class="c004">sum</span>, which adds the elements of a sequence, works
as long as the elements of the sequence support addition.
<a id="hevea_default1512"></a></p><p>Since Time objects provide an <span class="c004">add</span> method, they work
with <span class="c004">sum</span>:</p><pre class="verbatim">&gt;&gt;&gt; t1 = Time(7, 43)
&gt;&gt;&gt; t2 = Time(7, 41)
&gt;&gt;&gt; t3 = Time(7, 37)
&gt;&gt;&gt; total = sum([t1, t2, t3])
&gt;&gt;&gt; print(total)
23:01:00
</pre><p>
In general, if all of the operations inside a function 
work with a given type, the function works with that type.</p><p>The best kind of polymorphism is the unintentional kind, where
you discover that a function you already wrote can be
applied to a type you never planned for.</p>
<h2 class="section" id="sec205">17.10&#XA0;&#XA0;Debugging</h2>
<p>
<a id="hevea_default1513"></a></p><p>It is legal to add attributes to objects at any point in the execution
of a program, but if you have objects with the same type that don&#X2019;t
have the same attributes, it is easy to make mistakes.
It is considered a good idea to
initialize all of an object&#X2019;s attributes in the init method.
<a id="hevea_default1514"></a>
<a id="hevea_default1515"></a></p><p>If you are not sure whether an object has a particular attribute, you
can use the built-in function <span class="c004">hasattr</span> (see Section&#XA0;<a href="thinkpython2016.html#hasattr">15.7</a>).
<a id="hevea_default1516"></a>
<a id="hevea_default1517"></a>
<a id="hevea_default1518"></a>
<a id="hevea_default1519"></a></p><p>Another way to access attributes is the built-in function <span class="c004">vars</span>,
which takes an object and returns a dictionary that maps from
attribute names (as strings) to their values:</p><pre class="verbatim">&gt;&gt;&gt; p = Point(3, 4)
&gt;&gt;&gt; vars(p)
{'y': 4, 'x': 3}
</pre><p>
For purposes of debugging, you might find it useful to keep this
function handy:</p><pre class="verbatim">def print_attributes(obj):
    for attr in vars(obj):
        print(attr, getattr(obj, attr))
</pre><p>
<code>print_attributes</code> traverses the dictionary
and prints each attribute name and its corresponding value.
<a id="hevea_default1520"></a>
<a id="hevea_default1521"></a></p><p>The built-in function <span class="c004">getattr</span> takes an object and an attribute
name (as a string) and returns the attribute&#X2019;s value.
<a id="hevea_default1522"></a>
<a id="hevea_default1523"></a></p>
<h2 class="section" id="sec206">17.11&#XA0;&#XA0;Interface and implementation</h2>
<p>One of the goals of object-oriented design is to make software more
maintainable, which means that you can keep the program working when
other parts of the system change, and modify the program to meet new
requirements.
<a id="hevea_default1524"></a>
<a id="hevea_default1525"></a>
<a id="hevea_default1526"></a>
<a id="hevea_default1527"></a></p><p>A design principle that helps achieve that goal is to keep
interfaces separate from implementations. For objects, that means
that the methods a class provides should not depend on how the
attributes are represented.
<a id="hevea_default1528"></a></p><p>For example, in this chapter we developed a class that represents
a time of day. Methods provided by this class include
<code>time_to_int</code>, <code>is_after</code>, and <code>add_time</code>.</p><p>We could implement those methods in several ways. The details of the
implementation depend on how we represent time. In this chapter, the
attributes of a <span class="c004">Time</span> object are <span class="c004">hour</span>, <span class="c004">minute</span>, and
<span class="c004">second</span>.</p><p>As an alternative, we could replace these attributes with
a single integer representing the number of seconds
since midnight. This implementation would make some methods,
like <code>is_after</code>, easier to write, but it makes other methods
harder.</p><p>After you deploy a new class, you might discover a better
implementation. If other parts of the program are using your
class, it might be time-consuming and error-prone to change the
interface. </p><p>But if you designed the interface carefully, you can
change the implementation without changing the interface, which
means that other parts of the program don&#X2019;t have to change.</p>
<h2 class="section" id="sec207">17.12&#XA0;&#XA0;Glossary</h2>
<dl class="description"><dt class="dt-description"><span class="c010">object-oriented language:</span></dt><dd class="dd-description"> A language that provides features,
such as programmer-defined types and methods, that facilitate
object-oriented programming.
<a id="hevea_default1529"></a></dd><dt class="dt-description"><span class="c010">object-oriented programming:</span></dt><dd class="dd-description"> A style of programming in which
data and the operations that manipulate it are organized into classes
and methods.
<a id="hevea_default1530"></a></dd><dt class="dt-description"><span class="c010">method:</span></dt><dd class="dd-description"> A function that is defined inside a class definition and
is invoked on instances of that class.
<a id="hevea_default1531"></a></dd><dt class="dt-description"><span class="c010">subject:</span></dt><dd class="dd-description"> The object a method is invoked on.
<a id="hevea_default1532"></a></dd><dt class="dt-description"><span class="c010">positional argument:</span></dt><dd class="dd-description"> An argument that does not include
a parameter name, so it is not a keyword argument.
<a id="hevea_default1533"></a>
<a id="hevea_default1534"></a></dd><dt class="dt-description"><span class="c010">operator overloading:</span></dt><dd class="dd-description"> Changing the behavior of an operator like
<span class="c004">+</span> so it works with a programmer-defined type.
<a id="hevea_default1535"></a>
<a id="hevea_default1536"></a></dd><dt class="dt-description"><span class="c010">type-based dispatch:</span></dt><dd class="dd-description"> A programming pattern that checks the type
of an operand and invokes different functions for different types.
<a id="hevea_default1537"></a></dd><dt class="dt-description"><span class="c010">polymorphic:</span></dt><dd class="dd-description"> Pertaining to a function that can work with more
than one type. 
<a id="hevea_default1538"></a></dd></dl>
<h2 class="section" id="sec208">17.13&#XA0;&#XA0;Exercises</h2>
<div class="theorem"><span class="c010">Exercise&#XA0;1</span>&#XA0;&#XA0;<p><em>Download the code from this chapter from
</em><a href="https://thinkpython.com/code/Time2.py"><span class="c004"><em>https://thinkpython.com/code/Time2.py</em></span></a><em>. Change the attributes of
<span class="c004">Time</span> to be a single integer representing seconds since
midnight. Then modify the methods (and the function
<code>int_to_time</code>) to work with the new implementation. You
should not have to modify the test code in <span class="c004">main</span>. When you
are done, the output should be the same as before. Solution:
</em><a href="https://thinkpython.com/code/Time2_soln.py"><span class="c004"><em>https://thinkpython.com/code/Time2_soln.py</em></span></a><em>.</em></p></div><div class="theorem"><span class="c010">Exercise&#XA0;2</span>&#XA0;&#XA0;
<a id="kangaroo"></a>
<a id="hevea_default1539"></a>
<a id="hevea_default1540"></a>
<a id="hevea_default1541"></a>
<a id="hevea_default1542"></a>
<a id="hevea_default1543"></a>
<a id="hevea_default1544"></a><p><em>This exercise is a cautionary tale about one of the most
common, and difficult to find, errors in Python.
Write a definition for a class named <span class="c004">Kangaroo</span> with the following
methods:</em></p><ol class="enumerate" type=1><li class="li-enumerate"><em>An <code>__init__</code> method that initializes an attribute named 
<code>pouch_contents</code> to an empty list.</em></li><li class="li-enumerate"><em>A method named <code>put_in_pouch</code> that takes an object
of any type and adds it to <code>pouch_contents</code>.</em></li><li class="li-enumerate"><em>A <code>__str__</code> method that returns a string representation
of the Kangaroo object and the contents of the pouch.</em></li></ol><p><em>
Test your code 
by creating two <span class="c004">Kangaroo</span> objects, assigning them to variables
named <span class="c004">kanga</span> and <span class="c004">roo</span>, and then adding <span class="c004">roo</span> to the
contents of <span class="c004">kanga</span>&#X2019;s pouch.</em></p><p><em>Download </em><a href="https://thinkpython.com/code/BadKangaroo.py"><em><span class="c004">https://thinkpython.com/code/BadKangaroo.py</span></em></a><em>. It contains
a solution to the previous problem with one big, nasty bug.
Find and fix the bug.</em></p><p><em>If you get stuck, you can download
</em><a href="https://thinkpython.com/code/GoodKangaroo.py"><span class="c004"><em>https://thinkpython.com/code/GoodKangaroo.py</em></span></a><em>, which explains the
problem and demonstrates a solution.
</em><a id="hevea_default1545"></a>
<a id="hevea_default1546"></a>
<a id="hevea_default1547"></a></p></div>
<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

</td>

<td width=130 valign="top">

<h4>Contribute</h4>
If you would like to make a contribution to support my books,
you can use the button below and pay with PayPal.  Thank you!

<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RAAYAZ7Y48S2A">
<table>
<tr><td><input type="hidden" name="on0" value="Pay what you want!">Pay what you want:</td></tr><tr><td><select name="os0">
	<option value="Small">Small $1.00 USD</option>
	<option value="Medium">Medium $5.00 USD</option>
	<option value="Large">Large $10.00 USD</option>
	<option value="X-Large">X-Large $20.00 USD</option>
	<option value="XX-Large">XX-Large $50.00 USD</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

  
<p>
<h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onClick="javascript: pageTracker._trackPageview('/outbound/survey');">this short survey</a>.

<p>
<br>

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491938455&linkCode=as2&tag=greenteapre01-20&linkId=CTV7PDT7E5EGGJUM"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491938455&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491938455" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491929561&linkCode=as2&tag=greenteapre01-20&linkId=PT77ANWARUNNU3UK"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491929561&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491929561" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20">Think Bayes</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449370780&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449370780&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449370780" width="1" height="1" border="0" alt="">

<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">


<p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491939362&linkCode=as2&tag=greenteapre01-20&linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=1491939362&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491939362" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491907339&linkCode=as2&tag=greenteapre01-20&linkId=JVSYKQHYSUIEYRHL"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1491907339&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://ir-na.amazon-adsystem.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1491907339" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&tag=greenteapre01-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=1449314635">Think Complexity</a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">

<p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=1449314635&linkCode=as2&tag=greenteapre01-20"><img border="0" src="http://ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=1449314635&amp;Format=_SL160_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=greenteapre01-20"></a><img class="c003" src="http://www.assoc-amazon.com/e/ir?t=greenteapre01-20&l=as2&o=1&a=1449314635" width="1" height="1" border="0" alt="">


</td>
</tr>
</table>
<hr>
<a href="thinkpython2017.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2019.html"><img src="next.png" ALT="Next"></a>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="generator" content="hevea 2.32">
<link rel="stylesheet" type="text/css" href="thinkpython2.css">
<title>Inheritance</title>
</head>
<body>
<a href="thinkpython2018.html"><img src="back.png" ALT="Previous"></a>
<a href="index.html"><img src="up.png" ALT="Up"></a>
<a href="thinkpython2020.html"><img src="next.png" ALT="Next"></a>
<hr>
<table>

<tr>

<td valign="top" width="100" bgcolor="#b6459a">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>
<a href="http://amzn.to/1VUYQUU">Buy this book at Amazon.com</a>

<h1 class="chapter" id="sec209">Chapter&#XA0;18&#XA0;&#XA0;Inheritance</h1>
<p>The language feature most often associated with object-oriented
programming is <span class="c010">inheritance</span>. Inheritance is the ability to
define a new class that is a modified version of an existing class.
In this chapter I demonstrate inheritance using classes that represent
playing cards, decks of cards, and poker hands.
<a id="hevea_default1548"></a> 
<a id="hevea_default1549"></a> 
<a id="hevea_default1550"></a></p><p>If you don&#X2019;t play
poker, you can read about it at
<a href="http://en.wikipedia.org/wiki/Poker"><span class="c004">http://en.wikipedia.org/wiki/Poker</span></a>, but you don&#X2019;t have to; I&#X2019;ll
tell you what you need to know for the exercises.</p><p>Code examples from
this chapter are available from
<a href="https://thinkpython.com/code/Card.py"><span class="c004">https://thinkpython.com/code/Card.py</span></a>.</p>
<h2 class="section" id="sec210">18.1&#XA0;&#XA0;Card objects</h2>
<p>There are fifty-two cards in a deck, each of which belongs to one of
four suits and one of thirteen ranks. The suits are Spades, Hearts,
Diamonds, and Clubs (in descending order in bridge). The ranks are
Ace, 2, 3, 4, 5, 6, 7, 8, 9, 10, Jack, Queen, and King. Depending on
the game that you are playing, an Ace may be higher than King
or lower than 2.
<a id="hevea_default1551"></a>
<a id="hevea_default1552"></a></p><p>If we want to define a new object to represent a playing card, it is
obvious what the attributes should be: <span class="c004">rank</span> and
<span class="c004">suit</span>. It is not as obvious what type the attributes
should be. One possibility is to use strings containing words like
<code>'Spade'</code> for suits and <code>'Queen'</code> for ranks. One problem with
this implementation is that it would not be easy to compare cards to
see which had a higher rank or suit.
<a id="hevea_default1553"></a>
<a id="hevea_default1554"></a>
<a id="hevea_default1555"></a>
<a id="hevea_default1556"></a></p><p>An alternative is to use integers to <span class="c010">encode</span> the ranks and suits.
In this context, &#X201C;encode&#X201D; means that we are going to define a mapping
between numbers and suits, or between numbers and ranks. This
kind of encoding is not meant to be a secret (that
would be &#X201C;encryption&#X201D;).</p><p>For example, this table shows the suits and the corresponding integer
codes:</p><table class="c001 cellpading0"><tr><td class="c013">Spades</td><td class="c012">&#X21A6;</td><td class="c013">3 </td></tr>
<tr><td class="c013">Hearts</td><td class="c012">&#X21A6;</td><td class="c013">2 </td></tr>
<tr><td class="c013">Diamonds</td><td class="c012">&#X21A6;</td><td class="c013">1 </td></tr>
<tr><td class="c013">Clubs</td><td class="c012">&#X21A6;</td><td class="c013">0
</td></tr>
</table><p>This code makes it easy to compare cards; because higher suits map to
higher numbers, we can compare suits by comparing their codes.</p><p>The mapping for ranks is fairly obvious; each of the numerical ranks
maps to the corresponding integer, and for face cards:</p><table class="c001 cellpading0"><tr><td class="c013">Jack</td><td class="c012">&#X21A6;</td><td class="c013">11 </td></tr>
<tr><td class="c013">Queen</td><td class="c012">&#X21A6;</td><td class="c013">12 </td></tr>
<tr><td class="c013">King</td><td class="c012">&#X21A6;</td><td class="c013">13 </td></tr>
</table><p>I am using the &#X21A6;&#XA0;symbol to make it clear that these mappings
are not part of the Python program. They are part of the program
design, but they don&#X2019;t appear explicitly in the code.
<a id="hevea_default1557"></a>
<a id="hevea_default1558"></a></p><p>The class definition for <span class="c004">Card</span> looks like this:</p><pre class="verbatim">class Card:
    """Represents a standard playing card."""

    def __init__(self, suit=0, rank=2):
        self.suit = suit
        self.rank = rank
</pre><p>
As usual, the init method takes an optional
parameter for each attribute. The default card is
the 2 of Clubs.
<a id="hevea_default1559"></a>
<a id="hevea_default1560"></a></p><p>To create a Card, you call <span class="c004">Card</span> with the
suit and rank of the card you want.</p><pre class="verbatim">queen_of_diamonds = Card(1, 12)
</pre>
<h2 class="section" id="sec211">18.2&#XA0;&#XA0;Class attributes</h2>
<p>
<a id="class.attribute"></a>
<a id="hevea_default1561"></a>
<a id="hevea_default1562"></a></p><p>In order to print Card objects in a way that people can easily
read, we need a mapping from the integer codes to the corresponding
ranks and suits. A natural way to
do that is with lists of strings. We assign these lists to <span class="c010">class
attributes</span>:</p><pre class="verbatim"># inside class Card:

    suit_names = ['Clubs', 'Diamonds', 'Hearts', 'Spades']
    rank_names = [None, 'Ace', '2', '3', '4', '5', '6', '7', 
              '8', '9', '10', 'Jack', 'Queen', 'King']

    def __str__(self):
        return '%s of %s' % (Card.rank_names[self.rank],
                             Card.suit_names[self.suit])
</pre><p>
Variables like <code>suit_names</code> and <code>rank_names</code>, which are
defined inside a class but outside of any method, are called
class attributes because they are associated with the class object 
<span class="c004">Card</span>.
<a id="hevea_default1563"></a>
<a id="hevea_default1564"></a></p><p>This term distinguishes them from variables like <span class="c004">suit</span> and <span class="c004">rank</span>, which are called <span class="c010">instance attributes</span> because they are
associated with a particular instance.
<a id="hevea_default1565"></a></p><p>Both kinds of attribute are accessed using dot notation. For
example, in <code>__str__</code>, <span class="c004">self</span> is a Card object,
and <span class="c004">self.rank</span> is its rank. Similarly, <span class="c004">Card</span>
is a class object, and <code>Card.rank_names</code> is a
list of strings associated with the class.</p><p>Every card has its own <span class="c004">suit</span> and <span class="c004">rank</span>, but there
is only one copy of <code>suit_names</code> and <code>rank_names</code>.</p><p>Putting it all together, the expression
<code>Card.rank_names[self.rank]</code> means &#X201C;use the attribute <span class="c004">rank</span>
from the object <span class="c004">self</span> as an index into the list <code>rank_names</code>
from the class <span class="c004">Card</span>, and select the appropriate string.&#X201D;</p><p>The first element of <code>rank_names</code> is <span class="c004">None</span> because there
is no card with rank zero. By including <span class="c004">None</span> as a place-keeper,
we get a mapping with the nice property that the index 2 maps to the
string <code>'2'</code>, and so on. To avoid this tweak, we could have
used a dictionary instead of a list.</p><p>With the methods we have so far, we can create and print cards:</p><pre class="verbatim">&gt;&gt;&gt; card1 = Card(2, 11)
&gt;&gt;&gt; print(card1)
Jack of Hearts
</pre><blockquote class="figure"><div class="center"><hr class="c019"></div>
<div class="center"><img src="thinkpython2024.png"></div>
<div class="caption"><table class="c001 cellpading0"><tr><td class="c018">Figure 18.1: Object diagram.</td></tr>
</table></div>
<a id="fig.card1"></a>
<div class="center"><hr class="c019"></div></blockquote><p>Figure&#XA0;<a href="#fig.card1">18.1</a> is a diagram of the <span class="c004">Card</span> class object and
one Card instance. <span class="c004">Card</span> is a class object; its type is <span class="c004">type</span>. <span class="c004">card1</span> is an instance of <span class="c004">Card</span>, so its type is
<span class="c004">Card</span>. To save space, I didn&#X2019;t draw the contents of
<code>suit_names</code> and <code>rank_names</code>. <a id="hevea_default1566"></a>
<a id="hevea_default1567"></a> <a id="hevea_default1568"></a> <a id="hevea_default1569"></a></p>
<h2 class="section" id="sec212">18.3&#XA0;&#XA0;Comparing cards</h2>
<p>
<a id="comparecard"></a>
<a id="hevea_default1570"></a>
<a id="hevea_default1571"></a></p><p>For built-in types, there are relational operators
(<span class="c004">&lt;</span>, <span class="c004">&gt;</span>, <span class="c004">==</span>, etc.)
that compare
values and determine when one is greater than, less than, or equal to
another. For programmer-defined types, we can override the behavior of
the built-in operators by providing a method named
<code>__lt__</code>, which stands for &#X201C;less than&#X201D;.
<a id="hevea_default1572"></a>
<a id="hevea_default1573"></a></p><p><code>__lt__</code> takes two parameters, <span class="c004">self</span> and <span class="c004">other</span>,
and returns <span class="c004">True</span> if <span class="c004">self</span> is strictly less than <span class="c004">other</span>.
<a id="hevea_default1574"></a>
<a id="hevea_default1575"></a></p><p>The correct ordering for cards is not obvious.
For example, which
is better, the 3 of Clubs or the 2 of Diamonds? One has a higher
rank, but the other has a higher suit. In order to compare
cards, you have to decide whether rank or suit is more important.</p><p>The answer might depend on what game you are playing, but to keep
things simple, we&#X2019;ll make the arbitrary choice that suit is more
important, so all of the Spades outrank all of the Diamonds,
and so on.
<a id="hevea_default1576"></a>
<a id="hevea_default1577"></a></p><p>With that decided, we can write <code>__lt__</code>:</p><pre class="verbatim"># inside class Card:

    def __lt__(self, other):
        # check the suits
        if self.suit &lt; other.suit: return True
        if self.suit &gt; other.suit: return False

        # suits are the same... check ranks
        return self.rank &lt; other.rank
</pre><p>
You can write this more concisely using tuple comparison:
<a id="hevea_default1578"></a>
<a id="hevea_default1579"></a></p><pre class="verbatim"># inside class Card:

    def __lt__(self, other):
        t1 = self.suit, self.rank
        t2 = other.suit, other.rank
        return t1 &lt; t2
</pre><p>
As an exercise, write an <code>__lt__</code> method for Time objects. You
can use tuple comparison, but you also might consider 
comparing integers.</p>
<h2 class="section" id="sec213">18.4&#XA0;&#XA0;Decks</h2>
<p>
<a id="hevea_default1580"></a>
<a id="hevea_default1581"></a></p><p>Now that we have Cards, the next step is to define Decks. Since a
deck is made up of cards, it is natural for each Deck to contain a
list of cards as an attribute.
<a id="hevea_default1582"></a>
<a id="hevea_default1